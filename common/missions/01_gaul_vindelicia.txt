barbaricum_vindelicia_mission = {
    header = "mssion_gaul"
	icon = "general_1"

    repeatable = no

    chance = {
        factor = 5
    }

    potential = {
        NOT = { has_variable = barbaricum_vindelicia_mission }
        is_subject = no
        has_civil_war = no
		primary_culture = vindelician
		is_tribal = yes
    }

    abort = {
        ai_mission_back_out_trigger = yes
    }

    on_start = {
        start_mission_ai_effect = yes
		trigger_event = flavor_gaul.105
    }

    on_abort = {
        custom_tooltip = general_mission_cooldown_tt
        set_variable = {
            name = barbaricum_vindelicia_mission
            days = 7300
        }
    }

    on_completion = {
        complete_mission_effect = yes
    }
	
	barbaricum_vindelicia_mission_task_1 = { #Seek Spiritual Guidance
        icon = "task_political"
		duration = 15
		
        allow = {
			any_character = {
				has_office = office_high_priest
				zeal >= 7
			}
			current_ruler = {
				wealth >= 50
			}
		}
		
		on_start = {
			show_as_tooltip = {
				current_ruler = {
					add_gold = -50
				}
			}
			trigger_event = flavor_gaul.106
		}

        on_completion = {
			trigger_event = flavor_gaul.107
			show_as_tooltip = {
				current_ruler = {
					add_trait = pious
				}
			}
			custom_tooltip = barbaricum_vindelicia_mission_task_1_claims_tt
			hidden_effect = {
				area:helvetia_inferioris_area = { mission_area_claim_effect = yes }
				area:helvetia_superioris_area = { mission_area_claim_effect = yes }
				area:tulingia_area = { mission_area_claim_effect = yes }
				area:helvetia_orientalis_area = { mission_area_claim_effect = yes }
			}
        }
    }
	
	barbaricum_vindelicia_mission_task_2 = { #Found Holy Site
        icon = "task_economical"
		requires = { barbaricum_vindelicia_mission_task_1 }

        highlight = {
			scope:province = {
				OR = {
					province_id = 3773
					province_id = 3640
					province_id = 3642
				}
			}
        }
		
        allow = {
			custom_tooltip = {
				text = barbaricum_vindelicia_mission_task_2_req_tt #holy site in one of the following provinces
				any_owned_province = {
					is_holy_site = yes
					OR = {
						province_id = 3773
						province_id = 3640
						province_id = 3642
					}
				}
			}
		}

        on_completion = {
			trigger_event = flavor_gaul.108
			custom_tooltip = barbaricum_vindelicia_mission_task_2_claims_tt
			hidden_effect = {
				area:alpes_raetiae_orientalis = { mission_area_claim_effect = yes }
				area:alpes_raetiae_occidentalis = { mission_area_claim_effect = yes }
				area:east_insubria_area = { mission_area_claim_effect = yes }
			}
			show_as_tooltip = {
				random_owned_province = {
					limit = {
						is_holy_site = yes
					}
					create_state_pop = tribesmen
					create_state_pop = tribesmen
				}
			}
        }
    }
	
	barbaricum_vindelicia_mission_task_3 = { #Search for Treasure
        icon = "task_economical"
		requires = { barbaricum_vindelicia_mission_task_2 }
		duration = 365

        allow = {
			treasury >= 200
		}
		
		on_start = {
			trigger_event = flavor_gaul.109	
		}

        on_completion = {
			show_as_tooltip = {
				add_treasury = -200
			}
			custom_tooltip = barbaricum_vindelicia_mission_task_3_reward_tt #choose between several treasures or gotta catch 'em all
			trigger_event = flavor_gaul.110
        }
    }
	
	barbaricum_vindelicia_mission_task_4 = { #Convert the Rhaetian Heretics
        icon = "task_conquest"
		requires = { barbaricum_vindelicia_mission_task_2 }

        highlight = {
			scope:province = {
				OR = {
					is_in_region = rhaetia_region
					is_in_region = cisalpine_gaul_region
				}
				dominant_province_culture = rhaetian
				has_owner = yes
			}
        }
		
        allow = {
			custom_tooltip = {
				text = barbaricum_vindelicia_mission_task_4_req_tt
				NOT = {
					region:rhaetia_region = {
						every_region_province = {
							limit = {
								dominant_province_culture = rhaetian
								has_owner = yes
							}
							dominant_province_religion = roman_pantheon
						}
					}
					region:cisalpine_gaul_region = {
						every_region_province = {
							limit = {
								dominant_province_culture = rhaetian
								has_owner = yes
							}
							dominant_province_religion = roman_pantheon
						}
					}
				}
			}
		}

        on_completion = {
			trigger_event = flavor_gaul.111
			show_as_tooltip = {
				current_ruler = {
					add_trait = zealous
				}
				every_character = {
					limit = {
						has_office = office_high_priest
					}
					add_trait = zealous
					add_zeal = 2
				}
			}
        }
    }
	
	barbaricum_vindelicia_mission_task_5 = { #The Holy Sites of Vindelicia
        icon = "task_economical"
		requires = { barbaricum_vindelicia_mission_task_4 barbaricum_vindelicia_mission_task_10  }

        highlight = {
			scope:province = {
				OR = {
					province_id = 3773
					province_id = 3640
					province_id = 3642
				}
			}
        }
		
        allow = {
			p:3773 = {
				owner = root
				is_holy_site = yes
				hidden:holy_site = {
					num_province_treasures >= 1
				}
			}
			p:3640 = {
				owner = root
				is_holy_site = yes
			}
			p:3642 = {
				owner = root
				is_holy_site = yes
			}
		}

        on_completion = {
			trigger_event = flavor_gaul.112
			show_as_tooltip = {
				current_ruler = {
					if = {
						limit = {
							NOT = {
								has_trait = pious
							}
						}
						add_trait = pious
						add_zeal = 2
					}
					else = {
						add_zeal = 3
					}
				}
				add_country_modifier = {
					name = vindelician_holy_sites_mod
					duration 10950
				}
			}
        }
    }
	
	barbaricum_vindelicia_mission_task_6 = { #Celtic Metropolis
        icon = "task_economical"
		requires = { barbaricum_vindelicia_mission_task_15 }

        highlight = {
			scope:province = {
				province_id = 3773
			}
        }
		
        allow = {
			p:3773 = {
				owner = root
				has_province_rank = city_metropolis
			}
		}

        on_completion = {
			trigger_event = flavor_gaul.113
			show_as_tooltip = {
				p:3773 = {
					create_state_pop = nobles
					create_state_pop = nobles
					create_state_pop = nobles
					create_state_pop = nobles
					add_permanent_province_modifier = {
						name = vindelician_metropolis
					}
				}
			}
        }
    }
	
	barbaricum_vindelicia_mission_task_7 = { #Golden Cult Tree
        icon = "task_economical"
		requires = { barbaricum_vindelicia_mission_task_6 barbaricum_vindelicia_mission_task_5 }
		
        allow = {
			treasury >= 300
			OR = {
				has_law = increased_council_powers
				has_law = absolute_authority
			}
			current_ruler = {
				OR = {
					has_trait = pious
					has_trait = zealous
				}
				popularity >= 60
			}
		}

        on_completion = {
			custom_tooltip = barbaricum_vindelicia_mission_task_7_reward #depending on our law we will become a theocratic republic or monarchy
			trigger_event = flavor_gaul.114
			show_as_tooltip = {
				create_country_treasure = {
					key = "vindelicia_golden_cult_tree"
					icon = "treasure_chest"
					modifier = {
						local_pop_assimilation_speed = 0.2
						local_pop_conversion_speed = 0.2
						happiness_for_same_religion_modifier = 0.1
					}
				}
			}
        }
    }
	
	barbaricum_vindelicia_mission_task_8 = { #United Vindelicia
        icon = "task_conquest"
		requires = { barbaricum_vindelicia_mission_task_1 }

        highlight = {
			scope:province = {
				OR = {
					province_id = 3773
					province_id = 3640
					province_id = 3638
					province_id = 3758
					province_id = 3750
					province_id = 3636
					province_id = 3761
				}
			}
        }
		
        allow = {
			owns = 3773
			owns = 3640
			owns = 3638
			owns = 3758
			owns = 3750
			OR = {
				owns = 3636
				owns = 3761
			}
		}

        on_completion = {
			trigger_event = flavor_gaul.115
			change_country_name = "VINDELICIA_NAME"
			hidden_effect = {
				change_country_adjective = "VINDELICIA_ADJ"
				#change_country_color =  "vindelicia_colour" #need to define that
				#change_country_tag = VIN # need to define that
			}
			custom_tooltip = barbaricum_vindelicia_mission_task_8_claims_tt
			hidden_effect = {
				area:tigurinia_area = { mission_area_claim_effect = yes }
				area:alpes_graiae_area = { mission_area_claim_effect = yes }
				area:raurica_area = { mission_area_claim_effect = yes }
				area:latobrigia_area = { mission_area_claim_effect = yes }
				area:germanicum_area = { mission_area_claim_effect = yes }
				area:chattia_orientalis_area = { mission_area_claim_effect = yes }
				area:chattia_occidentalis_area = { mission_area_claim_effect = yes }
			}
        }
    }
	
	barbaricum_vindelicia_mission_task_9 = { #Across the Danube
        icon = "task_conquest"
		requires = { barbaricum_vindelicia_mission_task_8 }

        highlight = {
			scope:province = {
				OR = {
					is_in_area = latobrigia_area
					is_in_area = germanicum_area
					is_in_area = chattia_orientalis_area
					is_in_area = chattia_occidentalis_area
				}
			}
        }
		
        allow = {
			owns_area = latobrigia_area
			owns_area = germanicum_area
			owns_area = chattia_orientalis_area
			owns_area = chattia_occidentalis_area
		}

        on_completion = {
			trigger_event = flavor_gaul.116
			show_as_tooltip = {
				current_ruler = {
					add_popularity = 20
				}
			}
        }
    }
	
	barbaricum_vindelicia_mission_task_10 = { #Helvetian Gold
        icon = "task_conquest"
		requires = { barbaricum_vindelicia_mission_task_8 }

        highlight = {
			scope:province = {
				OR = {
					is_in_area = tigurinia_area
					is_in_area = alpes_graiae_area
					is_in_area = helvetia_inferioris_area
					is_in_area = raurica_area
				}
			}
        }
		
        allow = {
			owns_area = tigurinia_area
			owns_area = alpes_graiae_area
			owns_area = helvetia_inferioris_area
			owns_area = raurica_area
		}

        on_completion = {
			trigger_event = flavor_gaul.117
			show_as_tooltip = {
				add_treasury = 400
			}
			custom_tooltip = barbaricum_vindelicia_mission_task_10_claims_tt
			hidden_effect = {
				area:lauriacum_area = { mission_area_claim_effect = yes }
				area:noricum_mediterranum_area = { mission_area_claim_effect = yes }
			}
        }
    }
	
	barbaricum_vindelicia_mission_task_11 = { #Lacus Raetiae Brigantinus
        icon = "task_economical"
		requires = { barbaricum_vindelicia_mission_task_10 }

        highlight = {
			scope:province = {
				province_id = 3636
			}
        }
		
        allow = {
			p:3636 = {
				has_city_status = yes
				free_building_slots = 0
			}
		}

        on_completion = {
			trigger_event = flavor_gaul.118
			show_as_tooltip = {
				random_owned_province = {
					limit = {
						OR = {
							province_id = 3635
							province_id = 3637
							province_id = 3639
						}
						has_province_rank = settlement
					}
					custom_tooltip = "time_to_complete_city_tt"
					hidden_effect = {
						add_province_modifier = {
							name = founding_city_in_progress
							duration = 730
						}
					}
				}
				p:3636 = {
					create_state_pop = freemen
					create_state_pop = freemen
				}
			}
        }
    }
	
	barbaricum_vindelicia_mission_task_12 = { #Oppidum of Venaxamodurum
        icon = "task_economical"

        highlight = {
			scope:province = {
				province_id = 3773
			}
        }
		
        allow = {
			p:3773 = {
				owner = root
				has_city_status = yes
			}
		}

        on_completion = {
			trigger_event = flavor_gaul.119
			show_as_tooltip = {
				add_centralization = 10
				add_country_modifier = {
					name = city_founder_vindelicia
					duration = 7300
				}
			}
        }
    }
	
	barbaricum_vindelicia_mission_task_13 = { #Centre of Trade
        icon = "task_economical"
		requires = { barbaricum_vindelicia_mission_task_12 }

        highlight = {
			scope:province = {
				province_id = 3773
			}
        }
		
        allow = {
			p:3773.state = {
				incoming_trade_routes >= 5
			}
		}

        on_completion = {
			trigger_event = flavor_gaul.120
			show_as_tooltip = {
				add_treasury = 200
				add_country_modifier = {
					name = vindelicia_centre_of_trade
					duration = 7300
				}
			}
        }
    }
	
	barbaricum_vindelicia_mission_task_14 = { #Build the Iron Horse
        icon = "task_economical"
		requires = { barbaricum_vindelicia_mission_task_12 }
		duration = 180

        highlight = {
			scope:province = {
				province_id = 3773
			}
        }
		
        allow = {
			p:3773 = {
				owner = root
				free_building_slots = 0
			}
			treasury >= 200
		}
		
		on_start = {
			trigger_event = flavor_gaul.121 #122 intermediate
			show_as_tooltip = {
				add_treasury = -200
			}
			trigger_event = {
				id = flavor_gaul.122 
				days = { 80 100 }
			}
			
		}

        on_completion = {
			trigger_event = flavor_gaul.123
			show_as_tooltip = {
				p:3773 = {
					add_permanent_province_modifier = {
						name = iron_horse_vindelicia
					}
				}
				add_centralization = 10
			}
        }
    }
	
	barbaricum_vindelicia_mission_task_15 = { #The Land of the Oppida
        icon = "task_economical"
		requires = { barbaricum_vindelicia_mission_task_14 }

        highlight = {
			scope:province = {
				OR = {
					province_id = 3638
					province_id = 3765
					province_id = 3758
					province_id = 3640
					province_id = 3773
				}
			}
        }
		
        allow = {
			p:3638 = {
				owner = root
				has_city_status = yes
			}
			p:3765 = {
				owner = root
				has_city_status = yes
			}
			p:3758 = {
				owner = root
				has_city_status = yes
			}
			p:3640 = {
				owner = root
				has_city_status = yes
			}
		}

        on_completion = {
			trigger_event = flavor_gaul.124
			show_as_tooltip = {
				add_country_modifier = {
					name = land_of_the_oppida_vindelicia
					duration = -1
				}
				random_owned_province = {
					limit = {
						has_city_status = yes
					}
					create_state_pop = citizen
					create_state_pop = citizen
					create_state_pop = freemen
					create_state_pop = freemen
				}
				current_ruler = {
					add_trait = founder
				}
			}
        }
    }
	
	barbaricum_vindelicia_mission_task_16 = { #Rectangular Enclosed Ditches = Viereckschanze
        icon = "task_economical"
		requires = { barbaricum_vindelicia_mission_task_9 barbaricum_vindelicia_mission_task_15 }

		
        allow = {
			any_owned_province = {
				count >= 3
				has_province_rank = settlement
				fort_level >= 1
			}
		}

        on_completion = {
			trigger_event = flavor_gaul.125
			custom_tooltip = barbaricum_vindelicia_mission_task_16_claims_tt
			hidden_effect = {
				area:marcomannia_maiores_area = { mission_area_claim_effect = yes }
				area:marcomannia_minores_area = { mission_area_claim_effect = yes }
				area:boioa_meridionalis_area = { mission_area_claim_effect = yes }
				area:boioa_septentrionalis_area = { mission_area_claim_effect = yes }
			}
			show_as_tooltip = {
				random_owned_province = {
					limit = {
						has_province_rank = settlement
						fort_level >= 1
					}
					add_permanent_province_modifier = {
						name = viereckschanzen_modifier
					}
				}
			}
        }
    }
	
	barbaricum_vindelicia_mission_task_17 = { #Boihaemian Threat
        icon = "task_conquest"
		requires = { barbaricum_vindelicia_mission_task_16 }

        highlight = {
			scope:province = {
				OR = {
					owned_or_subject_owned = c:BOA
					province_id = 3937
				}
			}
        }
		
        allow = {
			OR = {
				AND = {
					c:BOA = {
						has_land = no
					}
					owns = 3937
				}
				any_subject = {
					tag = BOA
				}
			}
			
		}

        on_completion = {
			trigger_event = flavor_gaul.126
			show_as_tooltip = {
				add_stability = 10
				add_country_modifier = {
					name = vindelicia_dealt_with_bohemia
					duration = 7300
				}
			}
        }
    }
	
	barbaricum_vindelicia_mission_task_18 = { #Control the Alpine Passes
        icon = "task_conquest"
		requires = { barbaricum_vindelicia_mission_task_10 }

        highlight = {
			scope:province = {
				OR = {
					is_in_area = alpes_raetiae_orientalis
					is_in_area = noricum_mediterranum_area
					is_in_area = alpes_raetiae_occidentalis
					is_in_area = lauriacum_area
				}
			}
        }
		
        allow = {
			owns_area = alpes_raetiae_orientalis
			owns_area = noricum_mediterranum_area
			owns_area = alpes_raetiae_occidentalis
			owns_area = lauriacum_area
		}

        on_completion = {
			trigger_event = flavor_gaul.127
			custom_tooltip = barbaricum_vindelicia_mission_task_18_claims_tt
			hidden_effect = {
				area:ferraria_area = { mission_area_claim_effect = yes }
				area:venetia_area = { mission_area_claim_effect = yes }
				area:histria_area = { mission_area_claim_effect = yes }
				area:east_insubria_area = { mission_area_claim_effect = yes }
			}
        }
    }
	
	barbaricum_vindelicia_mission_task_19 = { #The Southern Sea
        icon = "task_conquest"
		requires = { barbaricum_vindelicia_mission_task_11 barbaricum_vindelicia_mission_task_18 }

        highlight = {
			scope:province = {
				OR = {
					is_in_area = east_insubria_area
					is_in_area = ferraria_area
					is_in_area = venetia_area
					is_in_area = histria_area
				}
			}
        }
		
        allow = {
			owns_area = east_insubria_area
			owns_area = ferraria_area
			owns_area = venetia_area
			owns_area = histria_area
		}

        on_completion = {
			trigger_event = flavor_gaul.128
			custom_tooltip = barbaricum_vindelicia_mission_task_19_reward_tt #we may choose between a commercial bonus for one of our coastal provinces
        }
    }
}
