taras_missions = {
    header = "mission_image_syracuse"
    icon = "tarentine_cavalry"

    repeatable = no
    chance = 1000

    potential = {
        NOT = { has_variable = taras_mission_cooldown_var }
        tag = TAR
    }

    abort = {
        ai_mission_back_out_trigger = yes
    }
    on_start = {
        start_mission_ai_effect = yes
        trigger_event = me_taras.26
    }
    on_abort = {
        custom_tooltip = general_mission_cooldown_tt
        set_variable = {
            name = taras_mission_cooldown_var
            days = 7300
        }
    }
    on_completion = {
        add_4_free_province_investments = yes
    }
    taras_missions_task_1 = { # War of 304
        icon = "task_heracles"
        highlight = {
            scope:province = {
                OR = {
                    owner = c:SPA
                    owner = c:APU
                    owner = c:MSP
                    owner = c:LCA
                    owner = c:TAR
                }
            }
        }
        allow = {
            custom_tooltip = {
				text = taras_fight_303_tt
				OR = {
					has_global_variable = lucania_lost_war
					has_global_variable = tarentum_lost_war
					has_variable = samnium_doesnt_fight_var
				}
			}
        }

		bypass = {
			current_date >= 460.1.1 # 10 years after game start
		}
        on_completion = {
            trigger_event = me_taras.1
            show_as_tooltip = {

            }
        }
    }
    taras_missions_task_2 = { # Ruins of Taras
        requires = { taras_missions_task_1 }
        icon = "task_economical"
        duration = 90 
        highlight = {
            scope:province = p:56
        }
        allow = {
        }
        on_completion = {
            trigger_event = me_taras.2
            custom_tooltip = taras_ruins_tt
        }
    }
    taras_missions_task_3 = { # Tarentine Artists
        requires = { taras_missions_task_2 }
        highlight = {
            scope:province = p:56
        }
        icon = "task_apollo"
        allow = {
            hidden:p:56.state = {
					state_improvement_oratory_trigger = yes
				}
            hidden:p:56 = {
                is_importing_trade_good = marble
            }
        }
        on_completion = {
            trigger_event = me_taras.3
            show_as_tooltip = {
            add_party_approval = {
				party_type = traditionalist_party
				value = 10
		    }
            create_country_treasure = {
				key = "tarentine_vase"
				icon = "reasure_urn_2"
				modifier = {
					local_happiness_for_same_culture_modifier = 0.10
                    local_country_civilization_value = 0.10
			}
            }
            }
        }
    }
    taras_missions_task_4 = { # A Temple For Taras
        requires = { taras_missions_task_2 }
        icon = "task_religion"
        duration = 180
        highlight = {
            scope:province = p:56
        }
        allow = {
            invention = global_unrest_inv_2
                p:56 = {
                    deity:omen_taras = {
                    has_holy_site = yes
                    }
                }
            }
            on_completion = {
                trigger_event = me_taras.4
                show_as_tooltip = {
                p:56 = {
                    add_building_level = temple_building
                    add_province_modifier = {
                        name = taras_temple
                        duration = 3650
                    }
                }
            }
        }
    }
    taras_missions_task_5 = { # Tarentine Academy
        icon = "task_calm"
        requires = { taras_missions_task_2 }
        duration = 365
        highlight = {
            scope:province = p:56
        }
        allow = {
            hidden:p:56 = {
                has_building = academy_building
            }
        }
        on_completion = {
            trigger_event = me_taras.5
            custom_tooltip = taras_academy_tt
            show_as_tooltip = {
                p:56 = {
                    add_province_modifier = {
                        name = tarentine_academy
                        duration = -1
                    }
                }
            }
        }
    }
    taras_missions_task_6 = { # Trade Outpost of Satyrion
        requires = { taras_missions_task_2 }
        icon = "task_economical"
        highlight = {
            scope:province = p:56
        }
        allow = {
            hidden:p:56 = {
                has_building = commerce_building
                num_of_port_building >= 2
            }
        }
        on_completion = {
            trigger_event = me_taras.6
            show_as_tooltip = {

            }
        }
    }
    taras_missions_task_8 = { # Spartan Heritage
        requires = { taras_missions_task_7 } # Extensive Training
        icon = "task_heracles"
        duration = 180
        highlight = {
            scope:province = p:56
        }
        allow = {
            military_experience >= 15
            hidden:p:56 = {
                has_building = military_building
            }
        }
        on_completion = {
            trigger_event = me_taras.8
            show_as_tooltip = {
            add_military_experience = -15
            add_country_modifier = {
                name = spartan_heritage
                duration = -1
            }
            add_country_modifier = {
                name = recruitment_campaign
                duration = 1825
            }
            }
        }
    }
    taras_missions_task_7 = { #Italic Mercenaries
        icon = "task_battle"
        allow = {
        	trigger_if = {
        		limit = { is_ai = no }
	        	custom_tooltip = {
	        		text = thebes_missions_01_restoration_task_4_tooltip
		        	any_character = {
		        		is_mercenary = yes
		        	}
	        	}
        	}
        }
        on_completion = {
            trigger_event = me_taras.7
            show_as_tooltip = {
            add_military_experience = 10
            add_country_modifier = {
                name = italic_mercenaries
                duration = 3650
                }
            }
        }
    }
    taras_missions_task_9 = { # Prized Horsemen
        requires = { taras_missions_task_7 } 
        icon = "task_heracles"
        allow = {
            political_influence >= 30 
            hidden:p:56 = {
                state = {
                is_importing_trade_good = horses
            }
            }
        }
        on_completion = {
            custom_tooltip = taras_horses
            trigger_event = me_taras.9
        }
    }
    taras_missions_task_10 = { # War Against Metapontum
        requires = { taras_missions_task_1 } 
        icon = "task_battle"
         highlight = {
            scope:province = {
                owner = c:MET
            }
        }
        allow = {
            has_aggressive_expansion <= 10
            diplomatic_stance = warmongering_stance
        }
        on_completion = {
            trigger_event = me_taras.10
            show_as_tooltip = {
            declare_war_with_wargoal = {
                war_goal = conquer_wargoal
                province = P:55
                target = MET
            }
            add_country_modifier = {
                name = glorious_battle
                duration = 1825
            }
            }
        }
    }
    taras_missions_task_11 = { # Messapian Bargaining
        requires = { taras_missions_task_10 } 
        duration = 180
        icon = "task_expansion"
        highlight = {
            scope:province = {
                OR = {
                    owner = c:MSP
                    owner = c:TAR
                }
            }
        }
        allow = { 
            custom_tooltip = {
                text = taras_msp_ally_tt
                any_allied_country = {
                    tag = MSP
                }
            }
        }
        
        on_completion = {
            trigger_event = me_taras.11
            custom_tooltip = messapia_event_chain
        }
    }
    taras_missions_task_12 = { #Destroying the Lucanians
        requires = { taras_missions_task_11 } 
        icon = "task_dying_gaul"
        highlight = {
            scope:province = {
                owner = c:LCA
            }
        }
        allow = {
            c:LCA = {
                num_of_provinces = 0
            }
            owns_or_subject_owns = 11
            owns_or_subject_owns = 53
            owns_or_subject_owns = 71
            owns_or_subject_owns = 47
            owns_or_subject_owns = 59
        }
        on_completion = {
            trigger_event = me_taras.12
            custom_tooltip = conquer_lucania_tt
        }
    }
    taras_missions_task_13 = { #Samnite Subjugation
        requires = { taras_missions_task_20 } 
        icon = "task_dying_gaul"
        highlight = {
            scope:province = {
                owner = c:SAM
            }
        }
        allow = {
            hidden:c:SAM = {
                is_subject_of = ROOT
            }
            owns_or_subject_owns = 1718
            owns_or_subject_owns = 32
            owns_or_subject_owns = 43
            owns_or_subject_owns = 45
        }
        on_completion = {
            trigger_event = me_taras.13
            show_as_tooltip = {

            }
        }
    }
    taras_missions_task_14 = { #Forcing Out The Bruttians
        requires = { taras_missions_task_18 } 
        duration = 180
        icon = "task_dying_gaul"
        highlight = {
            scope:province = {
                owner = c:BRT
            }
        }
        allow = {
            political_influence >= 30
        }
        on_completion = {
            trigger_event = me_taras.14
            custom_tooltip = taras_bruttia_task_tt
            show_as_tooltip = {
            c:BRT = {
                every_owned_province = {
                    add_claim = root
                    }
                }
            }
        }
    }
    taras_missions_task_15 = { 
        requires = { taras_missions_task_3 taras_missions_task_4 taras_missions_task_5 taras_missions_task_6 taras_missions_task_21 } 
        icon = "task_apollo"
        highlight = {
            scope:province = p:56
        }
        allow = {
			custom_tooltip = {
				text = taras_restored_allow_tt
				p:56 = {
					trigger_if = {
						limit = {
							ROOT = { is_ai = no }
						}
						has_city_status = yes
						total_population >= 40
						province_dominant_culture_group = hellenic
						dominant_province_religion = roman_pantheon
						free_building_slots < 1
						has_construction = no
						civilization_value >= 40
						any_pops_in_province = {
							percent <= 0.33
							pop_type = slaves
						}
						any_pops_in_province = {
							percent <= 0.33
							pop_type = tribesmen
						}
					}
					trigger_else = {
						OR = {
							has_city_status = yes
							ROOT = { can_pay_price = price_found_city }
						}
					}
				}
			}
		}
        on_completion = {
            trigger_event = me_taras.15
            show_as_tooltip = {
                p:56 = {
                    add_province_modifier = {
                        name = taras_restored
                        duration = -1
                    }
                    create_state_pop = citizen
                    create_state_pop = citizen
                    create_state_pop = freemen
                }
                add_party_approval = {
				party_type = oligarchic_party
				value = 10
		        }
                add_party_approval = {
				party_type = traditionalist_party
				value = 10
		        }
                add_party_approval = {
				party_type = democratic_party
				value = 10
		        }
            }
        }
    }
    taras_missions_task_16 = { #Hegemon Once More
        requires = { taras_missions_task_19 taras_missions_task_17 taras_missions_task_13 taras_missions_task_14 } 
        icon = "task_heracles"
        highlight = {
            scope:province = {
                OR = {
					is_in_area = heraclea_area
					is_in_area = tarentum_area
                    province_id = 79
                    province_id = 74
                    province_id = 77
				}
            }
        }
        allow = {
            owns_or_subject_owns_area = tarentum_area
            owns_or_subject_owns_area = heraclea_area
            owns_or_subject_owns = 79
            owns_or_subject_owns = 74
            owns_or_subject_owns = 77
        }
        on_completion = {
            trigger_event = me_taras.16
            show_as_tooltip = {

            }
        }
        final = yes
    }
    taras_missions_task_17 = { # Crossing The Strait
        requires = { taras_missions_task_12 } 
        icon = "task_political"
        allow = {
            manpower >= 3
        }
        on_completion = {
            trigger_event = me_taras.17
            custom_tooltip = lucania_investment_task_tt
            show_as_tooltip = {
            add_manpower = -3
            }
        }
    }
    taras_missions_task_18 = { # Swaying Bruttian Subjects
        requires = { taras_missions_task_11 } 
        icon = "task_political"
        allow = {}
        on_completion = {
            trigger_event = me_taras.18
            custom_tooltip = taras_bruttia_task_tt
        }
    }
    taras_missions_task_19 = { # Italiote Congress
        requires = { taras_missions_task_15 } 
        icon = "task_calm"
        allow = {
            num_of_provinces >= 10
        }
        on_completion = {
            trigger_event = me_taras.19
            custom_tooltip = taras_congress_task_tt
        }
    }
    taras_missions_task_20 = { # Scholars of Rhegium 
        requires = { taras_missions_task_11 } 
        icon = "task_political"
        allow = {}
        on_completion = {
            trigger_event = me_taras.20
            show_as_tooltip = {

            }
        }
    }
    taras_missions_task_21 = { # Hinterland Farms
        requires = { taras_missions_task_2 } 
        highlight = {
            scope:province = p:56
        }
        icon = "task_zeus_cornucopia"
        allow = {
            hidden:p:56 = {
                has_building = population_building
            }
            treasury >= 50 
        }
        on_completion = {
            trigger_event = me_taras.21
            show_as_tooltip = {
            add_treasury = -50
            p:56 = {
                add_province_modifier = {
                    name = expanded_farms
                    duration = -1
                }
            }
            }
        }
    }
    taras_missions_task_22 = { # Governance of Herakleia
        requires = { taras_missions_task_1 } 
        icon = "task_political"
        #bypass = {} ADD BYPASS IF HERAKLEIA IS OWNED OR ISN'T A SUBJECT
        highlight = {
            scope:province = {
                OR = {
                    owner = c:HCL
                    owner = c:TAR
                }
            }
        }
        allow = {
            tyranny <= 10
            hidden:c:HCL = {
                opinion = {
                    target = ROOT
                    value >= 150
                }
            }
        }
        on_completion = {
            trigger_event = me_taras.22
            custom_tooltip = taras_herakleia_tt
        }
    }
    taras_missions_task_23 = { # Epirote Aid
        icon = "task_artemis"
        allow = {
            custom_tooltip = {
                text = taras_epirus_aid_allow_tt
            }
            c:EPI = {
                any_owned_province = {
                    is_in_region = magna_graecia_region
                }
            }
            hidden:any_countries_at_war_with = {
			OR = {
				tag = BRT
			OR = {
                tag = MSP
            OR = {
                tag = APU
            OR = {
                tag = SAM
            }
            }
            }
			}
			save_temporary_scope_as = rome_temp_scope
		}
        }
        on_completion = {
            trigger_event = me_taras.23
            show_as_tooltip = {

            }
        }
    }
    taras_missions_task_24 = { # Taras Invicta
        requires = { taras_missions_task_9 } 
        icon = "task_political"
        allow = {}
        on_completion = {
            trigger_event = me_taras.24
            show_as_tooltip = {

            }
        }
    }
    taras_missions_task_26 = { # Scythian Advisor
        requires = { taras_missions_task_8 } 
        icon = "task_political"
        allow = {}
        on_completion = {
            trigger_event = me_taras.27
            show_as_tooltip = {

            }
        }
    }
}