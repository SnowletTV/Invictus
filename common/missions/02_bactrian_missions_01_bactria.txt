bactrian_mission_01_bactria = {
    header = "mission_image_seleukid"
    icon = "seleukid_2"

    repeatable = no

    chance = {
        factor = 5
    }

    potential = {
        NOT = { has_variable = bactrian_mission_01_bactria }
        tag = BAC
        has_civil_war = no
        is_monarchy = yes
        primary_culture = macedonian
        owns_area = bactria_area
    }

    abort = {
        OR = {
            is_monarchy = no
            NOT = { primary_culture = macedonian }
	        ai_mission_back_out_trigger = yes
        }
    }

    on_start = {
        start_mission_ai_effect = yes
		save_scope_as = me_bactria_scope
    }

    on_abort = {
        custom_tooltip = general_mission_cooldown_tt
        set_variable = {
            name = bactrian_mission_01_bactria
            days = 7300
        }
    }

    on_completion = {
        complete_mission_effect = yes
    }

    bactrian_mission_01_bactria_task_1 = { # Task 1  - The Seleukid Yoke

        icon = "task_diplomatic"

        duration = 180

        highlight = {
            scope:province = {
	         OR = {
                    AND = {
                         exists = c:SEL
                         exists = owner
                         owner = c:SEL
                    }
		        }
            }
        }

        bypass = {
            is_subject = no
        }

        allow = {
            treasury >= 100
            hidden:c:BAC = {
                is_subject_of = c:SEL
	        }
        }

        on_start = {
            add_treasury = -100
            add_political_influence = 50
            custom_tooltip = bactria_mission_01_bactria_task_1_effect_tt
            trigger_event = me_bactria_01_bactria.1
        }

        on_completion = {
            trigger_event = me_bactria_01_bactria.2
	        custom_tooltip = bactria_mission_01_bactria_task_1_effect2_tt
            show_as_tooltip = {
                if = {
                    limit = {
                        NOT = { has_country_modifier = bactrian_levies_modifier }
                    }
                        add_country_modifier = {
                        name = bactrian_levies_modifier
                        duration = 1825
                    }
                }
            }
        }
    }

    bactrian_mission_01_bactria_task_2 = { # Task 2 - The Capital of Bactria
    	requires = { bactrian_mission_01_bactria_task_1 }

        icon = "task_economical"

        highlight = {
            scope:province = {
                province_id = 6678
            }
        }

        allow = {
            trigger_if = {
                limit = { is_ai = no }
                hidden:p:6678 = {
                    has_city_status = yes
                    has_building = forum_building
                    has_building = academy_building
                    custom_tooltip = {
            		text = bactria_mission_01_bactria_task_2_buildings_trigger_tt
            		num_of_used_building_slots >= bactria_mission_01_task2_bactria_buildings_total
            		has_construction = no
                    }
                }
            }
            trigger_else = { # AI fallback
                OR = {
                    p:6678 = {
                        has_city_status = yes
                    }
                    can_pay_price = price_found_city
                }
            }
        }

        on_completion = {
            trigger_event = me_bactria_01_bactria.3
            show_as_tooltip = {
                add_political_influence = 25
                p:6678 = {
                    if = {
                        limit = {
                            NOT = { has_province_modifier = bactrian_royal_city_modifier }
                        }
                        add_permanent_province_modifier = {
                            name = bactrian_royal_city_modifier
                            duration = -1
                        }
                    }
                }
            }
        }
    }

    bactrian_mission_01_bactria_task_3 = { # Urbanizing Bactria
    	requires = { bactrian_mission_01_bactria_task_2 }

        icon = "task_economical"

        highlight = {
            scope:province = {
        		OR = {
                    is_in_area = bactria_area
        			is_in_area = candara_area
        			is_in_area = transoxus_area
        			is_in_area = oxiana_area
        		}
            }
        }

        allow = {
            owns_area = bactria_area
            owns_area = candara_area
            owns_area = transoxus_area
            owns_area = oxiana_area
            custom_tooltip = {
                text = bactria_mission_01_bactria_task_3_tt
                bactria_mission_01_bactria_task_3_current >= bactria_mission_01_bactria_task_3_total
            }
        }

        on_completion = {
            trigger_event = me_bactria_01_bactria.4
            show_as_tooltip = {
                p:6648.state = {
                    add_state_modifier = {
                        name = grecobactrian_governance_bactria_modifier
                        duration = -1
                    }
                }
                p:6637.state = {
                    add_state_modifier = {
                        name = grecobactrian_governance_bactria_modifier
                        duration = -1
                    }
                }
                p:6694.state = {
                    add_state_modifier = {
                        name = grecobactrian_governance_bactria_modifier
                        duration = -1
                    }
                }
                p:7230.state = {
                    add_state_modifier = {
                        name = grecobactrian_governance_bactria_modifier
                        duration = -1
                    }
                }
            }
        }
    }

    bactrian_mission_01_bactria_task_4 = { # Greco-Bactrian Culture
        requires = { bactrian_mission_01_bactria_task_3 }

        icon = "task_diplomatic"

        highlight = {
            scope:province = {
                OR = {
                    province_id = 6686
                    province_id = 6648
                    province_id = 6637
                }
            }
        }

        allow = {
            trigger_if = {
                limit = {
                    NOT = { owns = 6686 }
                    NOT = { owns = 6648 }
                    NOT = { owns = 6637 }
                }
                owns = 6686
                owns = 6648
                owns = 6637
            }
            # TODO check if this is correct
            trigger_if = {
                limit  = {
                    is_ai = no
                }
                hidden:p:6686 = {
                    has_city_status = yes
                    has_building = court_building
                    has_no_ongoing_construction = yes
                }
                hidden:p:6637 = {
                    has_city_status = yes
                    has_building = court_building
                    has_no_ongoing_construction = yes
                }
                hidden:p:6648 = {
                    has_city_status = yes
                    has_building = court_building
                    has_no_ongoing_construction = yes
                }
            }
            trigger_else = { # AI fallback
                OR = {
                    can_pay_price = price_found_city
                    p:6648 = { has_city_status = yes }
                    p:6637 = { has_city_status = yes }
                    p:6686 = { has_city_status = yes }
                }
            }
        }

        on_completion = {
            ai_build_city_pay_price_effect = { CITY = p:6648 } # AI fallback
            ai_build_city_pay_price_effect = { CITY = p:6637 } # AI fallback
            ai_build_city_pay_price_effect = { CITY = p:6686 } # AI fallback
            trigger_event = me_bactria_01_bactria.5
            show_as_tooltip = {
                if = {
					limit = {
						any_country_culture = {
							is_culture = bactrian
						}
					}
					random_country_culture = {
						limit = { is_culture = bactrian }
						add_country_culture_modifier = {
							name = bactrian_mission_bactrian_culture_modifier
							duration = -1
						}
					}
				}
            }
        }
    }
    bactrian_mission_01_bactria_task_5 = { # Alexandria on the Oxus
    	requires = { bactrian_mission_01_bactria_task_4 }

        icon = "task_conquest"

        highlight = {
            scope:province = {
                province_id = 6688
            }
        }

        allow = {
            trigger_if = {
                limit = {
                    NOT = { owns = 6688 }
                }
                owns = 6688
            }
            trigger_if = {
                limit = { is_ai = no }
                hidden:p:6688 = {
                    has_city_status = yes
                    has_building = library_building
        		    has_building = court_building
                    custom_tooltip = {
                		text = seleukid_mission_05_assyria_buildings_tt
                		num_of_used_building_slots >= bactria_mission_01_bactria_task_5_buildings_total
                    }
                }
            }
            trigger_else = {
                OR = {
                    can_pay_price = price_found_city
                    p:6688 = { has_city_status = yes }
                }
            }
            hidden:p:6688 = {
                trigger_if = {
                    limit = {
                        has_construction = yes
                    }
                    custom_tooltip = {
                        text = ongoing_construction_trigger_tt
                        has_construction = no
                    }
                }
            }
        }

        on_completion = {
            ai_build_city_pay_price_effect = { CITY = p:6688 } # AI fallback.
            trigger_event = me_bactria_01_bactria.6
            show_as_tooltip = {
                p:6688 = {
                    if = {
                        limit = {
                            NOT = {
                                has_province_modifier = greco_bactrian_city_modifier
                            }
                        }
                        add_province_modifier = {
                            name = greco_bactrian_city_modifier
                            duration = -1
                        }
                    }
                    if = {
                        limit = {
                            NOT = {
                                has_variable = greco_bactrian_city_variable
                            }
                        }
                        set_variable = greco_bactrian_city_variable
                    }
                }
            }
        }
    }

    bactrian_mission_01_bactria_task_6 = { # Protect the Frontier
    	requires = { bactrian_mission_01_bactria_task_5 }

        icon = "task_diplomatic"

        highlight = {
            scope:province = {
                OR = {
                    province_id = 6627
                    province_id = 6650
                    province_id = 6651
                    province_id = 6630
                    province_id = 6636
                    province_id = 6759
                }
            }
        }

        allow = {
            OR = {
                AND = {
                    owns = 6627
                    hidden:p:6627 = {
                        has_building = fortress_building
                    }
                }
                AND = {
                    owns = 6650
                    hidden:p:6650 = {
                        has_building = fortress_building
                    }
                }
                AND = {
                    owns = 6651
                    hidden:p:6651 = {
                        has_building = fortress_building
                    }
                }
                AND = {
                    owns = 6630
                    hidden:p:6630 = {
                        has_building = fortress_building
                    }
                }
                AND = {
                    owns = 6636
                    hidden:p:6636 = {
                        has_building = fortress_building
                    }
                }
                AND = {
                    owns = 6759
                    hidden:p:6759 = {
                        has_building = fortress_building
                    }
                }
            }  
	    }
        on_completion = {
            trigger_event = me_bactria_01_bactria.7
            show_as_tooltip = {
                p:6648.state = {
                    if = {
                        limit = {
                            NOT = { has_state_modifier = fortified_bactria_modifier }
                        }
                        add_state_modifier = {
                            name = fortified_bactria_modifier
                            duration = -1
                        }
                    }
                }
                p:6637.state = {
                    if = {
                        limit = {
                            NOT = { has_state_modifier = fortified_bactria_modifier }
                        }
                        add_state_modifier = {
                            name = fortified_bactria_modifier
                            duration = -1
                        }
                    }
                }
            }
        }
    }

    bactrian_mission_01_bactria_task_7 = { # Refound Alexandria Tharmata
    	requires = { bactrian_mission_01_bactria_task_6 }

        icon = "task_economical"

        highlight = {
            scope:province = {
                province_id = 6686
            }
        }

        allow = {
            trigger_if = {
                limit = { is_ai = no }
                hidden:p:6686 = {
                    has_city_status = yes
                    custom_tooltip = {
            		text = seleukid_mission_02_syria_buildings_tt
            		num_of_used_building_slots >= bactria_mission_01_bactria_task_7_buildings_total
            		has_construction = no
                    }
                }
            }
            trigger_else = { # AI fallback
                OR = {
                    p:6686 = {
                        has_city_status = yes
                    }
                    can_pay_price = price_found_city
                }
            }
        }

        on_completion = {
            trigger_event = me_bactria_01_bactria.8
            show_as_tooltip = {
                p:6686 = {
                    if = {
                        limit = {
                            NOT = {
                                has_province_modifier = greco_bactrian_city_modifier
                            }
                        }
                        add_province_modifier = {
                            name = greco_bactrian_city_modifier
                            duration = -1
                        }
                    }
	            if = {
	        	limit = {
	        		NOT = { has_variable = greco_bactrian_city_variable }
	        	}
	        	set_variable = greco_bactrian_city_variable
		    	change_province_name = "Demetrias Baktriane"
	            }
                }
            }
        }
    }

    bactrian_mission_01_bactria_task_8 = { # Breadbasket of Bactria
    	requires = { bactrian_mission_01_bactria_task_7 }

        icon = "task_political"

        highlight = {
            scope:province = {
                has_city_status = no
                has_food_trade_good_trigger = yes
	        OR = {
                    is_in_area = oxiana_area
		    is_in_area = transoxus_area
                }
            }
        }

        allow = {
            trigger_if = {
                limit = { is_ai = no }
	        owns_area = oxiana_area
                custom_tooltip = {
                    text = "bactria_mission_01_bactria_task_8_al.tt"
                    area:oxiana_area = {
                        any_area_province = {
                            count = all
                            filter = {
                                has_city_status = no
                                has_food_trade_good_trigger = yes
                            }
                            has_building = basic_settlement_infratructure_building
                        }
                    }
                }
                custom_tooltip = {
                    text = "bactria_mission_01_bactria_task_8_al_2.tt"
                    area:transoxus_area = {
                        any_area_province = {
                            count = all
                            filter = {
                                has_city_status = no
                                has_food_trade_good_trigger = yes
                            }
                            has_building = basic_settlement_infratructure_building
                        }
                    }
                }
            }
            trigger_else = {
                is_ai = yes
                owns_area = oxiana_area
                owns_area = transoxus_area
                treasury >= 300
            }
        }

        on_completion = {
            if = { # AI fallback.
                limit = { is_ai = yes }
                area:oxiana_area = {
                    every_area_province = {
                        limit = {
                            has_city_status = no
                            has_food_trade_good_trigger = yes
                            has_minable_trade_good_trigger = yes
                        }
                        if = {
                            limit = {
                                has_food_trade_good_trigger = yes
                                NOT = { has_building = basic_settlement_infratructure_building }
                            }
                            if = {
                                limit = { free_building_slots < 0 }
                                destroy_building_effect = yes
                            }
                            add_building_level = basic_settlement_infratructure_building
                        }
                    }
                }
                area:transoxus_area = {
                    every_area_province = {
                        limit = {
                            has_city_status = no
                            has_food_trade_good_trigger = yes
                            has_minable_trade_good_trigger = yes
                        }
                        if = {
                            limit = {
                                has_food_trade_good_trigger = yes
                                NOT = { has_building = basic_settlement_infratructure_building }
                            }
                            if = {
                                limit = { free_building_slots < 0 }
                                destroy_building_effect = yes
                            }
                            add_building_level = basic_settlement_infratructure_building
                        }
                    }
                }
            }
            trigger_event = { id = me_bactria_01_bactria.9 }
            show_as_tooltip = {
                add_treasury = -150
                add_2_free_province_investments = yes
                p:6694.state = {
                    add_state_modifier = {
                        name = "breadbasket_of_bactria_modifier"
                        duration = -1
                    }
                }
                p:7235.state = {
                    add_state_modifier = {
                        name = "breadbasket_of_bactria_modifier"
                        duration = -1
                    }
                }
            }
        }
    }

    bactrian_mission_01_bactria_task_9 = { # Marketplaces of Marakanda
    	requires = { bactrian_mission_01_bactria_task_1 }

        icon = "task_economical"

        highlight = {
            scope:province = {
                province_id = 6682
            }
        }

        allow = {
            trigger_if = {
                limit = {
                    NOT = { owns = 6682 }
                }
                owns = 6682
            }
            trigger_if = {
                limit = { is_ai = no }
                hidden:p:6682 = {
                    has_city_status = yes
                    has_building = commerce_building
		    has_building = town_hall_building
                }
            }
            trigger_else = {
                OR = {
                    can_pay_price = price_found_city
                    p:6682 = { has_city_status = yes }
                }
            }
            hidden:p:6682 = {
                trigger_if = {
                    limit = {
                        has_construction = yes
                    }
                    custom_tooltip = {
                        text = ongoing_construction_trigger_tt
                        has_construction = no
                    }
                }
            }
        }

        on_completion = {
            ai_build_city_pay_price_effect = { CITY = p:6682 } # AI fallback.
            trigger_event = me_bactria_01_bactria.10
            show_as_tooltip = {
                p:6682 = {
                    if = {
                        limit = {
                            NOT = {
                                has_province_modifier = flourishing_commerce_modifier
                            }
                        }
                        add_province_modifier = {
                            name = flourishing_commerce_modifier
                            duration = -1
                        }
                    }
                    if = {
                        limit = {
                            NOT = {
                                has_variable = greco_bactrian_city_variable
                            }
                        }
                        set_variable = greco_bactrian_city_variable
                    }
                }
            }
        }
    }

    bactrian_mission_01_bactria_task_10 = { # The Sogdian Rocks
    	requires = { bactrian_mission_01_bactria_task_9 }

        icon = "task_political"

        highlight = {
            scope:province = {
                OR = {
        		    province_id = 6719
        		    province_id = 6700
                    province_id = 6701
        		}
            }
        }

        allow = {
            OR = {
                hidden:p:6719 = {
                    AND = {
                        owned_or_subject_owned = root
                        has_building = fortress_building
                    }
                }
                hidden:p:6700 = {
                    AND = {
                        owned_or_subject_owned = root
                        has_building = fortress_building
                    }
                }
                hidden:p:6701 = {
                    AND = {
                        owned_or_subject_owned = root
                        has_building = fortress_building
                    }
                }
            }
    	}
        on_completion = {
            trigger_event = me_bactria_01_bactria.11
            show_as_tooltip = {
                p:6719.state = {
                    if = {
                        limit = {
                            NOT = { has_state_modifier = fortified_bactria_modifier }
                        }
                        add_state_modifier = {
                            name = fortified_bactria_modifier
                            duration = -1
                        }
                    }
                }
                p:6700.state = {
                    if = {
                        limit = {
                            NOT = { has_state_modifier = fortified_bactria_modifier }
                        }
                        add_state_modifier = {
                            name = fortified_bactria_modifier
                            duration = -1
                        }
                    }
                }
            }
        }
    }

    bactrian_mission_01_bactria_task_11 = { # Wealth of Sogdiana
    	requires = { bactrian_mission_01_bactria_task_10 }

        icon = "task_economical"

        highlight = {
	     scope:province = {
                OR = {
                    is_in_area = sogdiana_area
                    is_in_area = cyropolis_area
		            is_in_area = ferghana_area
                }
            }
	    }

        allow = {
            trigger_if = {
                limit = { is_ai = no }
                hidden:p:6715 = { has_city_status = yes }
                hidden:p:6682 = { has_city_status = yes }
                hidden:p:6703 = { has_city_status = yes }
                hidden:p:6704 = { has_city_status = yes }
                custom_tooltip = {
                    text = bactrian_mission_01_bactria_task_12.tt.a
                    area:sogdiana_area = {
                        any_area_province = {
                            count = all
                            filter = {
                                owner = ROOT
                                has_city_status = yes
                            }
                            has_building = commerce_building
                            has_building = town_hall_building
                        }
                    }
                }
                custom_tooltip = {
                    text = bactrian_mission_01_bactria_task_12.tt.b
                    area:ferghana_area = {
                        any_area_province = {
                            count = all
                            filter = {
                                owner = ROOT
                                has_city_status = yes
                            }
                            has_building = commerce_building
                            has_building = town_hall_building
                        }
                    }
                }
                custom_tooltip = {
                    text = bactrian_mission_01_bactria_task_12.tt.c
                    area:cyropolis_area = {
                        any_area_province = {
                            count = all
                            filter = {
                                owner = ROOT
                                has_city_status = yes
                            }
                            has_building = commerce_building
                            has_building = town_hall_building
                        }
                    }
                }
            }
            trigger_else = {
                p:6715 = {
                    OR = {
                        has_city_status = yes
                        ROOT = { can_pay_price = price_found_city }
                    }
                }
                p:6703 = {
                    OR = {
                        has_city_status = yes
                        ROOT = { can_pay_price = price_found_city }
                    }
                }
                p:6704 = {
                    OR = {
                        has_city_status = yes
                        ROOT = { can_pay_price = price_found_city }
                    }
                }
                p:6682 = {
                    OR = {
                        has_city_status = yes
                        ROOT = { can_pay_price = price_found_city }
                    }
                }
            }
            trigger_if = {
                limit = {
                    NOT = { owns = 6682 }
                }
                owns = 6682
            }
            hidden:p:6682.state = {
                calc_true_if = {
                    amount >= 1
                    state_improvement_military_trigger = yes
                    state_improvement_civic_trigger = yes
                    state_improvement_oratory_trigger = yes
                    state_improvement_religious_trigger = yes
                }
            }
            trigger_if = {
                limit = {
                    NOT = { owns = 6703 }
                }
                owns = 6703
            }
            hidden:p:6703.state = {
                calc_true_if = {
                    amount >= 1
                    state_improvement_military_trigger = yes
                    state_improvement_civic_trigger = yes
                    state_improvement_oratory_trigger = yes
                    state_improvement_religious_trigger = yes
                }
            }
            trigger_if = {
                limit = {
                    NOT = { owns = 6704 }
                }
                owns = 6704
            }
            hidden:p:6704.state = {
                calc_true_if = {
                    amount >= 1
                    state_improvement_military_trigger = yes
                    state_improvement_civic_trigger = yes
                    state_improvement_oratory_trigger = yes
                    state_improvement_religious_trigger = yes
                }
            }
        }

        on_completion = {
            trigger_event = me_bactria_01_bactria.12
            show_as_tooltip = {
                add_political_influence = 25
                p:6682.state = {
                    if = {
                        limit = {
                            NOT = { has_state_modifier = sogdian_administration_modifier }
                        }
                        add_state_modifier = {
                            name = sogdian_administration_modifier
                            duration = -1
                        }
                    }
                }
                p:6703.state = {
                    if = {
                        limit = {
                            NOT = { has_state_modifier = sogdian_administration_modifier }
                        }
                        add_state_modifier = {
                            name = sogdian_administration_modifier
                            duration = -1
                        }
                    }
                }
                p:6704.state = {
                    if = {
                        limit = {
                            NOT = { has_state_modifier = sogdian_administration_modifier }
                        }
                        add_state_modifier = {
                            name = sogdian_administration_modifier
                            duration = -1
                        }
                    }
                }
            }
        }

        bypass = {
            is_ai = yes
        }

        on_bypass = {
            p:6682.state = {
                if = {
                    limit = {
                        NOT = { has_state_modifier = sogdian_administration_modifier }
                    }
                    add_state_modifier = {
                        name = sogdian_administration_modifier
                        duration = -1
                    }
                }
            }
            p:6703.state = {
                if = {
                    limit = {
                        NOT = { has_state_modifier = sogdian_administration_modifier }
                    }
                    add_state_modifier = {
                        name = sogdian_administration_modifier
                        duration = -1
                    }
                }
            }
            p:6704.state = {
                if = {
                    limit = {
                        NOT = { has_state_modifier = sogdian_administration_modifier }
                    }
                    add_state_modifier = {
                        name = sogdian_administration_modifier
                        duration = -1
                    }
                }
            }
        }
    }

    bactrian_mission_01_bactria_task_12 = { # City of Cyrus
        requires = { bactrian_mission_01_bactria_task_11 }

        icon = "task_diplomatic"

        highlight = {
        	scope:province = {
        		province_id = 6703
        	}
        }

        allow = {
            trigger_if = {
                limit = { is_ai = no }
                hidden:p:6703 = {
                    has_city_status = yes
                    custom_tooltip = {
            		text = bactria_mission_01_bactria_task_12_buildings_trigger_tt
            		num_of_used_building_slots >= bactria_mission_01_bactria_task_12_buildings_total
            		has_construction = no
                    }
                }
            }
            trigger_else = { # AI fallback
                OR = {
                    p:6703 = {
                        has_city_status = yes
                    }
                    can_pay_price = price_found_city
                }
            }
        }

        on_completion = {
            trigger_event = me_bactria_01_bactria.13
            show_as_tooltip = {
                p:6703 = {
                    if = {
                        limit = {
                            NOT = { has_province_modifier = greco_bactrian_city_modifier }
                        }
                        add_province_modifier = {
                            name = greco_bactrian_city_modifier
                            duration = -1
                        }
                    }
	            if = {
	        	limit = {
	        		NOT = { has_variable = greco_bactrian_city_variable }
	        	}
	        	set_variable = greco_bactrian_city_variable
	            }
                }
            }
        }
    }

    bactrian_mission_01_bactria_task_13 = { # Alexandria the Furthest
        requires = { bactrian_mission_01_bactria_task_12 }

        icon = "task_expansion"

        duration = 120

        highlight = {
            scope:province = {
                OR = {
                    is_in_area = talas_area
                    is_in_area = sirdarya_area
                    province_id = 6704
                    province_id = 6740
                    province_id = 6736
                    province_id = 6737
                     province_id = 6738
                }
            }
        }

        allow = {
            trigger_if = {
                limit = {
                    NOT = { owns = 6704 }
                }
                owns = 6704
            }
            trigger_if = {
                limit = { is_ai = no }
                hidden:p:6704 = {
                    has_city_status = yes
                    has_building = library_building
                    has_building = court_building
                    custom_tooltip = {
                        text = bactria_mission_01_bactria_task_13_buildings_trigger_tt
                        num_of_used_building_slots >= bactria_mission_01_bactria_task_13_buildings_total
                    }
                }
            }
            trigger_else = {
                OR = {
                    can_pay_price = price_found_city
                    p:6704 = { has_city_status = yes }
                }
            }
            hidden:p:6704 = {
                trigger_if = {
                    limit = {
                        has_construction = yes
                    }
                    custom_tooltip = {
                        text = ongoing_construction_trigger_tt
                        has_construction = no
                    }
                }
            }
        }

        on_completion = {
            ai_build_city_pay_price_effect = { CITY = p:6704 } # AI fallback.
            trigger_event = me_bactria_01_bactria.14
            show_as_tooltip = {
                p:6704 = {
                    if = {
                        limit = {
                            NOT = {
                                has_province_modifier = greco_bactrian_city_modifier
                            }
                        }
                        add_province_modifier = {
                            name = greco_bactrian_city_modifier
                            duration = -1
                        }
                    }
                    if = {
                        limit = {
                            NOT = {
                                has_variable = greco_bactrian_city_variable
                            }
                        }
                        set_variable = greco_bactrian_city_variable
                    }
                }
                if = {
                    limit = {
                        NOT = { owns_area = ferghana_area }
                    }
                    p:6704 = {
                        custom_tooltip = seleukid_mission_02_syria_task_1_effect_tt
                        hidden_effect = {
                            area = {
                                every_area_province = {
                                    limit = {
                                        NOT = { owner = root }
                                    }
                                    add_claim = root
                                }
                            }
                        }
                    }
                }
                if = {
                    limit = {
                        NOT = { owns_area = talas_area }
                    }
                    p:6781 = {
                        custom_tooltip = seleukid_mission_02_syria_task_1_effect_tt
                        hidden_effect = {
                            area = {
                                every_area_province = {
                                    limit = {
                                        NOT = { owner = root }
                                    }
                                    add_claim = root
                                }
                            }
                        }
                    }
                }
                if = {
                    limit = {
                        NOT = { owns_area = sirdarya_area }
                    }
                    p:6791 = {
                        custom_tooltip = seleukid_mission_02_syria_task_1_effect_tt
                        hidden_effect = {
                            area = {
                                every_area_province = {
                                    limit = {
                                        NOT = { owner = root }
                                    }
                                    add_claim = root
                                }
                            }
                        }
                    }
                }
            }
        }
    }

    bactrian_mission_01_bactria_task_14 = { # A New City in Sogdiana
        requires = { bactrian_mission_01_bactria_task_13 }

        icon = "task_expansion"

        duration = 120

        highlight = {
            scope:province = {
                province_id = 6731
            }
        }

        allow = {
            trigger_if = {
                limit = {
                    NOT = { owns = 6731 }
                }
                owns = 6731
            	treasury >= 200
	        }
        }

        on_completion = {
            ai_build_city_pay_price_effect = { CITY = p:6731 } # AI fallback
            trigger_event = me_bactria_01_bactria.15
            show_as_tooltip = {
                p:6731 = {
                    if = {
                        limit = {
                            NOT = {
                                has_province_modifier = greco_bactrian_city_modifier
                            }
                        }
                        add_province_modifier = {
                            name = greco_bactrian_city_modifier
                            duration = -1
                        }
                    }
	                if = {
                        limit = {
                            NOT = { has_variable = greco_bactrian_city_variable }
                        }
                        set_variable = greco_bactrian_city_variable
                        change_province_name = "Antiocheia Skythias"
                        capital_formable_medium_effect = yes
                        establish_city_effect = yes
                    }
                }
            }
        }
    }

    bactrian_mission_01_bactria_task_15 = { # The Fergana Valley
        requires = { bactrian_mission_01_bactria_task_14 }

        icon = "task_expansion"
        highlight = {
            scope:province = {
                is_in_area = ferghana_area
                has_city_status = no
                has_food_trade_good_trigger = yes
            }
        }

        allow = {
            trigger_if = {
                limit = { is_ai = no }
	        owns_area = ferghana_area
                custom_tooltip = {
                    text = "bactria_mission_01_bactria_task_16_al.tt"
                    area:ferghana_area = {
                        any_area_province = {
                            count = all
                            filter = {
                                has_city_status = no
                                has_food_trade_good_trigger = yes
                            }
                            has_building = basic_settlement_infratructure_building
                        }
                    }
                }
                custom_tooltip = {
                    text = "bactria_mission_01_bactria_task_16_al_2.tt"
                    area:ferghana_area = {
                        any_area_province = {
                            count = all
                            filter = {
                                has_city_status = no
                                has_minable_trade_good_trigger = no
                                has_food_trade_good_trigger = no
                            }
                            has_building = barracks_building
                        }
                    }
                }
            }
            trigger_else = {
                is_ai = yes
                owns_area = ferghana_area
                treasury >= 300
            }
        }

        on_completion = {
            if = { # AI fallback.
                limit = { is_ai = yes }
                area:ferghana_area = {
                    every_area_province = {
                        limit = {
                            has_city_status = no
                            has_food_trade_good_trigger = yes
                        }
                        if = {
                            limit = {
                                has_food_trade_good_trigger = yes
                                NOT = { has_building = basic_settlement_infratructure_building }
                            }
                            if = {
                                limit = { free_building_slots < 0 }
                                destroy_building_effect = yes
                            }
                            add_building_level = basic_settlement_infratructure_building
                        }
                        else_if = {
                            limit = {
                                has_minable_trade_good_trigger = no
                                has_food_trade_good_trigger = no
                                NOT = { has_building = barracks_building }
                            }
                            if = {
                                limit = { free_building_slots < 0 }
                                destroy_building_effect = yes
                            }
                            add_building_level = barracks_building
                        }
                    }
                }
            }
            trigger_event = { id = me_bactria_01_bactria.16 }
            show_as_tooltip = {
                add_2_free_province_investments = yes
                p:6704.state = {
                    add_state_modifier = {
                        name = "ferghana_breadbasket_modifier"
                        duration = -1
                    }
                }
            }
        }
    }

   bactrian_mission_01_bactria_task_16 = { # Alexandria in Margiana
        requires = { bactrian_mission_01_bactria_task_1 }

        icon = "task_expansion"

        allow = {
            trigger_if = {
                limit = { is_ai = no }
                hidden:p:6668 = {
                    has_city_status = yes
                    custom_tooltip = {
            		text = bactria_mission_01_bactria_task_12_buildings_trigger_tt
            		num_of_used_building_slots >= bactria_mission_01_bactria_task_12_buildings_total
            		has_construction = no
                    }
                }
            }
            trigger_else = { # AI fallback
                OR = {
                    p:6668 = {
                        has_city_status = yes
                    }
                    can_pay_price = price_found_city
                }
            }
        }

        highlight = {
            scope:province = {
                province_id = 6668
            }
        }

        on_completion = {
            trigger_event = me_bactria_01_bactria.17
            show_as_tooltip = {
                p:6668 = {
                    if = {
                        limit = {
                            NOT = { has_province_modifier = greco_bactrian_city_modifier }
                        }
                        add_province_modifier = {
                            name = greco_bactrian_city_modifier
                            duration = -1
                        }
                    }
	            if = {
	        	limit = {
	        		NOT = { has_variable = greco_bactrian_city_variable }
	        	}
	        	set_variable = greco_bactrian_city_variable
	            }
                }
            }
        }
    }

    bactrian_mission_01_bactria_task_17 = { # The Satrapy of Margiana
        requires = { bactrian_mission_01_bactria_task_16 }

        icon = "task_economical"

        highlight = {
            scope:province = {
                owner = root
		        is_in_area = margiana_area
            }
        }

        allow = {
            trigger_if = {
                limit = {
                    NOT = { owns = 6668 }
                }
                owns = 6668
            }
            hidden:p:6668.state = {
                calc_true_if = {
                    amount >= 1
                    state_improvement_military_trigger = yes
                    state_improvement_civic_trigger = yes
                    state_improvement_oratory_trigger = yes
                    state_improvement_religious_trigger = yes
                }
            }
        }

        on_completion = {
            trigger_event = me_bactria_01_bactria.18
            show_as_tooltip = {
                p:6668.state = {
                    if = {
                        limit = {
                            NOT = { has_state_modifier = margianan_administration_modifier }
                        }
                        add_state_modifier = {
                            name = margianan_administration_modifier
                            duration = -1
                        }
                    }
                }
            }
        }

        bypass = {
            is_ai = yes
        }

        on_bypass = {
            p:6668.state = {
                if = {
                    limit = {
                        NOT = { has_state_modifier = margianan_administration_modifier }
                    }
                    add_state_modifier = {
                        name = margianan_administration_modifier
                        duration = -1
                    }
                }
            }
        }
    }

   bactrian_mission_01_bactria_task_18 = { # City of Iasonion
        requires = { bactrian_mission_01_bactria_task_17 }

        icon = "task_expansion"

        highlight = {
            scope:province = {
                province_id = 6665
            }
        }

        allow = {
            trigger_if = {
                limit = {
                    NOT = { owns = 6665 }
                }
                owns = 6665
            	treasury >= 200
	    }
        }

        on_completion = {
            ai_build_city_pay_price_effect = { CITY = p:6665 } # AI fallback
            trigger_event = me_bactria_01_bactria.19
            show_as_tooltip = {
                add_treasury = -200
                p:6665 = {
                    if = {
                        limit = {
                            NOT = {
                                has_province_modifier = greco_bactrian_city_modifier
                            }
                        }
                        add_province_modifier = {
                            name = greco_bactrian_city_modifier
                            duration = -1
                        }
                    }
	            if = {
	        	limit = {
	        		NOT = { has_variable = greco_bactrian_city_variable }
	        	}
	        	set_variable = greco_bactrian_city_variable
	  	        capital_formable_large_effect = yes
		        establish_city_effect = yes
	            }
                }
            }
        }
    }

    bactrian_mission_01_bactria_task_19 = { # Conquer Chorasmia
        requires = { bactrian_mission_01_bactria_task_18 }

        icon = "task_expansion"

        duration = 180

        highlight = {
            scope:province = {
                OR = {
                    is_in_area = kharesmia_superior
                    is_in_area = kharesmia_area
                }
            }
        }

        bypass = {
            owns_area = kharesmia_superior
            owns_area = kharesmia_area
        }

        allow = {
            treasury >= 100
        }

        on_start = {
            trigger_event = me_bactria_01_bactria.20
            show_as_tooltip = {
                add_treasury = -100
            }
        }

        on_completion = {
            trigger_event = me_bactria_01_bactria.21
            show_as_tooltip = {
                if = {
                    limit = {
                        NOT = { owns_area = kharesmia_superior }
                    }
                    p:6708 = {
                        custom_tooltip = seleukid_mission_02_syria_task_1_effect_tt
                        hidden_effect = {
                            area = {
                                every_area_province = {
                                    limit = {
                                        NOT = { owner = root }
                                    }
                                    add_claim = root
                                }
                            }
                        }
                    }
                }
                if = {
                    limit = {
                        NOT = { owns_area = kharesmia_area }
                    }
                    p:6803 = {
                        custom_tooltip = seleukid_mission_02_syria_task_1_effect_tt
                        hidden_effect = {
                            area = {
                                every_area_province = {
                                    limit = {
                                        NOT = { owner = root }
                                    }
                                    add_claim = root
                                }
                            }
                        }
                    }
                }
            }
        }
    }

    bactrian_mission_01_bactria_task_20 = { # Urbanize Chorasmia
        requires = { bactrian_mission_01_bactria_task_19 }

        icon = "task_expansion"

        highlight = {
            scope:province = {
        		OR = {
                    is_in_area = kharesmia_superior
        			is_in_area = kharesmia_area
        		}
            }
        }

        allow = {
            owns_area = kharesmia_superior
            owns_area = kharesmia_area
            custom_tooltip = {
                text = bactria_mission_01_bactria_task_20_tt
                bactria_mission_01_bactria_task_20_current >= bactria_mission_01_bactria_task_20_total
            }
        }

        on_completion = {
            trigger_event = me_bactria_01_bactria.22
            show_as_tooltip = {
                p:6708.state = {
                    add_state_modifier = {
                        name = chorasmian_administration_modifier
                        duration = -1
                    }
                }
                p:6803.state = {
                    add_state_modifier = {
                        name = chorasmian_administration_modifier
                        duration = -1
                    }
                }
            }
        }
    }

   bactrian_mission_01_bactria_task_21 = { # Capital of Chorasmia
        requires = { bactrian_mission_01_bactria_task_20 }

        icon = "task_expansion"

        highlight = {
        	scope:province = {
        		province_id = 6803
        	}
        }

        allow = {
            trigger_if = {
                limit = { is_ai = no }
                hidden:p:6803 = {
                    has_city_status = yes
                    custom_tooltip = {
                		text = seleukid_mission_02_syria_buildings_tt
                		num_of_used_building_slots >= bactria_mission_01_bactria_task_7_buildings_total
                		has_construction = no
                    }
                }
            }
            trigger_else = { # AI fallback
                OR = {
                    p:6803 = {
                        has_city_status = yes
                    }
                    can_pay_price = price_found_city
                }
            }
        }

        on_completion = {
            trigger_event = me_bactria_01_bactria.23
            show_as_tooltip = {
                p:6803 = {
                    if = {
                        limit = {
                            NOT = { has_province_modifier = greco_bactrian_city_modifier }
                        }
                        add_province_modifier = {
                            name = greco_bactrian_city_modifier
                            duration = -1
                        }
                    }
    	            if = {
        	        	limit = {
        	        		NOT = { has_variable = greco_bactrian_city_variable }
        	        	}
        	        	set_variable = greco_bactrian_city_variable
    	            }
                }
            }
        }
    }

   bactrian_mission_01_bactria_task_22 = { # Chorasmian Oasis
        requires = { bactrian_mission_01_bactria_task_21 }

        icon = "task_expansion"

        highlight = {
            scope:province = {
                OR = {
                    is_in_area = kharesmia_superior
                    is_in_area = kharesmia_area
                }
            }
        }

        allow = {
            trigger_if = {
                limit = {
                    NOT = { owns = 6803 }
                }
                owns = 6803
            }
            hidden:p:6803.state = {
                calc_true_if = {
                    amount >= 1
                    state_improvement_military_trigger = yes
                    state_improvement_civic_trigger = yes
                    state_improvement_oratory_trigger = yes
                    state_improvement_religious_trigger = yes
                }
            }
            trigger_if = {
                limit = {
                    NOT = { owns = 7240 }
                }
                owns = 7240
            }
            hidden:p:7240.state = {
                calc_true_if = {
                    amount >= 1
                    state_improvement_military_trigger = yes
                    state_improvement_civic_trigger = yes
                    state_improvement_oratory_trigger = yes
                    state_improvement_religious_trigger = yes
                }
            }
        }

        on_completion = {
            trigger_event = me_bactria_01_bactria.24
            show_as_tooltip = {
                add_2_free_province_investments = yes
                p:6803.state = {
                    if = {
                        limit = {
                            NOT = { has_state_modifier = chorasmian_oasis_modifier }
                        }
                        add_state_modifier = {
                            name = chorasmian_oasis_modifier
                            duration = -1
                        }
                    }
                }
                p:7240.state = {
                    if = {
                        limit = {
                            NOT = { has_state_modifier = chorasmian_oasis_modifier }
                        }
                        add_state_modifier = {
                            name = chorasmian_oasis_modifier
                            duration = -1
                        }
                    }
                }
            }
        }

        bypass = {
            is_ai = yes
        }

        on_bypass = {
            p:6803.state = {
                if = {
                    limit = {
                        NOT = { has_state_modifier = chorasmian_oasis_modifier }
                    }
                    add_state_modifier = {
                        name = chorasmian_oasis_modifier
                        duration = -1
                    }
                }
            }
            p:7240.state = {
                if = {
                    limit = {
                        NOT = { has_state_modifier = chorasmian_oasis_modifier }
                    }
                    add_state_modifier = {
                        name = chorasmian_oasis_modifier
                        duration = -1
                    }
                }
            }
        }
    }

   bactrian_mission_01_bactria_task_23 = { # The Rise of Eucratides
        requires = { bactrian_mission_01_bactria_task_8 bactrian_mission_01_bactria_task_15 bactrian_mission_01_bactria_task_22 }

        icon = "task_expansion"

	    duration = 180

        highlight = {
            scope:province = {
                OR = {
                    is_in_area = bactria_area
        	        is_in_area = margiana_area
                	is_in_area = kharesmia_superior
                	is_in_area = kharesmia_area
                	is_in_area = sogdiana_area
                	is_in_area = cyropolis_area
                	is_in_area = ferghana_area
		            is_in_area = transoxus_area
                	is_in_area = oxiana_area
                    is_in_area = candara_area
                }
            }
        }

        allow = {
        	owns_or_subject_owns_area = bactria_area
        	owns_or_subject_owns_area = margiana_area
        	owns_or_subject_owns_area = kharesmia_superior
        	owns_or_subject_owns_area = kharesmia_area
        	owns_or_subject_owns_area = sogdiana_area
        	owns_or_subject_owns_area = cyropolis_area
        	owns_or_subject_owns_area = ferghana_area
		    owns_or_subject_owns_area = transoxus_area
        	owns_or_subject_owns_area = oxiana_area
        	owns_or_subject_owns_area = candara_area
        }

        on_start = {
            trigger_event = me_bactria_01_bactria.25
            custom_tooltip = bactria_mission_01_bactria_task_23_effect_tt
        }

        on_completion = {
            custom_tooltip = bactria_mission_01_bactria_task_23_effect2_tt
        }
    }

    bactrian_mission_01_bactria_task_24 = { # A New Capital for Bactria
        requires = { bactrian_mission_01_bactria_task_23 }

        icon = "task_political"

        highlight = {
            scope:province = {
                province_id = 6694
            }
        }

        allow = {
            trigger_if = {
                limit = {
                    NOT = { owns = 6694 }
                }
                owns = 6694
            }
            trigger_if = {
                limit = {
                    is_ai = no
                    p:6694 = { has_city_status = no }
                }
                hidden:p:6694 = { has_city_status = yes }
            }
            trigger_if = {
                limit = {
                    is_ai = yes
                    p:6694 = { has_city_status = no }
                }
                can_pay_price = price_found_city
            }
            hidden:p:6694 = {
                custom_tooltip = {
                    text = bactria_mission_01_bactria_task_24_population_trigger_tt
                    bactria_mission_01_bactria_task_24_population_current >= bactria_mission_01_bactria_task_24_population_total
                }
                custom_tooltip = {
                    text = bactria_mission_01_bactria_task_24_buildings_trigger_tt
                    bactria_mission_01_bactria_task_24_buildings_current >= bactria_mission_01_bactria_task_24_buildings_total
                    has_construction = no
                }
            }
        }

        on_completion = {
            if = { # AI fallback
                limit = {
                    is_ai = yes
                }
                ai_build_city_pay_price_effect = { CITY = p:6694 }
            }
            trigger_event = me_bactria_01_bactria.27
            show_as_tooltip = {
                p:6694 = {
                    if = {
                        limit = {
                            NOT = { has_province_modifier = great_bactrian_royal_city_modifier }
                        }
                        add_province_modifier = {
                            name = great_bactrian_royal_city_modifier
                            duration = -1
                        }
                    }
                    if = {
                        limit = { is_capital = no }
                        custom_tooltip = bactria_mission_01_bactria_task_24_effect_tt
                    }
                    if = {
                        limit = {
                            NOT = { has_variable = greco_bactrian_city_variable }
                        }
                        set_variable = greco_bactrian_city_variable
                        change_province_name = "Eukratideia"
                        capital_formable_huge_effect = yes
                    }
                }
            }
        }
    }

   bactrian_mission_01_bactria_task_25 = { # Bactrian Military Reforms
        requires = { bactrian_mission_01_bactria_task_24 }

        icon = "task_political"

        highlight = {
            scope:province = {
                province_id = 6694
            }
        }

        allow = {
            military_experience >= 10
	    custom_tooltip = {
                text = bactria_mission_01_bactria_task_25_trigger_tt
		any_country_sub_unit = {
                    count >= 60
                    is_cohort = yes
		}
	    }
	}

        on_completion = {
	        trigger_event = me_bactria_01_bactria.28
            add_country_modifier = {
                name = bactrian_military_reforms_modifier
                duration = 7300
            }
        }
    }

    bactrian_mission_01_bactria_task_26 = { # Greek Immigration to Bactria
        requires = { bactrian_mission_01_bactria_task_25 }

	    duration = 180

        icon = "task_diplomatic"

        allow = {
            treasury >= 100
	    }

        on_start = {
	        trigger_event = me_bactria_01_bactria.29
            show_as_tooltip = {
                add_treasury = -100
            }
        }

        on_completion = {
	        trigger_event = me_bactria_01_bactria.30
            custom_tooltip = bactria_mission_01_bactria_task_26_effect_tt
        }
    }

   bactrian_mission_01_bactria_task_27 = { # Expedition to Serica
        requires = { bactrian_mission_01_bactria_task_26 }

        icon = "task_diplomatic"

	    duration = 180


        highlight = {
            scope:province = {
                OR = {
                    is_in_area = tarim_area
                    is_in_area = pamir_area
                }
            }
        }

        allow = {
            treasury >= 50
	    }

        on_start = {
	    trigger_event = me_bactria_01_bactria.33
            show_as_tooltip = {
                add_treasury = -50
            }
        }

        on_completion = {
            trigger_event = me_bactria_01_bactria.34
            show_as_tooltip = {
                if = {
                    limit = {
                        NOT = { owns_area = pamir_area }
                    }
                    p:6769 = {
                        custom_tooltip = seleukid_mission_02_syria_task_1_effect_tt
                        hidden_effect = {
                            area = {
                                every_area_province = {
                                    limit = {
                                        NOT = { owner = root }
                                    }
                                    add_claim = root
                                }
                            }
                        }
                    }
                }
                if = {
                    limit = {
                        NOT = { owns_area = tarim_area }
                    }
                    p:6761 = {
                        custom_tooltip = seleukid_mission_02_syria_task_1_effect_tt
                        hidden_effect = {
                            area = {
                                every_area_province = {
                                    limit = {
                                        NOT = { owner = root }
                                    }
                                    add_claim = root
                                }
                            }
                        }
                    }
                }
            }
        }
    }

    bactrian_mission_01_bactria_task_final = { # The Wealth of Bactria
    	requires = { bactrian_mission_01_bactria_task_26 }

        icon = "task_economical"

        final = yes

        allow = {
        }

        on_completion = {
            trigger_event = me_bactria_01_bactria.35
            show_as_tooltip = {
            	add_country_modifier = {
                	name = bactrian_wealth_modifier
                	duration = -1
		        }
            }
        }
    }
}
