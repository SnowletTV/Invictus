blemmia_missions = {
    header = "kush_mission_header"
    icon = "cde_new_city_founded"

    repeatable = no
    chance = 1000

    potential = {
        primary_culture = blemmyan
        NOT = { has_variable = mission_cooldown_var }
    }

    abort = {
        ai_mission_back_out_trigger = yes
    }

    on_start = {
        start_mission_ai_effect = yes
    }

    on_abort = {
        custom_tooltip = general_mission_cooldown_tt
        set_variable = {
            name = mission_cooldown_var
            days = 7300
        }
    }

    on_completion = {
        complete_mission_effect = yes
        add_8_free_province_investments = yes
        add_innovation = 2
        current_ruler = {
       		add_finesse = 2
       	}
    }

    blemmia_missions_task_1 = { # Adabulian Obligations
        icon = "task_political"
        
        allow = {
            c:ADA = {
                OR = {
                    is_subject_of = root
                    alliance_with = root
                }
                opinion = {
                    value >= 65
                    target = root
                }
                hidden:current_ruler = {
                    is_friend = root.current_ruler
                }
            }
        }

        highlight = {
			scope:province = {
				is_in_area = sinkat_area
			}
		}

        on_completion = {
            trigger_event = me_blemmia.1 # pay money, manpower, or political influence to annex Adabulia and take some characters
            add_country_modifier = {
                name = adabulian_negotiations
                duration = -1
            }
            add_innovation = 1
        }
    }

    blemmia_missions_task_2 = { # Political Stratification
        icon = "task_political"
        allow = {
            has_law = absolute_authority
            has_law = coin_minting_law
            custom_tooltip = { 
                text = blemmia_missions_task_1_tt
                any_character = {
                    count = 8
                    has_any_office = yes
                    loyalty >= 65
                }
            }
        }
        on_completion = {
            trigger_event = me_blemmia.2 # no effects, just completion event
            add_centralization = 30
            add_political_influence = 25
            add_2_free_province_investments = yes
            capital_scope = {
                while = {
                    count = 3 
                    define_pop = {
                        type = nobles
                        culture = root.culture
                        religion = root.religion
                    }
                }
            }
        }
    }

    blemmia_missions_task_3 = { # Mons Smaragdus
        icon = "task_political"
        allow = {
            hidden:p:590.state.governor_or_ruler = {
                is_friend = root.current_ruler
            }
            p:590.state.governor_or_ruler = {
                loyalty <= 33
            }
            custom_tooltip = {
                text = blemmia_missions_task_3_tt
                any_country_culture = {
                    is_culture = blemmyan
                    has_country_culture_modifier = land_protection 
                } 
            }
        }
        on_completion = { 
            trigger_event = me_blemmia.3 # REVOLT OF BLEMMYANS IN THE AREA - add fire effect to Berenike, kill pops in Berenike
            p:8072 = { formable_province_conquest_effect = yes }
			p:8071 = { formable_province_conquest_effect = yes }
			p:584 = { formable_province_conquest_effect = yes }
			p:590 = { formable_province_conquest_effect = yes }
			p:586 = { formable_province_conquest_effect = yes }
            p:589 = { formable_province_conquest_effect = yes }
            p:588 = { formable_province_conquest_effect = yes }
            p:578 = { formable_province_conquest_effect = yes }
            add_2_free_province_investments = yes
            add_treasury = 150
            hidden_effect = {
                p:8089 = { add_road_towards = p:8090 }
			    p:8090 = { add_road_towards = p:7598 }
			    p:7598 = { add_road_towards = p:7597 }
                p:7597 = { add_road_towards = p:8071 }
			    p:8071 = { add_road_towards = p:584 }
			    p:584 = { add_road_towards = p:590 }
            }
            
            #c:EGY = { # MAKE THIS AN EFFECT OF THE COMPLETION EVENT!!!!!!!!!!!!!!!!!!! Also, Egypt loses opinion of Blemmia
            #    area:troglodytica_area = {
            #        add_provincial_claim_effect = yes
            #    }
            #}
        }
    }

    blemmia_missions_task_4 = { # Blemmyan Gold
        icon = "task_political"
        allow = {
            hidden:p:8090 = {
                has_building = slave_mine_building
            }
            hidden:p:8082 = {
                has_building = slave_mine_building
            }
            hidden:p:8097 = {
                has_building = slave_mine_building
            }
            p:8090 = {
                governor_policy = encourage_trade
                state = {
                    trade_good_surplus = {
                        target = precious_metals
                        value >= 6
                    }
                }
                has_no_ongoing_construction = yes
            } 
        }

        highlight = {
			scope:province = {
				OR = {
					province_id = 8090
					province_id = 8082
					province_id = 8097
				}
			}
		}

        on_completion = {
            trigger_event = me_blemmia.4 # Maybe can do a mining expedition at a new site - chance to turn yet another territory into gold-resource
            p:8090 = {
                add_permanent_province_modifier = {
					name = blemmyan_gold_mining
					duration = -1
				}
            }
            p:8082 = {
                add_permanent_province_modifier = {
					name = blemmyan_gold_mining
					duration = -1
				}
            }
            p:8097 = {
                add_permanent_province_modifier = {
					name = blemmyan_gold_mining
					duration = -1
				}
            }
        }
    }

    blemmia_missions_task_5 = { # Recall the Medjay
        requires = {blemmia_missions_task_1}
        icon = "task_political"
        allow = {

        }
        on_completion = {
            trigger_event = me_blemmia.5
            show_as_tooltip = {

            }
        }
    }
    blemmia_missions_task_6 = { # Ties with the Megabaroi
        requires = {blemmia_missions_task_1}
        icon = "task_political"
        allow = {

        }
        on_completion = {
            trigger_event = me_blemmia.6
            show_as_tooltip = {

            }
        }
    }
    blemmia_missions_task_7 = { # Segmented Rule
        requires = {blemmia_missions_task_2}
        icon = "task_political"
        allow = {

        }
        on_completion = {
            trigger_event = me_blemmia.7
            show_as_tooltip = {

            }
        }
    }
    blemmia_missions_task_8 = { # The All-Golden City
        requires = {blemmia_missions_task_2}    
        icon = "task_political"
        allow = {

        }
        on_completion = {
            trigger_event = me_blemmia.8
            show_as_tooltip = {

            }
        }
    }
    blemmia_missions_task_9 = { # The Emerald Trade
        requires = {blemmia_missions_task_3}
        icon = "task_political"
        allow = {
                # ADD THESE !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
        }
        on_completion = {
            trigger_event = me_blemmia.9
            custom_tooltip = blemmia_missions_task_9_tt
            add_treasury = -100
            add_political_influence = -25
            hidden_effect = {
                p:7500 = { add_road_towards = p:7553 }
			    p:7553 = { add_road_towards = p:7552 }
			    p:7552 = { add_road_towards = p:7551 }
                p:7551 = { add_road_towards = p:7550 }
			    p:7550 = { add_road_towards = p:7503 }
			    p:7598 = { add_road_towards = p:7594 }
                p:7594 = { add_road_towards = p:7595 }
                p:7595 = { add_road_towards = p:7596 }
                p:7596 = { add_road_towards = p:7599 }
                p:7599 = { add_road_towards = p:7501 }
                p:7501 = { add_road_towards = p:7500 }
                every_province = {
                    limit = {
                        is_in_area = ichthyophagia_area
                        has_owner = no
                    }
                    while = {
                        count = 3
                        define_pop = {
                            type = tribesmen
                            culture = root.culture
                            religion = root.religion
                        }
                    }
                    set_owned_by = c:BMY
                }
            }
        }
    }
    blemmia_missions_task_10 = { # Red Land Networks
        requires = {blemmia_missions_task_4}
        icon = "task_political"
        allow = {

        }
        on_completion = {
            trigger_event = me_blemmia.10
            show_as_tooltip = {

            }
        }
    }
    blemmia_missions_task_11 = { # Tabot Workshops
        requires = {blemmia_missions_task_4}
        icon = "task_political"
        allow = {}
        on_completion = {
            trigger_event = me_blemmia.11
            show_as_tooltip = {

            }
        }
    }
    blemmia_missions_task_12 = { # Headless Men
        requires = {blemmia_missions_task_5}
        icon = "task_political"
        allow = {}
        on_completion = {
            trigger_event = me_blemmia.12
            show_as_tooltip = {

            }
        }
    }
    blemmia_missions_task_13 = { # The Trogodytes
        requires = {blemmia_missions_task_5}
        icon = "task_political"
        allow = {}
        on_completion = {
            trigger_event = me_blemmia.13
            show_as_tooltip = {

            }
        }
    }
    blemmia_missions_task_14 = { # Raiding Dodekaschoinos
        requires = {blemmia_missions_task_5 blemmia_missions_task_6}
        icon = "task_political"
        allow = {}
        on_completion = {
            trigger_event = me_blemmia.14
            show_as_tooltip = {

            }
        }
    }
    blemmia_missions_task_15 = { # The Blemmyan Kingdom
        requires = {blemmia_missions_task_7 blemmia_missions_task_8}
        icon = "task_political"
        allow = {}
        on_completion = {
            trigger_event = me_blemmia.15
            show_as_tooltip = {

            }
        }
    }
    blemmia_missions_task_16 = { # Controlling Berenike
        requires = {blemmia_missions_task_9 blemmia_missions_task_10}
        icon = "task_political"
        allow = {}
        on_completion = {
            trigger_event = me_blemmia.16
            show_as_tooltip = {

            }
        }
    }
    blemmia_missions_task_17 = { # The Camel Trade
        requires = {blemmia_missions_task_10}
        icon = "task_political"
        allow = {}
        on_completion = {
            trigger_event = me_blemmia.17
            show_as_tooltip = {

            }
        }
    }
    blemmia_missions_task_18 = { # Blemmyan Slave Trade
        requires = {blemmia_missions_task_11}
        icon = "task_political"
        allow = {}
        on_completion = {
            trigger_event = me_blemmia.18
            show_as_tooltip = {

            }
        }
    }
    blemmia_missions_task_19 = { # Raiding Thebes
        requires = {blemmia_missions_task_13}
        icon = "task_political"
        allow = {}
        on_completion = {
            trigger_event = me_blemmia.19
            show_as_tooltip = {

            }
        }
    }
    blemmia_missions_task_20 = { # Worship of Mandulis
        requires = {blemmia_missions_task_14}
        icon = "task_political"
        allow = {}
        on_completion = {
            trigger_event = me_blemmia.20
            show_as_tooltip = {

            }
        }
    }
    blemmia_missions_task_21 = { # The Final Island
        requires = {blemmia_missions_task_14}
        icon = "task_political"
        allow = {}
        on_completion = {
            trigger_event = me_blemmia.21
            show_as_tooltip = {

            }
        }
    }
    blemmia_missions_task_22 = { # Ruling the Middle Nile
        requires = {blemmia_missions_task_14 blemmia_missions_task_15}
        icon = "task_political"
        allow = {}
        on_completion = {
            trigger_event = me_blemmia.22
            show_as_tooltip = {

            }
        }
    }
    blemmia_missions_task_23 = { # The Golden Rule
        requires = {blemmia_missions_task_15 blemmia_missions_task_16}
        icon = "task_political"
        allow = {}
        on_completion = {
            trigger_event = me_blemmia.23
            show_as_tooltip = {

            }
        }
    }
    blemmia_missions_task_24 = { # A Blemmyan Empire
        requires = {blemmia_missions_task_22 blemmia_missions_task_23}
        icon = "task_political"
        allow = {}
        final = yes
        on_completion = {
            trigger_event = me_blemmia.24
            show_as_tooltip = {

            }
        }
    }
}