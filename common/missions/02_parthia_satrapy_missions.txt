parthia_satrapy_missions = {
	header = "mission_image_general"
	icon = "general_1"

	repeatable = no

    chance = {
		factor = 500000
	}

	ai_chance = { factor = 0 }

	potential = {
#		NOT = { has_variable = parthia_mission_satrapy }
		tag = PAR
		has_civil_war = no
		war = no
	}

	abort = {
		ai_mission_back_out_trigger = yes
	}

	on_abort = {
    	custom_tooltip = general_mission_cooldown_tt
		set_variable = {
			name = parthia_mission_satrapy
			days = 7300
			value = 1
		}
	}

	on_start = {

	}

	parthia_satrapy_missions_1 = {
		final = yes #TODO DELETE
		icon = "task_political"

		allow = {
            custom_tooltip = {
                text = perform_divine_sacrifice_please_stab_the_pig
                has_country_modifier = stability_investment
            }
            war = no		
		}
		
		bypass = {
			is_subject = no
		}

		on_completion = {
			trigger_event = me_parthia_satrapy.1
			show_as_tooltip = {
				add_treasury = 200
				add_stability = 5
			}
		}
	}
	
	parthia_satrapy_missions_2 = {
		icon = "task_political"
		requires = { parthia_satrapy_missions_1 }
		potential = { NOT = { has_variable = par_rebellion_path } }

		allow = {
			trigger_if = {
				limit = {
					is_subject = yes
				}
				hidden:overlord = { 
					opinion = { 
						target = root 
						value >= 120
					} 
				}
				hidden:current_ruler = { is_friend = root.overlord.current_ruler }
			}
		}
		
		bypass = {
			is_subject = no
		}

		on_completion = {
			trigger_event = me_parthia_satrapy.2
			show_as_tooltip = {
				add_country_modifier = {
					name = loyal_cap_mod
					duration = -1
				}
			}
			set_variable = par_loyalist_path
		}
	}
	
	parthia_satrapy_missions_3 = {
		icon = "task_political"
		requires = { parthia_satrapy_missions_2 }
		potential = { NOT = { has_variable = par_rebellion_path } }

		allow = {
			political_influence >= 20
		}

		bypass = {
			OR = {
				AND = {
					exists = overlord
					p:6776.owner = root.overlord
				}
				AND = {
					exists = overlord
					p:6776.owner.overlord = root.overlord
				}
				owns_area = p:6776.area
			}
		}

		on_completion = {
			trigger_event = me_parthia_satrapy.3
			custom_tooltip = parthia_satrapy_missions_3.tt
			show_as_tooltip = {
				add_political_influence = -20
				declare_war_with_wargoal = {
	                war_goal = conquer_wargoal
	                province = 6776
	                target = p:6776.owner
	            }
			}
		}
	}
	
	parthia_satrapy_missions_4 = {
		icon = "task_political"
		requires = { parthia_satrapy_missions_3 }
		potential = { NOT = { has_variable = par_rebellion_path } }

		allow = {
			political_influence >= 20
		}

		bypass = {
			OR = {
				AND = {
					exists = overlord
					p:6658.owner = root.overlord
				}
				AND = {
					exists = overlord
					p:6658.owner.overlord = root.overlord
				}
				owns_area = p:6658.area
			}
		}

		on_completion = {
			trigger_event = me_parthia_satrapy.4
			custom_tooltip = parthia_satrapy_missions_4.tt
			show_as_tooltip = {
				add_political_influence = -20
				declare_war_with_wargoal = {
	                war_goal = conquer_wargoal
	                province = 6658
	                target = p:6658.owner
	            }
			}
		}
	}
	
	parthia_satrapy_missions_5 = {
		icon = "task_political"
		requires = { parthia_satrapy_missions_4 }
		potential = { NOT = { has_variable = par_rebellion_path } }

		allow = {
			political_influence >= 20
		}

		bypass = {
			OR = {
				AND = {
					exists = overlord
					p:5454.owner = root.overlord
				}
				AND = {
					exists = overlord
					p:5454.owner.overlord = root.overlord
				}
				owns_area = p:5454.area
			}
		}

		on_completion = {
			trigger_event = me_parthia_satrapy.5
			custom_tooltip = parthia_satrapy_missions_5.tt
			show_as_tooltip = {
				add_political_influence = -20
				declare_war_with_wargoal = {
	                war_goal = conquer_wargoal
	                province = 5454
	                target = p:5454.owner
	            }
			}
		}
	}
	
	parthia_satrapy_missions_6 = {
		icon = "task_political"
		requires = { parthia_satrapy_missions_2 }
		duration = 180
		potential = { NOT = { has_variable = par_rebellion_path } }

		allow = {
			manpower >= 8
			treasury >= 300
			trigger_if = {
				limit = {
					is_subject = yes
				}
				hidden:overlord = {
					has_civil_war = no
				}
			}
		}

		bypass = {
			is_subject = no
		}

		on_start = {
			custom_tooltip = gift_to_overlord_cap_tt
			trigger_event = {
				id = me_parthia_satrapy.6
			}
		}

		on_completion = {
			trigger_event = me_parthia_satrapy.7
			custom_tooltip = parthia_satrapy_missions_6.tt
		}
	}
	
	parthia_satrapy_missions_7 = {
		icon = "task_political"
		requires = { parthia_satrapy_missions_6 }
		potential = { NOT = { has_variable = par_rebellion_path } }

		allow = {
            custom_tooltip = {
                text = parthia_satrapy_missions_7.tt1
                parthia_battles_won_svalue >= 5
            }		
		}

		bypass = {
			is_subject = no
		}

		on_completion = {
			trigger_event = me_parthia_satrapy.10
			custom_tooltip = parthia_satrapy_missions_7.tt2
			set_variable = no_more_legion_counting
		}
	}
	
	parthia_satrapy_missions_8 = {
		icon = "task_political"
		requires = { parthia_satrapy_missions_7 }
		potential = { NOT = { has_variable = par_rebellion_path } }

		allow = { 
			capital_scope = {
				num_of_academy_building = 3
				num_of_nobles >= 12
			}
		}

		bypass = {
			is_subject = no
		}

		on_completion = {
			trigger_event = me_parthia_satrapy.11
			custom_tooltip = parthia_satrapy_missions_8.tt
		}
	}
	
	parthia_satrapy_missions_9 = {
		icon = "task_political"
		requires = { parthia_satrapy_missions_8 }
		potential = { NOT = { has_variable = par_rebellion_path } }

		allow = {
			any_owned_province = {
				count >= 3
				num_of_forum_building = 3
			}
		}

		bypass = {
			is_subject = no
		}

		on_completion = {
			trigger_event = me_parthia_satrapy.12
			custom_tooltip = parthia_satrapy_missions_9.tt
			show_as_tooltip = {
				add_country_modifier = {
					name = par_satrapy_cmod
					duration = 9125
				}
			}
		}
	}
	
	parthia_satrapy_missions_10 = {
		icon = "task_political"
		requires = { parthia_satrapy_missions_9 }
		potential = { NOT = { has_variable = par_rebellion_path } }
		prevented_by = { parthia_satrapy_missions_12 parthia_satrapy_missions_14 }
		duration = 180

		bypass = {
			is_subject = no
		}

		on_start = {
			custom_tooltip = parthia_satrapy_missions_10.tt1
			trigger_event = { #governor
				id = me_parthia_satrapy.1301
			}
#			trigger_event = { #TODO Maybe?
#				id = me_parthia_satrapy.1310
#				days =  { 3 7 }
#			}
		}

		on_completion = {
			custom_tooltip = parthia_satrapy_missions_10.tt2
			trigger_event = {
				id = me_parthia_satrapy.13
			}
		}
	}
	
	parthia_satrapy_missions_11 = {
		icon = "task_political"
		requires = { parthia_satrapy_missions_10 }
		potential = { NOT = { has_variable = par_rebellion_path } }
		prevented_by = { parthia_satrapy_missions_12 parthia_satrapy_missions_14 }
		duration = 180

		bypass = {
			is_subject = no
		}

		highlight = {
			scope:province = {
				OR = {
					province_id = 4997
					province_id = 4973
					province_id = 1595
					province_id = 911
					province_id = 940
					province_id = 862
					province_id = 6552
				}
			}
		}

		allow = {
			owns = 4997
			owns = 4973 
			owns = 1595 
			owns = 911  
			owns = 940 
			owns = 862  
			owns = 6552 
		}

		on_completion = {
			custom_tooltip = parthia_satrapy_missions_11.tt
			show_as_tooltip = {
				change_country_name = amyntid_kingdom_name #TODO
				hidden_effect = {
					change_country_adjective = amyntid_adj #TODO
					change_country_color = amyntid_color #TODO
				}
				custom_tooltip = access_to_hellenistic_empire_tree_tt
				add_political_influence = 100
				add_manpower = 10
				add_country_modifier = {
					name = new_succesor_kingdom
					duration = -1
				}
			}
			trigger_event = {
				id = me_parthia_satrapy.14
			}
		}
	}
	
	parthia_satrapy_missions_12 = {
		icon = "task_political"
		requires = { parthia_satrapy_missions_9 }
		potential = { NOT = { has_variable = par_rebellion_path } }
		prevented_by = { parthia_satrapy_missions_10 parthia_satrapy_missions_14 }
		duration = 180

		bypass = {
			is_subject = no
		}
		
		on_start = {
			trigger_event = {
				id = me_parthia_satrapy.15
			}
		}

		allow = {
			political_influence >= 50
		}

		on_completion = {
			custom_tooltip = parthia_satrapy_missions_12.tt
#			custom_tooltip = parthia_satrapy_missions_12.tt2
			trigger_event = {
				id = me_parthia_satrapy.16
			}
		}
	}
	
	parthia_satrapy_missions_13 = {
		icon = "task_political"
		requires = { parthia_satrapy_missions_12 }
		potential = { NOT = { has_variable = par_rebellion_path } }
		prevented_by = { parthia_satrapy_missions_10 parthia_satrapy_missions_14 }
        duration = 30
		
        bypass = {
            c:BAC = { has_land = no }
        }
		
        highlight = {
            scope:province = {
                owner = c:BAC
            }
        }
		
        allow = {
            trigger_if = {
                limit = {
                    is_ai = no
                }
                c:BAC = {
                    current_ruler = {
                        is_rival = root.current_ruler
                    }
                }
				custom_tooltip = {
					has_variable = sabotage_bac_var
					text = sabotaged_bactria_tt
                }
            }
        }
		
        on_start = {
            c:BAC = {
                trigger_event = me_parthia_satrapy.17
            }
            set_variable = task_done_bac_war
            add_political_influence = -25
        }

		on_completion = {
			custom_tooltip = parthia_satrapy_missions_13.tt
			trigger_event = {
				id = me_parthia_satrapy.18
			}
		}
	}
	
	parthia_satrapy_missions_14 = {
		icon = task_battle
		duration = 365
		requires = { parthia_satrapy_missions_9 }
		potential = { NOT = { has_variable = par_rebellion_path } }
		prevented_by = { parthia_satrapy_missions_10 parthia_satrapy_missions_12 }

		on_start = {
			custom_tooltip = parthia_satrapy_missions_14.tt1
			trigger_event = {
				id = me_parthia_satrapy.20
			}
		}

		on_completion = {
			custom_tooltip = parthia_satrapy_missions_14.tt2
			trigger_event = {
				id = me_parthia_satrapy.19
			}
		}
	}
	
	parthia_satrapy_missions_15 = {
		icon = "task_political"
		requires = { parthia_satrapy_missions_14 }
		potential = { NOT = { has_variable = par_rebellion_path } }
		prevented_by = { parthia_satrapy_missions_10 parthia_satrapy_missions_12 }
		
		highlight = {
			scope:province = {
				OR = {
					is_in_region = parthia_region
					is_in_region = media_region
					is_in_area = namek_area
					is_in_area = media_felix_area
					is_in_area = ardashir_area
					is_in_area = aria_area
					is_in_area = sagartia_area
				}
			}
		}

		allow = {
			region:parthia_region = {
				any_region_province = {
					owner = root
					count = all
				}
			}
			region:media_region = {
				any_region_province = {
					owner = root
					count = all
				}
			}
			area:namek_area = {
				any_area_province = {
					owner = root
					count = all
				}
			}
			area:media_felix_area = {
				any_area_province = {
					owner = root
					count = all
				}
			}
			area:ardashir_area = {
				any_area_province = {
					owner = root
					count = all
				}
			}
			area:aria_area = {
				any_area_province = {
					owner = root
					count = all
				}
			}
			area:sagartia_area = {
				any_area_province = {
					owner = root
					count = all
				}
			}
		}

		on_completion = {
			trigger_event = {
				id = me_parthia_satrapy.23
			}
			show_as_tooltip = {
				change_country_name = greater_parthia_name
				add_country_modifier = {
					name = hegemon_of_iran #TODO?
					duration = -1
				}
				add_political_influence = 50
				add_military_experience = 100
				add_2_free_province_investments = yes
			}
		}
	}
}
