found_city_effect = {
	set_city_status = city
	hidden_effect = {
		every_neighbor_province = {
			limit = {
				NOR = {
					is_sea = yes
					terrain = riverine_terrain
					has_city_status = yes	
				}
			}
			add_neighbor_city_modifier_effect = yes
		}
	}
	if = {
		limit = {
			food_trade_good_trigger = yes
			NOT = {
				terrain = oasis
			}
		}
		switch = { #Must not be cleared!
			trigger = trade_goods
			grain = { set_variable = had_grain }
			fish = { set_variable = had_fish }
			cattle = { set_variable = had_cattle  }
			vegetables = { set_variable = had_vegetables }
			fruits = { set_variable = had_fruits }
			olive = { set_variable = had_olive }
			dates = { set_variable = had_dates }
		}
		hidden_effect = {
			replace_food_after_city_upgrade_effect = { VARIABLE_OR_SET_TRADE_GOODS = set_variable } #See comments in scripted effect before tampering with this
		}
		replace_food_after_city_upgrade_finish_effect = yes
		while = {
			count = 3
			random_pops_in_province = {
				limit = {
					NOT = { pop_type = citizen }
				}
				set_pop_type = citizen
			}
		}
	}
}
destroy_city_effect = {
	set_city_status = settlement
	hidden_effect = {
		every_neighbor_province = {
			limit = {
				NOR = {
					is_sea = yes
					terrain = riverine_terrain
					is_uninhabitable = no
					has_city_status = yes	
				}
			}
			add_neighbor_city_modifier_effect = yes
		}
	}
	#every_pops_in_province = {
	#	limit = {
	#		pop_type = citizen
	#	}
	#	set_pop_type = freemen
	#}
}
add_neighbor_city_modifier_effect = { #Province scope
	if = {
		limit = {
			is_uninhabitable = no
		}
		if = {
			limit = { has_province_modifier = neighbor_city }
			remove_province_modifier = neighbor_city
		}
		while = {
			count = neighbor_cities_svalue

			add_permanent_province_modifier = {
				name = neighbor_city
				mode = add
			}
		}
	}
}