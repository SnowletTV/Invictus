# Scope is character
# Country must be saved as scope:hiring_country
country_can_hire_mercenary = {
    is_mercenary = yes
    exists = c:MER
    employer = c:MER
    OR = {
        is_general = yes
        is_admiral = yes
    }
    in_command = yes
    any_character_unit = {
        unit_size > 0
    }
    NOT = {
        any_character_unit = {
            OR = {
                in_combat = yes
                is_moving = yes
                strength_percentage < 1
            }
        }
    }
    location = {
        distance_from = {
            province = scope:hiring_country.capital_scope
            value <= scope:hiring_country.diplomatic_range_svalue
        }
    }
}

ai_is_facing_comparable_threat = {
    war = yes
    save_temporary_scope_as = country_at_war
    OR = {
        # Is at war with a player, which is always dangerous
        any_countries_at_war_with = {
            is_ai = no
        }
        # There's a war where...
        any_current_war = {
            OR = {
                # ...enemy side has similar amount of territories as ally side
                num_of_territories_of_enemy_side >= num_of_territories_of_ally_side_minus_one_sixth
                num_of_territories_of_enemy_side >= num_of_territories_of_ally_side_minus_ten
                # ...enemy side combined would be equal to a great power, so it must be an absolutely massive war.
                num_of_territories_of_enemy_side >= 500
            }
        }
    }
}

ai_is_facing_existential_threat = {
    war = yes
    save_temporary_scope_as = country_at_war
    OR = {
        # Is at war with a player, which is always dangerous
        any_countries_at_war_with = {
            is_ai = no
        }
        # There's a war where...
        any_current_war = {
            OR = {
                # ...enemy side is 1.(6) times larger than ally side. This is similar to a country having higher rank,
                # as e.g. great power vs average major power is 500 to 300, which would be exactly 1.(6) times larger.
                num_of_territories_of_enemy_side >= num_of_territories_of_ally_side_plus_two_thirds
                # ...enemy side combined would be equal to a great power, so it must be an absolutely massive war.
                num_of_territories_of_enemy_side >= 500
            }
        }
    }
}