namespace = cyr_magas_01

cyr_magas_01.1 = { # Task 1 - A New Governor for Cyrenaica - Start
    type = country_event
    title = cyr_magas_01.1.t
    desc = cyr_magas_01.1.desc
    picture = greek_court

    trigger = {
        is_subject = no        
    }


    option = {      
        name = cyr_magas_01.1.a
        c:EGY = {
            add_opinion = {
                modifier = requesting_govenor
                target = ROOT
            }
        }
    }
}

cyr_magas_01.2 = { # Task 1 - A New Governor for Cyrenaica - Magas Appointed
    type = country_event
    title = cyr_magas_01.2.t
    desc = cyr_magas_01.2.desc
    picture = diadochi_coronation
    left_portrait = scope:cyr_magas_magas_scope
    right_portrait = char:18 

    trigger = {

        c:CYR = { 
            NOT ={
                current_ruler = char:46
            }
        }
        NOT = { 
            char:46 = {is_alive = no} 
        }
    }


    immediate = {
        current_ruler = { save_scope_as = cyr_magas_old_ruler }
    }

    option = {      
        name = cyr_magas_01.2.a
        hidden_effect = {
            scope:cyr_magas_magas_scope = {
                remove_all_positions = yes
                move_country = c:CYR
                set_home_country = c:CYR
                remove_character_modifier = foreign_citizen
            }
            scope:cyr_magas_magas_scope.spouse = {
                remove_all_positions = yes
                move_country = c:CYR
                set_home_country = c:CYR
                remove_character_modifier = foreign_citizen
            }
            c:EGY = {
                every_character = {
                    limit = {
                        has_father = yes
                        father = char:46
                    }
                    remove_all_positions = yes
                    move_country = c:CYR
                    set_home_country = c:CYR
                    remove_character_modifier = foreign_citizen
                }
            }
        }
        set_as_ruler = scope:cyr_magas_magas_scope
        create_family = scope:cyr_magas_magas_scope
        c:EGY = {
            make_subject = {
                target = c:CYR
                type = feudatory
            }   
        }
		scope:cyr_magas_magas_scope = {
			family = { 
				add_prestige = 2000 
			}
		}		
    }
}

#cyr_magas_01.3 = { # Task 1 - A New Governor for Cyrenaica - End - Deprecated 
#    type = country_event
#    title = cyr_magas_01.3.t
#    desc = cyr_magas_01.3.desc
#    picture = greek_court
#
#    option = {      
#        name = cyr_magas_01.3.a	
#    }
#}


#cyr_magas_01.4 = { # Egyptian Ties- Alliance Broken - Deprecated
#    type = country_event
#    title = cyr_magas_01.4.t
#    desc = cyr_magas_01.4.desc
#    picture = greeks_marching
#    
#    trigger = {
#        c:CYR = {
#        has_country_modifier = independent_egyptian_subject
#        }
#        c:CYR = {
#        NOT =  {alliance_with = c:EGY}
#        }
#    }
#
#    option = {      
#        name = cyr_magas_01.4.a
#        c:EGY ={
#            declare_war_with_wargoal ={
#                war_goal = conquer_wargoal
#                province = c:CYR.capital_scope
#                target = c:CYR
#             }
#        }
#        c:EGY = {
#            add_opinion = {
#                modifier = cyr_independence_opinion
#                target = ROOT
#            }
#        }
#        c:CYR = {
#            remove_country_modifier = independent_egyptian_subject
#            
#        }
#
#    }
#}

#cyr_magas_01.5 = { # Egyptian Ties- Tribute Demanded
#    type = country_event
#    title = cyr_magas_01.5.t
#    desc = cyr_magas_01.5.desc
#    picture = greek_court
#    
#    
#    trigger = {
#        Root = c:CYR
#        Root = {has_country_modifier = independent_egyptian_subject}
#        Root = {
#            alliance_with = c:EGY
#        }
#    }
#
#    immediate ={
#            random_country_state = {
#                limit = {
#                    has_state_food > 200
#                }
#               save_scope_as = CYR_EGY_food_tribute
#            }
#        
#
#    }
#
#    option = {      
#        name = cyr_magas_01.5.a
#
#        scope:CYR_EGY_food_tribute = { add_state_food = -200}
#        ROOT = {
#
#            add_treasury = {
#                value = has_monthly_income
#                multiply = -4
#            }
#            add_manpower = -5
#        }
#        
#    }
#
#    option = {      
#        name = cyr_magas_01.5.b
#        ROOT = {break_alliance = c:EGY}
#        c:EGY = {
#            add_opinion = {
#                modifier = CYR_egyptian_ties_denied
#                target = ROOT
#            }
#        }
#    }
#}


cyr_magas_01.6 = {               # Approaching Potential Allies 
    type = country_event
    title = cyr_magas_01.6.t
    desc = cyr_magas_01.6.desc
    picture = greek_court
    
    
    trigger = {
        Root = c:CYR
        any_country = {
            country_culture_group = hellenic 
            num_of_cities >= 50
            is_subject = no
            NOT = {tag = EGY}
            NOT = {has_variable = cyr_embassy_received}
            NOT = {tag = CYR}            
        }
    }

    immediate =  {       
        random_country ={
            limit = {
                country_culture_group = hellenic 
                num_of_cities >= 50
                is_subject = no
                NOT = {tag = EGY}
                NOT = {has_variable = cyr_embassy_received}
                NOT = {tag = CYR}
            }
            save_scope_as = magas_diplomacy_scope
        }
    }

    option = {      
        name = cyr_magas_01.6.a  # No involvement
        
        scope:magas_diplomacy_scope = {
            add_opinion = {
                modifier = CYR_indep_diplo_neg
                target = ROOT
            }
            set_variable = {
                name = cyr_embassy_received
            }
        }

    }

    option = {      
        name = cyr_magas_01.6.b  # Basic Opinion bonus

        scope:magas_diplomacy_scope = {
            add_opinion = {
                modifier = CYR_indep_diplo_small
                target = ROOT
            }
            set_variable = cyr_embassy_received
        }
    }

    option = {      
        name = cyr_magas_01.6.c    # Large Opinion Bonus
    
        scope:magas_diplomacy_scope = {
            add_opinion = {
                modifier = CYR_indep_diplo_large
                target = ROOT
            }
            set_variable = cyr_embassy_received
        }
        ROOT = {
            add_treasury = {
                value = has_monthly_income
                multiply = -8
            }
        }

    }

}

cyr_magas_01.7 = {              # Royal Marriage 
    type = country_event
    title = cyr_magas_01.7.t
    desc = cyr_magas_01.7.desc
    picture = religious_rite
    left_portrait = scope:cyr_royal_marriage_groom
    right_portrait = scope:cyr_royal_marriage_bride
    
    trigger = {

   }

    immediate ={       
        root.current_ruler = {
            save_scope_as = cyr_royal_marriage_groom 
        }
        scope:cyr_royal_marriage_country = {
            random_character = {
                limit = { 
                   is_female = yes
                   from_ruler_family = yes
                   age < 30
                   is_adult = yes
                }
                save_scope_as = cyr_royal_marriage_bride
            }
        }
    }

    option = {      
        name = cyr_magas_01.7.a
        
        scope:cyr_royal_marriage_bride = {  
            if = {
                limit = { is_married = yes }
                spouse = { save_scope_as = cyr_royal_marriage_bride_spouse }
                divorce_character = spouse
            }
            move_country = c:CYR
            hidden_effect = { 
                remove_character_modifier = foreign_citizen
                set_home_country = c:CYR 
                set_as_minor_character = scope:cyr_royal_marriage_bride
            }
        }
        scope:cyr_royal_marriage_groom = {
            if = {
                limit = { is_married = yes }
                spouse = { save_scope_as = cyr_royal_marriage_groom_spouse }
                divorce_character = spouse
            }
        }
        scope:cyr_royal_marriage_groom = {
            marry_character = scope:cyr_royal_marriage_bride
        }
        add_alliance = scope:cyr_royal_marriage_country
        scope:cyr_royal_marriage_country = {
            add_opinion = {
                modifier = CYR_royal_marriage
                target = ROOT
            }
        }
        if = {
            limit = {
                scope:cyr_royal_marriage_country = { alliance_with = c:EGY }
            }
            scope:cyr_royal_marriage_country = { break_alliance = c:EGY }
        }
   }

}



cyr_magas_01.8 = {          # Indian ties event 
    type = country_event
    title = cyr_magas_01.8.t
    desc = cyr_magas_01.8.desc
    picture = pataliputra
    left_portrait = char:46
    right_portrait = c:MRY.current_ruler
    
    
    trigger = {

   }

    immediate ={       

    }

    option = {      
        name = cyr_magas_01.8.a
        add_country_modifier = {
            name = "cyr_indian_herbalism"
            duration = -1
        }
        add_research = { technology = civic_tech value = 25 } 
        c:MRY = {
            add_opinion = {
                modifier = CYR_buddhist_embassies
                target = ROOT
            }
        }
        hidden_effect = {
            c:MRY = {
                create_country_treasure = { 
                    key = "cyr_rock_edict"
                    icon = "treasure_chest"
                    
                    modifier = {
                        local_happiness_for_same_religion_modifier  = 0.05
                        local_migration_attraction    = 2
                    }
                }
            }  
        }             
   }

    option = {      
        name = cyr_magas_01.8.b

        add_research = { technology = religious_tech value = 80 }
        create_character = {
            first_name = "Hegesias"
            family_name = "Peisithanatos"
            age = 25
            no_stats = yes
            culture = root.culture
            religion = root.religion
            save_scope_as = death_persuader
        }
        hidden_effect = {
            scope:death_persuader = {
                add_martial = 2
                add_charisma = 10
                add_finesse = 14
                add_zeal = 7
                add_trait = scholar
                add_trait = polymath
                add_trait = intelligent
                add_prominence = 50
            }
        }
        custom_tooltip = cyr_magas_01.8.b.ttt

        custom_tooltip = cyr_magas_01.8.b.tt
        trigger_event = {
            id = cyr_magas_01.12
            days = { 20 180 }
        }
        c:MRY = {
            add_opinion = {
                modifier = CYR_buddhist_embassies
                target = ROOT
            }
        }       
        hidden_effect = {
            ROOT.capital_scope = {
                every_pops_in_province = {
                    random = {
                        chance = 5
                        set_pop_religion = buddhism
                    }
                }
            }
            c:MRY = {
                create_country_treasure = { 
                    key = "cyr_rock_edict"
                    icon = "treasure_chest"
                    
                    modifier = {
                        local_happiness_for_same_religion_modifier  = 0.05
                        local_migration_attraction    = 2
                    }
                }
            }
        }
   }

    option = {      
        name = cyr_magas_01.8.c
        
        add_political_influence = -200
        add_stability = -20
        add_country_modifier = {
            name = "recent_convert_modifier"
            duration = 3650
            }
        set_country_religion = buddhism
        current_ruler = {
            if = {
                limit = {
                    NOT = { has_religion = buddhism }
                }
                set_character_religion = buddhism
            }
        }
        hidden_effect = {
            current_ruler.family = {
                every_family_member = {
                    limit = {
                        employer = ROOT
                        NOT = { has_religion = buddhism }
                    }
                    set_character_religion = buddhism
                }
            }
        }
        ordered_character = {
            limit = {
                loyalty >= 50
                NOT = { has_religion = buddhism }
                is_ruler = no
                from_ruler_family = no
            }
            max = 10
            order_by = prominence
            set_character_religion = buddhism
        }
        custom_tooltip = cyr_magas_01.8.c.tt
        hidden_effect = {
            every_character = {
                limit = { 
                    NOT = { 
                        has_same_religion_as = employer.current_ruler 
                    } 
                }
                add_loyalty = assets_seized_sl
            }
            ROOT.capital_scope = {
                every_pops_in_province = {
                    random = {
                        chance = 10
                        set_pop_religion = buddhism
                    }
                }
            }
            c:MRY = {
                create_country_treasure = { 
                    key = "cyr_rock_edict"
                    icon = "treasure_chest"
                    
                    modifier = {
                        local_happiness_for_same_religion_modifier  = 0.05
                        local_migration_attraction    = 2
                    }
                }
            }
        } 
    }

}



cyr_magas_01.9 = {          # CYR Independence Wae
    type = country_event
    title = cyr_magas_01.9.t
    desc = cyr_magas_01.9.desc
    picture = elephant_battle

    option = {      
        name = cyr_magas_01.9.a

        c:EGY ={
            declare_war_with_wargoal ={
                war_goal = conquer_wargoal
                province = c:CYR.capital_scope
                target = c:CYR
            }
        }
        c:EGY = {
            add_opinion = {
                modifier = cyr_independence_opinion
                target = ROOT
            }
        }
        c:CYR = {
            remove_country_modifier = independent_egyptian_subject
            
        }        
   }
}


cyr_magas_01.10 = {          # Looking for allies
    type = country_event
    title = cyr_magas_01.10.t
    desc = cyr_magas_01.10.desc
    picture = throneroom
    left_portrait = c:CYR.current_ruler
    right_portrait = c:EGY.current_ruler


    immediate ={    
        add_country_modifier = {
            name = cyr_looking_for_allies
            duration = 1825
        }    
    }

    option = {      
        name = cyr_magas_01.10.a
        hidden_effect = {
            add_country_modifier = {
                name = cyr_looking_for_allies
                duration = 1825
            }            
        }    
   }
}


cyr_magas_01.11 = {          # Coronation Flavour
    type = country_event
    title = cyr_magas_01.11.t
    desc = cyr_magas_01.11.desc
    picture = diadochi_coronation
    left_portrait = c:CYR.current_ruler

    option = {      
        name = cyr_magas_01.11.a
        c:CYR = {
            current_ruler = {
                add_popularity = 15
            }
        }

   }


}

cyr_magas_01.12 = {          # death-persuader
    type = country_event
    title = cyr_magas_01.12.t
    desc = cyr_magas_01.12.desc
    picture = great_library
    left_portrait = scope:death_persuader


    option = {      
        name = cyr_magas_01.12.a
        create_country_treasure = { 
            key = "cyr_death_by_starvation"
            icon = "treasure_chest"
            
            modifier = {
                local_unrest = -2
                local_research_points_modifier   = 0.10
            }
        }
   }
}

 ##### New Events ####


cyr_magas_01.13 = {          # The Libyans
    type = country_event
    title = cyr_magas_01.13.t
    desc = cyr_magas_01.13.desc
    picture = throneroom
    left_portrait = current_ruler

    option = {      
        name = cyr_magas_01.13.a
        random_country_culture = {
            limit = {
                is_culture = libyan
            }
            add_country_culture_modifier = {
                name = cyr_libyan_tolerance
                duration = -1
            }
        }
    }

    option = {      
        name = cyr_magas_01.13.b  
        add_manpower = 2
        random_country_culture = {
            limit = {
                is_culture = cyrenaican
            }
            add_country_culture_modifier = {
                name = cyr_greek_cyrenaica
                duration = 3650
            }
        }
   }

}


cyr_magas_01.14 = {          # The Libyans War - Prelude
    type = country_event
    title = cyr_magas_01.14.t
    desc = cyr_magas_01.14.desc
    picture = throneroom
    left_portrait = current_ruler

    option = {      
        name = cyr_magas_01.14.a
        add_manpower = -2
        p:5992 = {
            every_neighbor_province = {
                limit = {
                    owner = root
                }
                add_province_modifier = {
                    name = cyr_border_patrols
                    duration = 730
                }
            }
        }
        p:5993 = {
            every_neighbor_province = {
                limit = {
                    owner = root
                }
                add_province_modifier = {
                    name = cyr_border_patrols
                    duration = 730
                }
            }
        }
    }

    option = {      
        name = cyr_magas_01.14.b
        add_manpower = -3
        p:5992 = {
            every_neighbor_province = {
                limit = {
                    any_pops_in_province = {
                        pop_culture = libyan
                    }
                }
                add_to_list = cyr_libyan_counter_raid_province_list
            }
        }
        p:5993 = {
            every_neighbor_province = {
                limit = {
                    any_pops_in_province = {
                        pop_culture = libyan
                    }
                }
                add_to_list = cyr_libyan_counter_raid_province_list
            }
        }
        random_list = {
            33 = {
                while = {
                    count = 3
                    random_in_list = {
                        list = cyr_libyan_counter_raid_province_list
                        random_pops_in_province = {
                            limit = {
                                pop_culture = libyan
                            }
                            kill_pop = yes
                        }
                    }
                }
                add_treasury = 90
            }
            33 = {
                while = {
                    count = 2
                    random_in_list = {
                        list = cyr_libyan_counter_raid_province_list
                        random_pops_in_province = {
                            limit = {
                                pop_culture = libyan
                            }
                            kill_pop = yes
                        }
                    }
                }
                add_treasury = 60
            }
            33 = {
                while = {
                    count = 1
                    random_in_list = {
                        list = cyr_libyan_counter_raid_province_list
                        random_pops_in_province = {
                            limit = {
                                pop_culture = libyan
                            }
                            kill_pop = yes
                        }
                    }
                }
                add_treasury = 30
            }
        }
    }


}


cyr_magas_01.15 = {          # The Libyans War - War Triggers
    type = country_event
    title = cyr_magas_01.15.t
    desc = cyr_magas_01.15.desc
    picture = throneroom
    right_portrait = current_ruler
    left_portrait = scope:cyr_libyan_leader_scope

    immediate = {
        p:5993 = {
            random_neighbor_province = {
                limit = {
                    owner = root
                    NOT = { province_id = 3344 }
                }
                save_scope_as = cyr_barb_spawn_scope_1
            }
        }
        hidden_effect = {
            c:BAR = {
                create_character = {
                    culture = libyan
                    religion = berber_religion
                    add_martial = 3
                    save_scope_as = cyr_libyan_leader_scope
                }
                create_character = {
                    culture = libyan
                    religion = berber_religion
                    add_martial = 2
                    save_scope_as = cyr_libyan_leader2_scope
                }
            }
        }
    }

    option = {      
        name = cyr_magas_01.15.a
        custom_tooltip = cyr_magas_01_15_tooltip_1
        hidden_effect = {
            c:BAR = {
                create_unit = {
                    location = scope:cyr_barb_spawn_scope_1
                    commander = scope:cyr_libyan_leader_scope
                    while = {
                        count = 11
                        add_subunit = light_infantry 
                    }
                    while = {
                        count = 6
                        add_subunit = camels  
                    }
                    while = {
                        count = 2
                        add_subunit = supply_train  
                    }
                }
            }
            c:BAR = {
                create_unit = {
                    location = 3364
                    commander = scope:cyr_libyan_leader2_scope
                    while = {
                        count = 5
                        add_subunit = light_infantry 
                    }
                    while = {
                        count = 3
                        add_subunit = camels  
                    }
                    add_subunit = supply_train
                }
            }
        }
    }

    option = {      
        name = cyr_magas_01.15.b
        custom_tooltip = cyr_magas_01_15_tooltip_2
        hidden_effect = {
            every_owned_province = {
                limit = {
                    NOR = {
                        province_id = 3340
                        province_id = 3341
                        province_id = 3342
                        province_id = 3344
                        province_id = 3346
                        province_id = 3348
                        province_id = 3350
                        province_id = 3352
                        province_id = 3353
                        province_id = 3354
                        province_id = 3358
                        province_id = 3360
                        province_id = 3361
                        province_id = 3363
                        province_id = 3365
                        province_id = 3366
                        province_id = 3367
                        province_id = 3368
                    }
                }
                add_to_list = new_country_province_list
            }
            switch_player_country_setup_effect = {
                RULER_NAME = Masinissa
                RULER_LAST_NAME = Ahmid
                RULER_CULTURE = libyan
                RULER_RELIGION = berber_religion
            }
            trigger_event = cyr_magas_01.1599
        }
    }
}

cyr_magas_01.1599 = {
    type = country_event
    hidden = yes
    immediate = {
        switch_player_country_effect = {
            NEW_NAME = libya_name
            NEW_ADJECTIVE = libya_adj
            NEW_GOVERNMENT = tribal_federation
            NEW_COLOR = eastern_roman_color
            NEW_RELIGION = berber_religion
            NEW_CULTURE = libyan
            NEW_TAG = LBU
            NEW_FLAG = LBU
            NEW_HERITAGE = libu_heritage
            OLD_COUNTRY_COLOR = judea_blue
            OLD_COUNTRY_NAME = CYR
            OLD_COUNTRY_ADJ = CYR_ADJ
            OLD_COUNTRY_FLAG = CYR
            OLD_COUNTRY_HERITAGE = cyrenaican_heritage
            OLD_COUNTRY_CULTURE = cyrenaican
            OLD_COUNTRY_RELIGION = roman_pantheon
            OLD_TAG = CYR
        }
        create_unit = {
            location = scope:cyr_barb_spawn_scope_1
            commander = scope:cyr_libyan_leader_scope
            while = {
                count = 3
                add_subunit = light_infantry 
            }
            while = {
                count = 2
                add_subunit = camels  
            }
        }
        c:EGY = {
            release_subject = c:LBU
            release_subject = c:CYR
        }
        p:3360.owner = {
            declare_war_with_wargoal = {
                war_goal = diadochi_wargoal
                target = p:3345.owner
            }
        }
    }
}

cyr_magas_01.16 = {          # Death of Ptolemy
    type = country_event
    title = cyr_magas_01.16.t
    desc = cyr_magas_01.16.desc
    picture = throneroom
    left_portrait = current_ruler
    fire_only_once = yes

    trigger = {
        tag = CYR
        has_completed_mission_task = cyrene_1_magas_task_1
        char:42 = {
            is_alive = no
        }
        NOT = {
            has_completed_mission_task = cyrene_1_magas_task_5 
            has_completed_mission_task = cyrene_1_magas_task_7 
            has_completed_mission_task = cyrene_1_magas_task_10 
            has_completed_mission_task = cyrene_1_magas_task_12
        }
    }

    option = {      
        name = cyr_magas_01.16.a 
        custom_tooltip = cyr_magas_01.16.a.tt
        set_variable = {
            name = cyr_magasbypass_all_flag
        }
    }

    option = {      
        name = cyr_magas_01.16.b  
        custom_tooltip = cyr_magas_01.16.b.tt
        set_variable = {
            name = cyr_magasbypass_libyan_flag
        }

    }

    option = {      
        name = cyr_magas_01.16.c  
        custom_tooltip = cyr_magas_01.16.c.tt

    }
}

cyr_magas_01.17 = {          # Art of WAR
    type = country_event
    title = cyr_magas_01.17.t
    desc = cyr_magas_01.17.desc
    picture = throneroom
    left_portrait = current_ruler
    right_portrait = scope:cyr_focus_martial_char_scope
    fire_only_once = yes

    trigger = {
        any_character = {
            OR = {
                has_office = office_marshal 
                has_office = office_master_of_the_guard 
            }
            martial > root.current_ruler.martial
        }
    }

    immediate = {
        random_character = {
            limit = {
                OR = {
                    has_office = office_marshal 
                    has_office = office_master_of_the_guard 
                }
                martial > current_ruler.martial
            }
            save_scope_as = cyr_focus_martial_char_scope
        }
    }

    option = {      
        name = cyr_magas_01.17.a 
        current_ruler = {
            add_martial = 1
        }
        scope:cyr_focus_martial_char_scope = {
            add_character_modifier = {
                name = cyr_advising_ruler 
                duration = -1
            }
        }

    }

    option = {      
        name = cyr_magas_01.17.b  

        trigger = {
            scope:cyr_focus_martial_char_scope = {
                OR = {
                    has_trait = original_thinker 
                    has_trait = tactician 
                    has_trait = disciplined 
                }
            }
        }

        scope:cyr_focus_martial_char_scope = {
            if = {
                limit = {
                    has_trait = original_thinker 
                }
                root.current_ruler = {
                    add_trait = original_thinker
                }
            }
            else_if = {
                limit = {
                    has_trait = tactician 
                }
                root.current_ruler = {
                    add_trait = tactician
                }
            }
            else = {
                root.current_ruler = {
                    add_trait = disciplined
                }
            }
        }
        scope:cyr_focus_martial_char_scope = {
            add_character_modifier = {
                name = cyr_advising_ruler 
                duration = -1
            }
        }
    }


    option = {      
        name = cyr_magas_01.17.c  
        current_ruler = {
            add_corruption = -5
        }
    }
}

cyr_magas_01.18 = {          # Levy Exercising
    type = country_event
    title = cyr_magas_01.18.t
    desc = cyr_magas_01.18.desc
    picture = throneroom
    left_portrait = current_ruler

    immediate = {
    }

    option = {      
        name = cyr_magas_01.18.a
        add_military_experience = 5
        current_ruler = {
            random_list = {
                50 = {
                    add_character_modifier = {
                        name = cyr_good_exercise
                        duration = 1825
                    }
                }
                30 = {
                    add_character_modifier = {
                        name = cyr_bad_exercise
                        duration = 1825
                    }
                }
                15 = {
                    add_trait = steadfast
                }
                5 = {
                    add_trait = wounded
                }
            }
        }
    }

    option = {      
        name = cyr_magas_01.18.b  

        trigger = {
            capital_scope = {
                free_building_slots >= 1
            }
        }

        add_treasury = -50
        capital_scope = {
            add_building_level = military_building 
        }
        current_ruler = {
            add_popularity = 5
        }
    }


    option = {      
        name = cyr_magas_01.18.c  
        add_country_modifier = {
            name = cyr_reviewing_ledgers
            duration = 1825
        }
    }
}

cyr_magas_01.19 = {          # Pardoning the Exiles
    type = country_event
    title = cyr_magas_01.19.t
    desc = cyr_magas_01.19.desc
    picture = throneroom
    left_portrait = current_ruler
    fire_only_once = yes

    trigger = {
    }

    immediate = { 
        random_country = {
            limit = {
                in_diplomatic_range = root
                country_culture_group = hellenic 
            }
            save_scope_as = cyr_exile_scope
        }
    }

    option = {      
        name = cyr_magas_01.19.a 
        while = {
            count = 3
            capital_scope = {
                create_state_pop = freemen
            }
        }
        add_country_modifier = {
            name = cyr_local_courts_disrespected
            duration = 3650
        }
    }

    option = {      
        name = cyr_magas_01.19.b  
        add_tyranny = -10
        region:greece_region = {
            random_region_province = {
                limit = {
                    NOT = { owner = root }
                }
                while = {
                    count = 3
                    define_pop = {
                        type = freemen
                        culture = cyrenaican
                        religion = root.religion
                    }
                }
            }
        }
    }


    option = {      
        name = cyr_magas_01.19.c 
        trigger = {
            exists = scope:cyr_exile_scope
            any_character = {
                is_rival = root.current_ruler
            }
        }
        random_character = {
            limit = {
                is_rival = root.current_ruler                
            }
            banish = scope:cyr_exile_scope
        }
        add_tyranny = 15
    }
}

cyr_magas_01.20 = {          # Libyan Mercenaries
    type = country_event
    title = cyr_magas_01.20.t
    desc = cyr_magas_01.20.desc
    picture = army_desert


    option = {      
        name = cyr_magas_01.20.a
        c:CYR = {
            create_unit = {
                name = cyr_libyan_mercs_name
                location = scope:cyr_libyan_mercs_spawn_province
                add_subunit = light_infantry 
                add_subunit = camels  
                add_subunit = camels 
                add_subunit = light_infantry 
                add_subunit = camels  
                add_subunit = camels
                add_subunit = supply_train
            }
        }
    }
    option = {      
        name = cyr_magas_01.20.b
        add_manpower = 4
        scope:cyr_libyan_mercs_spawn_province = {
            define_pop = {
                type = tribesmen
                culture = libyan
                religion = berber_religion
            }
            define_pop = {
                type = tribesmen
                culture = libyan
                religion = berber_religion
            }
        }
    }
}

cyr_magas_01.21 = {          # Royal Marriage - Country Selection
    type = country_event
    title = cyr_magas_01.21.t
    desc = cyr_magas_01.21.desc
    picture = greek_court
    
    left_portrait = current_ruler
    left_portrait = scope:cyr_marriage_country_scope_4.current_ruler
    left_portrait = scope:cyr_marriage_country_scope_5.current_ruler
    right_portrait = scope:cyr_marriage_country_scope_1.current_ruler
    right_portrait = scope:cyr_marriage_country_scope_2.current_ruler
    right_portrait = scope:cyr_marriage_country_scope_3.current_ruler

    trigger = {
    
    }

    immediate = {
        random_in_list = {
            list = cyr_marriage_candidate_list
            save_scope_as = cyr_marriage_country_scope_1
            remove_from_list = cyr_marriage_candidate_list
        }
        random_in_list = {
            list = cyr_marriage_candidate_list
            save_scope_as = cyr_marriage_country_scope_2
            remove_from_list = cyr_marriage_candidate_list
        }
        random_in_list = {
            list = cyr_marriage_candidate_list
            save_scope_as = cyr_marriage_country_scope_3
            remove_from_list = cyr_marriage_candidate_list
        }
        random_in_list = {
            list = cyr_marriage_candidate_list
            save_scope_as = cyr_marriage_country_scope_4
            remove_from_list = cyr_marriage_candidate_list
        }
        random_in_list = {
            list = cyr_marriage_candidate_list
            save_scope_as = cyr_marriage_country_scope_5
            remove_from_list = cyr_marriage_candidate_list
        }
    }

    option = {      
        name = cyr_magas_01.21.a
        trigger = {
            exists = scope:cyr_marriage_country_scope_1
        }
        scope:cyr_marriage_country_scope_1 = {
            trigger_event = { id = cyr_magas_01.22 }
        }
    }

    option = {      
        name = cyr_magas_01.21.b
        trigger = {
            exists = scope:cyr_marriage_country_scope_2
        }
        scope:cyr_marriage_country_scope_2 = {
            trigger_event = { id = cyr_magas_01.22 }
        }
    }

    option = {      
        name = cyr_magas_01.21.c
        trigger = {
            exists = scope:cyr_marriage_country_scope_3
        }
        scope:cyr_marriage_country_scope_3 = {
            trigger_event = { id = cyr_magas_01.22 }
        }
    }

    option = {      
        name = cyr_magas_01.21.d
        trigger = {
            exists = scope:cyr_marriage_country_scope_4
        }
        scope:cyr_marriage_country_scope_4 = {
            trigger_event = { id = cyr_magas_01.22 }
        }
    }

    option = {      
        name = cyr_magas_01.21.e
        trigger = {
            exists = scope:cyr_marriage_country_scope_5
        }
        scope:cyr_marriage_country_scope_5 = {
            trigger_event = { id = cyr_magas_01.22 }
        }
    }

    option = {      
        name = cyr_magas_01.21.f
    }
}

cyr_magas_01.22 = {          # Royal Marriage - Offer 
    type = country_event
    title = cyr_magas_01.22.t
    desc = cyr_magas_01.22.desc
    picture = greek_court
    
    left_portrait = current_ruler

    trigger = {
    
    }

    immediate = {
        ordered_character = {
            limit = {
                is_female = yes
                age <= 35
                is_adult = yes 
            }
            order_by = cyr_royal_marriage_fit_svalue
            max = 1
            save_scope_as = cyr_marriage_princess_scope
        }
        if = {
            limit = {
                OR = {
                    NOT = { exists = scope:cyr_marriage_princess_scope }
                    NOT = { scope:cyr_marriage_princess_scope.employer = ROOT }
                }
            }
            create_character = {
                age = 17
                female = yes
                culture = root.culture
                religion = root.religion
                add_prominence = 50
                save_scope_as = cyr_marriage_princess_scope
            }
        }
        root = {
            save_scope_as = cyr_royal_marriage_country
        }
    }

    option = {      
        name = cyr_magas_01.22.a

        c:CYR = {
            trigger_event = { 
               id = cyr_magas_01.23 
               days = { 5 25 }
            }
        }
        show_as_tooltip = {
            scope:cyr_marriage_princess_scope = {  
                if = {
                    limit = { is_married = yes }
                    divorce_character = spouse
                }
                move_country = c:CYR
                hidden_effect = { 
                    remove_character_modifier = foreign_citizen
                    set_home_country = c:CYR 
                    set_as_minor_character = scope:cyr_marriage_princess_scope
                }
            }
            c:CYR.current_ruler = {
                if = {
                    limit = { is_married = yes }
                    divorce_character = spouse
                }
            }
            c:CYR.current_ruler = {
                marry_character = scope:cyr_marriage_princess_scope
            }
            custom_tooltip = cyr_magas_01.23.a.tt
            ROOT = {
                add_opinion = {
                    modifier = CYR_royal_marriage
                    target = c:CYR
                }
            }
        }        
    }
    option = {      
        name = cyr_magas_01.22.b
        ai_chance = { factor = 0 }

        c:CYR = {
            trigger_event = { 
               id = cyr_magas_01.24 
               days = { 5 25 }
            }
        } 
        set_variable = {
            name = cyr_royal_marriage_blocker
        }
        c:CYR = {
            add_opinion = {
                modifier = cyr_marriage_offer_rejected
                target = ROOT
            }
        }
    }
}

cyr_magas_01.23 = {          # Royal Marriage - Main Event
    type = country_event
    title = cyr_magas_01.23.t
    desc = cyr_magas_01.23.desc
    picture = religious_rite
    
    left_portrait = current_ruler
    right_portrait = scope:cyr_marriage_princess_scope

    trigger = {
    
    }

    immediate = {       
        root.current_ruler = {
            save_scope_as = cyr_royal_marriage_groom 
        }
        scope:cyr_marriage_princess_scope = {
            save_scope_as = cyr_royal_marriage_bride
        }
    }

    option = {      
        name = cyr_magas_01.23.a
        
        scope:cyr_royal_marriage_bride = {  
            if = {
                limit = { is_married = yes }
                divorce_character = spouse
            }
            move_country = c:CYR
            hidden_effect = { 
                remove_character_modifier = foreign_citizen
                set_home_country = c:CYR 
                set_as_minor_character = scope:cyr_royal_marriage_bride
            }
        }
        scope:cyr_royal_marriage_groom = {
            if = {
                limit = { is_married = yes }
                divorce_character = spouse
            }
        }
        scope:cyr_royal_marriage_groom = {
            marry_character = scope:cyr_royal_marriage_bride
        }
        custom_tooltip = cyr_magas_01.23.a.tt
        scope:cyr_royal_marriage_country = {
            set_variable = {
                name = cyr_royal_marrriage_marker
            }
        }
        scope:cyr_royal_marriage_country = {
            add_opinion = {
                modifier = CYR_royal_marriage
                target = ROOT
            }
        }
    }
}
 
cyr_magas_01.24 = {          # Royal Marriage - Country Selection Redo
    type = country_event
    title = cyr_magas_01.24.t
    desc = cyr_magas_01.24.desc
    picture = greek_court
    
    left_portrait = current_ruler

    trigger = {
    
    }

    immediate = {
    }

    option = {      
        name = cyr_magas_01.21.a
        trigger = {
            exists = scope:cyr_marriage_country_scope_1
            scope:cyr_marriage_country_scope_1 = {
                NOT = { has_variable = cyr_royal_marriage_blocker }
            }
        }
        scope:cyr_marriage_country_scope_1 = {
            trigger_event = { id = cyr_magas_01.22 }
        }
    }

    option = {      
        name = cyr_magas_01.21.b
        trigger = {
            exists = scope:cyr_marriage_country_scope_2
            scope:cyr_marriage_country_scope_2 = {
                NOT = { has_variable = cyr_royal_marriage_blocker }
            }
        }
        scope:cyr_marriage_country_scope_2 = {
            trigger_event = { id = cyr_magas_01.22 }
        }
    }

    option = {      
        name = cyr_magas_01.21.c
        trigger = {
            exists = scope:cyr_marriage_country_scope_3
            scope:cyr_marriage_country_scope_3 = {
                NOT = { has_variable = cyr_royal_marriage_blocker }
            }
        }
        scope:cyr_marriage_country_scope_3 = {
            trigger_event = { id = cyr_magas_01.22 }
        }
    }

    option = {      
        name = cyr_magas_01.21.d
        trigger = {
            exists = scope:cyr_marriage_country_scope_4
            scope:cyr_marriage_country_scope_4 = {
                NOT = { has_variable = cyr_royal_marriage_blocker }
            }
        }
        scope:cyr_marriage_country_scope_4 = {
            trigger_event = { id = cyr_magas_01.22 }
        }
    }

    option = {      
        name = cyr_magas_01.21.e
        trigger = {
            exists = scope:cyr_marriage_country_scope_5
            scope:cyr_marriage_country_scope_5 = {
                NOT = { has_variable = cyr_royal_marriage_blocker }
            }
        }
        scope:cyr_marriage_country_scope_5 = {
            trigger_event = { id = cyr_magas_01.22 }
        }
    }

    option = {      
        name = cyr_magas_01.21.f
    }
}

cyr_magas_01.25 = {
    type = country_event
    title = cyr_magas_01.25.t
    desc = cyr_magas_01.25.desc
    picture = successors
    
    left_portrait = char:46
    right_portrait = char:18

    trigger = {   
    }

    immediate = {
    }

    option = {      
        name = cyr_magas_01.25.a
        add_treasury = 50
        add_political_influence = 10
        ordered_owned_province = {
            limit = {
                free_building_slots >= 1
            }
            order_by = total_population
            max = 1
            add_building_level = town_hall_building  
        }
    }
    option = {      
        name = cyr_magas_01.25.b
        custom_tooltip = cyr_magas_01.25.b.tt
#        hidden_effect = {
            while = {
                count = 3
                create_character = {
                    family_name = "Magid"
                    culture = macedonian
                    religion = roman_pantheon
                    while = {
                        count = 3
                        random_list = {
                            25 = { add_zeal = 1 }
                            25 = { add_charisma = 1 }
                            25 = { add_finesse = 1 }
                            25 = { add_martial = 1 }
                        }
                    }
                    set_family = root.current_ruler.family
                    add_loyalty = cyr_magid_family_recruit
                }
            }
#        }
    }
    option = {      
        name = cyr_magas_01.25.c
        add_country_modifier = {
            name = cyr_supporting_berenike
            duration = 3650
        }
        cyr_coup_support_small_effect = yes
    }
}

cyr_magas_01.26 = {
    type = country_event
    title = cyr_magas_01.26.t
    desc = cyr_magas_01.26.desc
    picture = greek_home
    
    left_portrait = current_ruler


    option = {      
        name = cyr_magas_01.26.a
        current_ruler = {
            add_popularity = 5
        }
    }
}