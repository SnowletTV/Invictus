namespace = flavor_cyprus
    

flavor_cyprus.1 = {                   # Cypriot Kings
    type = country_event
    title = "flavor_cyprus.1.t"
    desc = "flavor_cyprus.1.desc"
    picture = throneroom
    left_portrait = current_ruler
    right_portrait = scope:menelaos_lagid
    right_portrait = scope:eunostos_of_soloi
    
    immediate = {
        hidden_effect = {
            if = {#Eunostos
                limit = {
                    char:430 = {
                        is_alive = yes 
                    }
                }
                char:430 = { save_scope_as = eunostos_of_soloi }
            }
            else = {#Eunostos backup
                create_character = {
                    female = no
                    family_name = "Pasikratid"
                    culture = cypriot
                    religion = roman_pantheon
                    no_stats = yes
                    good_martial_effect = yes
                    average_charisma_effect = yes
                    good_finesse_effect = yes
                    average_zeal_effect = yes
                    save_scope_as = eunostos_of_soloi
                }
            }
            if = {#Menelaos
                limit = {
                    char:47 = {
                        is_alive = yes 
                    }
                }
                char:47 = { save_scope_as = menelaos_lagid }
            }
            else = {#Menelaos backup
                create_character = {
                    female = no
                    family = c:EGY.fam:Lagid
                    father=char:47                    
                    family_name = "Pasikratid"
                    culture = cypriot
                    religion = roman_pantheon
                    force_add_trait="lagids"
                    no_stats = yes
                    average_martial_effect = yes
                    average_charisma_effect = yes
                    good_finesse_effect = yes
                    good_zeal_effect = yes
                    save_scope_as = menelaos_lagid
                }
            }
            p:331 = { #Salamis
                create_country = {
                    save_scope_as = cyprus_country
                    change_government = despotic_monarchy
                }
            }
            scope:menelaos_lagid = {
                move_country_with_close_family_effect = { COUNTRY = scope:cyprus_country }
            }
            scope:cyprus_country = {
                set_as_ruler = scope:menelaos_lagid 
                change_country_name = CYP
                change_country_adjective = CYP_ADJ
                change_country_tag = CYP
                change_country_flag = CYPRUS_RUST
                change_country_color = spartan_rust                   
            }
            every_owned_province = {
                limit = { is_in_area = cyprus_area }
                set_conquered_by = scope:cyprus_country
            }
        }
    }


    option = { # Eunostos shall have his kingdom returned to him
        name = "flavor_cyprus.1.a"
        custom_tooltip = flavor_cyprus.1.at
        hidden_effect = {
            p:333 = {
                create_country = {
                    save_scope_as = soloi_country
                    change_government = despotic_monarchy
                }
            }
            scope:eunostos_of_soloi = {
                move_country_with_entire_family_effect = { COUNTRY = scope:soloi_country }
            }
            scope:soloi_country = {
                set_as_ruler = scope:eunostos_of_soloi 
                change_country_name = SOLOI_NAME
                change_country_adjective = CYPRUS_ADJECTIVE
                change_country_flag = ALASHIYA_FLAG
                change_country_color = alashiya_color      
            }           
        }
        make_subject = {
            target = scope:cyprus_country
            type = feudatory
        }
        make_subject = {
            target = scope:soloi_country
            type = feudatory
        }            
        add_treasury = {
            value = has_monthly_income
            multiply = 2
        }              
        ai_chance = { factor = 5 }
    }


    option = {
        name = "flavor_cyprus.1.b" # Divide Cyprus - Eunostos shall be rewarded for his fidelity
        custom_tooltip = flavor_cyprus.1.bt
        hidden_effect = {
            p:333 = {
                create_country = {
                    save_scope_as = soloi_country
                    change_government = despotic_monarchy
                }
            }
            scope:eunostos_of_soloi = {
                move_country_with_entire_family_effect = { COUNTRY = scope:soloi_country }
            }
            hidden_effect = {
                scope:soloi_country = {
                    set_as_ruler = scope:eunostos_of_soloi 
                    change_country_name = SOLOI_NAME
                    change_country_adjective = CYPRUS_ADJECTIVE
                    change_country_flag = CYPRUS_RUST
                    change_country_color = spartan_rust     
                    p:6431 = { add_to_list = southern_cyprus_list }
                    p:333 = { add_to_list = southern_cyprus_list }
                    p:334 = { add_to_list = southern_cyprus_list }
                    p:7990 = { add_to_list = southern_cyprus_list }
                    p:338 = { add_to_list = southern_cyprus_list }
 #                   p:336 = { add_to_list = southern_cyprus_list }   
                }      
                every_in_list = {
                    list = southern_cyprus_list
                    set_conquered_by = scope:soloi_country
                }
            }  
        }
        make_subject = {
            target = scope:cyprus_country
            type = feudatory
        }
        make_subject = {
            target = scope:soloi_country
            type = feudatory
        } 
        add_treasury = {
            value = has_monthly_income
            multiply = 6
        }
        ai_chance = { factor = 10 } 
    }

    option = {
        name = "flavor_cyprus.1.c" # We must recall [menelaos_lagid.GetPraenomen] at once
        custom_tooltip = flavor_cyprus.1.ct
        hidden_effect = {
            scope:menelaos_lagid = {
                move_country_with_close_family_effect = { COUNTRY = ROOT }
            }
            scope:eunostos_of_soloi = {
                move_country_with_entire_family_effect = { COUNTRY = scope:cyprus_country }
            }  
        }
        scope:cyprus_country = {
            set_as_ruler = scope:eunostos_of_soloi  
            set_capital = p:333
        }   
        make_subject = {
            target = scope:cyprus_country
            type = satrapy
        }
        scope:menelaos_lagid = { add_loyalty = loyalty_plot_appeal_insulted }
        ai_chance = { factor = 10 } 
    }   

    option = {
        name = "flavor_cyprus.1.d" # Give all of Cyprus to Menalaos as a satrapy
 #       custom_tooltip = flavor_cyprus.1.dt
        make_subject = {
            target = scope:cyprus_country
            type = satrapy
        }       
        scope:eunostos_of_soloi = { add_loyalty = loyalty_plot_appeal_insulted }
        ai_chance = { factor = 30 } 
    }  

    option = {
        name = "flavor_cyprus.1.e" # Neither man is fit to govern
        highlight = yes
        custom_tooltip = flavor_cyprus.1.et
        add_tyranny = 20
        hidden_effect = { 
            scope:menelaos_lagid = {
                move_country_with_close_family_effect = { COUNTRY = ROOT }
            }
        }
        scope:cyprus_country = {
            every_owned_province = {
                limit = { is_in_area = cyprus_area }
                set_conquered_by = ROOT
            }
        }        
        scope:menelaos_lagid = { add_loyalty = loyalty_plot_appeal_insulted }
        scope:eunostos_of_soloi = { add_loyalty = loyalty_plot_appeal_insulted }
        ai_chance = { factor = 0 } 
    } 

}