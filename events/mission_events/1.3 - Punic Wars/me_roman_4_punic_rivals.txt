namespace = me_roman_4_punic_rivals

me_roman_4_punic_rivals.1 = {							# 4 - Deter Punic Support - Start
    type = country_event
    title = me_roman_4_punic_rivals.1.t
	desc = me_roman_4_punic_rivals.1.desc
    picture = celtic_village
    
    left_portrait = current_ruler
	right_portrait = c:CAR.current_ruler

    trigger = { has_land = yes }
	
	immediate = {
		set_variable = {
			name = rm_4_deter_support_flag
			days = 180
		}
		if = {
			limit = {
				any_country = {
					capital_scope = {
						OR = {
							is_in_region = tarraconensis_region
							is_in_region = baetica_region
							is_in_region = contestania_region
							trigger_if = {
								limit ={
									c:ROM = {
										any_owned_province = {
											OR = {
												is_in_region = gallaecia_region
												is_in_region = lusitania_region
											}
									}
									}
								}
								OR = {
									is_in_region = gallaecia_region
									is_in_region = lusitania_region
								}
							}
						}
						
					}
					OR = {
						country_culture_group = proto_european
						country_culture_group = celt_iberia
						country_culture_group = iberia
					}
					NOR = { 
						this = c:ROM
						is_subject_of = c:ROM
						war_with = c:ROM
					}
					is_ai = no
					in_diplomatic_range = c:ROM
					NOT = { has_variable = rm_4_iberian_player_flag }
				}
			}
			every_country = {
				limit = {
					any_country = {
						capital_scope = {
							OR = {
								is_in_region = tarraconensis_region
								is_in_region = baetica_region
								is_in_region = contestania_region
								trigger_if = {
									limit ={
										c:ROM = {
											any_owned_province = {
												OR = {
													is_in_region = gallaecia_region
													is_in_region = lusitania_region
												}
										}
										}
									}
									OR = {
										is_in_region = gallaecia_region
										is_in_region = lusitania_region
									}
								}
							}
							
						}
						OR = {
							country_culture_group = proto_european
							country_culture_group = celt_iberia
							country_culture_group = iberia
						}
						NOR = { 
							this = c:ROM
							is_subject_of = c:ROM
							war_with = c:ROM
						}
						is_ai = no
						in_diplomatic_range = c:ROM
						NOT = { has_variable = rm_4_iberian_player_flag }
					}
				}
				set_variable = {
					name = rm_4_iberian_player_flag
					days = 180
				}
			}
		}
	}
	
    option = {							# Go ham
        name = me_roman_4_punic_rivals.1.a
		set_variable = {
			name = rm_4_deter_big_spender_flag
			days = 180
		}
		add_treasury = {
			value = has_monthly_income 
			multiply = -2.4
		}
		custom_tooltip = me_roman_4_punic_rivals.1.at
    }

	option = {							# Don't 
        name = me_roman_4_punic_rivals.1.b
		add_treasury = {
			value = has_monthly_income 
			multiply = -1.2
		}
    }
	
	after = {
		if = {
			limit = {
				any_country = { has_variable = rm_4_iberian_player_flag }
			}
			trigger_event = {
				id = me_roman_4_punic_rivals.3
				days = 90
			}
		}
	}
}

me_roman_4_punic_rivals.2 = {							# 4 - Deter Punic Support - End
    type = country_event
    title = me_roman_4_punic_rivals.2.t
    desc = me_roman_4_punic_rivals.2.desc
    picture = council_country
    
    left_portrait = current_ruler
	right_portrait = scope:rm_4_deter_1.current_ruler
	right_portrait = scope:rm_4_deter_2.current_ruler
	right_portrait = scope:rm_4_deter_3.current_ruler

    trigger = { 
		has_land = yes
		any_country = {
			capital_scope = {
				OR = {
					is_in_region = tarraconensis_region
					is_in_region = baetica_region
					is_in_region = contestania_region
					trigger_if = {
						limit ={
							c:ROM = {
								any_owned_province = {
									OR = {
										is_in_region = gallaecia_region
										is_in_region = lusitania_region
									}
								}
							}
						}
						OR = {
							is_in_region = gallaecia_region
							is_in_region = lusitania_region
						}
					}
				}
			}
			OR = {
				country_culture_group = proto_european
				country_culture_group = celt_iberia
				country_culture_group = iberia
			}
			in_diplomatic_range = c:ROM
			NOR = { 
				this = c:ROM
				is_subject_of = c:ROM
				war_with = c:ROM
			}
		}
	}

	immediate = {
		every_country = {
			limit = {
				capital_scope = {
					OR = {
						is_in_region = tarraconensis_region
						is_in_region = baetica_region
						is_in_region = contestania_region
						trigger_if = {
							limit ={
								c:ROM = {
									any_owned_province = {
										OR = {
											is_in_region = gallaecia_region
											is_in_region = lusitania_region
										}
									}
								}
							}
							OR = {
								is_in_region = gallaecia_region
								is_in_region = lusitania_region
							}
						}
					}
				}
				OR = {
					country_culture_group = proto_european
					country_culture_group = celt_iberia
					country_culture_group = iberia
				}
				is_ai = yes
				in_diplomatic_range = c:ROM
				NOR = { 
					this = c:ROM
					is_subject_of = c:ROM
					war_with = c:ROM
					has_variable = rm_4_deter_done_flag
				}
			}
			set_variable = {
				name = rm_4_convincing_flag
				days = 180
			}
			random_list = {
				5 = {
					if = {
						limit = {
							OR = {
								is_subject_of = c:CAR
								alliance_with = c:CAR
							}
						}
						hidden_effect = {
							add_opinion = { target = c:ROM modifier = rm_4_loyal_rom_opmod }
							add_opinion = { target = c:CAR modifier = rm_4_loyal_car_opmod }
						}
					}
					modifier = {
						factor = 10
						AND = {
							OR = {
								alliance_with = c:CAR
								is_subject_of = c:CAR
							}
							opinion = { target = c:CAR value >= 100 }
						}
					}
					modifier = {
						factor = 10
						AND = {
							OR = {
								alliance_with = c:CAR
								is_subject_of = c:CAR
							}
							opinion = { target = c:ROM value <= 0 }
						}
					}
					modifier = {
						factor = 10
						AND = {
							NOR = {
								alliance_with = c:CAR
								is_subject_of = c:CAR
							}
							opinion = { target = c:CAR value >= 50 }
						}
					}
					modifier = {
						factor = 10
						AND = {
							NOR = {
								alliance_with = c:CAR
								is_subject_of = c:CAR
							}
							opinion = { target = c:ROM value <= 50 }
						}
					}
				}
				5 = {
					set_variable = {
						name = rm_4_deter_convinced_flag
						days = 180
					}
					hidden_effect = {
						add_opinion = { target = c:ROM modifier = rm_4_convinced_rom_opmod }
						add_opinion = { target = c:CAR modifier = rm_4_convinced_car_opmod }
					}
					modifier = {
						factor = 10
						opinion = { target = c:CAR value <= 0 }
					}
					modifier = {
						factor = 10
						opinion = { target = c:ROM value >= 50 }
					}
					modifier = {
						factor = 5
						c:ROM = { has_variable = rm_4_deter_big_spender_flag }
					}
				}
			}
		}
		if = {
			limit = {
				NAND = {
					exists = scope:rm_4_deter_1
					exists = scope:rm_4_deter_2
					exists = scope:rm_4_deter_3
				}
				any_country = {
					has_variable = rm_4_deter_convinced_flag
					NOR = {
						AND = {
							exists = scope:rm_4_deter_1
							this = scope:rm_4_deter_1
						}
						AND = {
							exists = scope:rm_4_deter_2
							this = scope:rm_4_deter_2
						}
						AND = {
							exists = scope:rm_4_deter_3
							this = scope:rm_4_deter_3
						}
					}
				}
			}
			while = {
				limit = {
					NAND = {
						exists = scope:rm_4_deter_1
						exists = scope:rm_4_deter_2
						exists = scope:rm_4_deter_3
					}
					any_country = {
						has_variable = rm_4_deter_convinced_flag
						NOR = {
							AND = {
								exists = scope:rm_4_deter_1
								this = scope:rm_4_deter_1
							}
							AND = {
								exists = scope:rm_4_deter_2
								this = scope:rm_4_deter_2
							}
							AND = {
								exists = scope:rm_4_deter_3
								this = scope:rm_4_deter_3
							}
						}
					}
				}
				ordered_country = {
					limit = { 
						has_variable = rm_4_deter_convinced_flag
						NOR = {
							AND = {
								exists = scope:rm_4_deter_1
								this = scope:rm_4_deter_1
							}
							AND = {
								exists = scope:rm_4_deter_2
								this = scope:rm_4_deter_2
							}
							AND = {
								exists = scope:rm_4_deter_3
								this = scope:rm_4_deter_3
							}
						}
					}
					order_by = num_of_cities
					if = {
						limit = { 
							NOT = { exists = scope:rm_4_deter_1 }
						}
						save_scope_as = rm_4_deter_1
					}
					else_if = {
						limit = { 
							exists = scope:rm_4_deter_1
							NOT = { exists = scope:rm_4_deter_2 }
						}
						save_scope_as = rm_4_deter_2
					}
					else_if = {
						limit = { 
							exists = scope:rm_4_deter_1
							exists = scope:rm_4_deter_2
							NOT = { exists = scope:rm_4_deter_3 }
						}
						save_scope_as = rm_4_deter_3
					}
				}
			}
		}
		show_as_tooltip = {
			c:CAR = {
				add_opinion = { target = root modifier = rm_4_badmouthed_opmod }
			}
		}
	}

    option = {							# Results  
        name = me_roman_4_punic_rivals.2.a
		custom_tooltip = me_roman_4_punic_rivals.2.countertt
		if = {
			limit = {
				any_country = { 
					NOT = { has_variable = rm_4_deter_convinced_flag }
					has_variable = rm_4_convincing_flag
					OR = {
						alliance_with = c:CAR
						is_subject_of = c:CAR
					}
				}
			}
			custom_tooltip = me_roman_4_punic_rivals.2_loyal_countertt
		}
		c:CAR = {
			trigger_event = { id = me_roman_4_punic_rivals.10 }
		}
	}
}

me_roman_4_punic_rivals.3 = {							# 4 - Deter Punic Support - Player event
    type = country_event
    title = me_roman_4_punic_rivals.3.t
    desc = {
		desc = me_roman_4_punic_rivals.3.desc
		first_valid = {
			triggered_desc = {
				trigger = {
					OR = {
						is_subject_of = c:CAR
						alliance_with = c:CAR
					}
				}
				desc = me_roman_4_punic_rivals.3.desc_1
			}
			triggered_desc = {
				trigger = {
					NOR = {
						is_subject_of = c:CAR
						alliance_with = c:CAR
					}
				}
				desc = me_roman_4_punic_rivals.3.desc_2
			}
		}
	}
    picture = council_country
    
    left_portrait = current_ruler
	right_portrait = c:ROM.current_ruler
	right_portrait = c:CAR.current_ruler

    trigger = { 
		has_land = yes
		c:CAR = { has_land = yes }
	}
	
	immediate = {
		if = {
			limit = {
				c:ROM = { has_variable = rm_4_deter_big_spender_flag }
			}
			add_treasury = {
				value = has_monthly_income
				multiply = 2
			}					
		}
		else = {
			add_treasury = {
				value = has_monthly_income
				multiply = 1
			}
		}
		set_variable = {
			name = rm_4_deter_done_flag
			days = 180
		}
	}

    option = {							# Loyal to Carthage   
        name = me_roman_4_punic_rivals.3.a
		trigger = {
			OR = {
				is_subject_of = c:CAR
				alliance_with = c:CAR
			}
		}
		add_opinion = { target = c:ROM modifier = rm_4_loyal_rom_opmod }
		add_opinion = { target = c:CAR modifier = rm_4_loyal_car_opmod }		
	}
	
	option = {							# Distrustful    
        name = me_roman_4_punic_rivals.3.b
		trigger = {
			NOR = {
				is_subject_of = c:CAR
				alliance_with = c:CAR
			}
		}
    }
	
	option = {							# Convinced  
        name = me_roman_4_punic_rivals.3.c
		set_variable = {
			name = rm_4_deter_convinced_flag
			value = 3 # Convinced
			days = 180
		}
		add_opinion = { target = c:ROM modifier = rm_4_convinced_rom_opmod }
		add_opinion = { target = c:CAR modifier = rm_4_convinced_car_opmod }
    }
}

me_roman_4_punic_rivals.4 = {							# 4 - Disarm Carthage - Start
    type = country_event
    title = me_roman_4_punic_rivals.4.t
    desc = me_roman_4_punic_rivals.4.desc
    picture = council_country
    
    left_portrait = current_ruler
	right_portrait = c:CAR.current_ruler

    trigger = { 
		has_land = yes
		c:CAR = { 
			has_land = yes
			is_subject = no
		}
	}
	
    option = {							#    
        name = me_roman_4_punic_rivals.4.a
		custom_tooltip = me_roman_4_punic_rivals.4.at
	}
	
	option = {							#    
        name = me_roman_4_punic_rivals.4.b
		set_variable = {
			name = rm_4_bad_offer_flag
			days = 180
		}
		custom_tooltip = me_roman_4_punic_rivals.4.bt
	}
	
	after = {
		c:CAR = {
			trigger_event = {
				id = me_roman_4_punic_rivals.5
				days = 5
			}
		}
	}
}

me_roman_4_punic_rivals.5 = {							# 4 - Disarm Carthage - Event for Carthage
    type = country_event
    title = me_roman_4_punic_rivals.5.t
    desc = {
		first_valid = {
			triggered_desc = {
				trigger = { 
					c:ROM = { has_variable = rm_4_bad_offer_flag }
				}
				desc = me_roman_4_punic_rivals.5.desc_1
			}
			triggered_desc = {
				trigger = { 
					NOT = {
						c:ROM = { has_variable = rm_4_bad_offer_flag }
					}
				}
				desc = me_roman_4_punic_rivals.5.desc_2
			}
		}
	}
    picture = council_country
    
    left_portrait = current_ruler
	right_portrait = c:ROM.current_ruler

    trigger = { 
		has_land = yes
		c:CAR = { has_land = yes }
	}
	
    option = {							# Accept   
        name = me_roman_4_punic_rivals.5.a
		trigger = {
			NOT = {
				c:ROM = { has_variable = rm_4_bad_offer_flag }
			}
		}
		show_as_tooltip = {
			c:ROM = {
				make_subject = { # Make tributary
					target = root
					type = tributary
				}
			}
		}
		set_variable = { 
			name = rm_4_carthage_debt_flag
			days = 18250 # 50 years
		}
		set_variable = {
			name = rm_4_carthage_debt_cooldown_flag
			days = 3650 # 10 years
		}
		trigger_event = {
			id = me_roman_4_punic_rivals.12
			days = { 5475 10950 } # 15-30 years
		}
		ai_chance = {
			factor = 95
		}
	}
	
	option = {							# Refuse  
        name = me_roman_4_punic_rivals.5.b
		trigger = {
			NOT = {
				c:ROM = { has_variable = rm_4_bad_offer_flag }
			}
		}
		hidden_effect = {
			capital_scope.area = {
				every_area_province = {
					add_claim = c:ROM
				}
			}
		}
		custom_tooltip = me_roman_4_punic_rivals.5.bt
		show_as_tooltip = {
			c:ROM = {
				declare_war_with_wargoal = {
					war_goal = imperial_conquest_wargoal
					target = c:CAR
				}
			}
		}
		ai_chance = {
			factor = 5
		}
	}
	
	option = {							# Refuse  
        name = me_roman_4_punic_rivals.5.c
		trigger = {
			c:ROM = { has_variable = rm_4_bad_offer_flag }
		}
		hidden_effect = {
			capital_scope.area = {
				every_area_province = {
					add_claim = c:ROM
				}
			}
		}
		custom_tooltip = me_roman_4_punic_rivals.5.bt
		show_as_tooltip = {
			c:ROM = {
				declare_war_with_wargoal = {
					war_goal = imperial_conquest_wargoal
					target = c:CAR
				}
			}
		}
	}
	
	after = {
		c:ROM = {
			trigger_event = {
				id = me_roman_4_punic_rivals.6
				days = 5
			}
		}
	}
}

me_roman_4_punic_rivals.6 = {							# 4 - Disarm Carthage - Response from Carthage
    type = country_event
    title = me_roman_4_punic_rivals.6.t
    desc = {
		desc = me_roman_4_punic_rivals.6.desc
		first_valid = {
			triggered_desc = {
				trigger = { 
					c:CAR = { has_variable = rm_4_carthage_debt_flag }
				}
				desc = me_roman_4_punic_rivals.6.desc_1
			}
			triggered_desc = {
				trigger = { 
					NOT = {
						c:CAR = { has_variable = rm_4_carthage_debt_flag }
					}
				}
				desc = me_roman_4_punic_rivals.6.desc_2
			}
		}
	}
    picture = council_country
    
    left_portrait = current_ruler
	right_portrait = c:CAR.current_ruler

    trigger = { 
		has_land = yes
		c:CAR = { has_land = yes }
	}

    option = {							# Carthage submits
        name = me_roman_4_punic_rivals.6.a
		trigger = { 
			c:CAR = { has_variable = rm_4_carthage_debt_flag }
		}
		hidden_effect = {
			if = {
				limit = {
					c:CAR = {
						any_subject = {
							count >= 1
						}
					}
				}
				c:CAR = {
					every_subject = {
						c:CAR = { release_subject = PREV }
					}
				}
			}
		}
		c:ROM = {
			make_subject = { # Make tributary
				target = c:CAR
				type = tributary
			}
		}
		custom_tooltip = me_roman_4_punic_rivals.6.at
	}
	
	option = {							# Carthage refuses
		name = me_roman_4_punic_rivals.6.b
		trigger = { 
			NOT = {
				c:CAR = { has_variable = rm_4_carthage_debt_flag }
			}
		}
		c:ROM = {
			declare_war_with_wargoal = {
				war_goal = imperial_conquest_wargoal
				target = c:CAR
			}
		}
		custom_tooltip = me_roman_4_punic_rivals.6.bt
		if = {
			limit = { has_truce_with = c:CAR }
			custom_tooltip = me_roman_4_punic_rivals.6.bt2
		}
	}
}

me_roman_4_punic_rivals.7 = {							# 4 - Undermine Allies - Start
    type = country_event
    title = me_roman_4_punic_rivals.7.t
	desc = me_roman_4_punic_rivals.7.desc
    picture = senator_conversing
    
    left_portrait = current_ruler
	right_portrait = c:CAR.current_ruler

    trigger = { has_land = yes }
	
	immediate = {
		set_variable = {
			name = rm_4_undermine_allies_flag
			days = 180
		}
		if = {
			limit = {
				any_country = {
					OR = {
						is_subject_of = c:CAR
						alliance_with = c:CAR
					}
					NOT = { this = c:ROM }
					is_ai = no
					in_diplomatic_range = c:ROM
					NOT = { has_variable = rm_4_ally_player_flag }
				}
			}
			every_country = {
				limit = {
					any_country = {
						OR = {
							is_subject_of = c:CAR
							alliance_with = c:CAR
						}
					}
					NOT = { this = c:ROM }
					is_ai = no
					in_diplomatic_range = c:ROM
					NOT = { has_variable = rm_4_ally_player_flag }
				}
				set_variable = {
					name = rm_4_ally_player_flag
					days = 180
				}
			}
		}
	}
	
    option = {							# Go ham
        name = me_roman_4_punic_rivals.7.a
		set_variable = {
			name = rm_4_deter_big_spender_flag
			days = 180
		}
		add_treasury = {
			value = has_monthly_income 
			multiply = -2.4
		}
		custom_tooltip = me_roman_4_punic_rivals.1.at
    }

	option = {							# Don't 
        name = me_roman_4_punic_rivals.7.b
		add_treasury = {
			value = has_monthly_income 
			multiply = -1.2
		}
    }
	
	after = {
		if = {
			limit = {
				any_country = { has_variable = rm_4_ally_player_flag }
			}
			trigger_event = {
				id = me_roman_4_punic_rivals.9
				days = 90
			}
		}
	}
}

me_roman_4_punic_rivals.8 = {							# 4 - Undermine Allies - End
    type = country_event
    title = me_roman_4_punic_rivals.2.t
    desc = me_roman_4_punic_rivals.8.desc
    picture = council_country
    
    left_portrait = current_ruler
	right_portrait = scope:rm_4_deter_1.current_ruler
	right_portrait = scope:rm_4_deter_2.current_ruler
	right_portrait = scope:rm_4_deter_3.current_ruler

    trigger = { 
		has_land = yes
		any_country = {
			OR = {
				is_subject_of = c:CAR
				alliance_with = c:CAR
			}
			NOT = { this = c:ROM }
			is_ai = yes
			in_diplomatic_range = c:ROM
			NOT = { has_variable = rm_4_ally_player_flag }
		}
	}

	immediate = {
		every_country = {
			limit = {
				OR = {
					is_subject_of = c:CAR
					alliance_with = c:CAR
				}
				NOT = { this = c:ROM }
				is_ai = yes
				in_diplomatic_range = c:ROM
				NOT = { has_variable = rm_4_ally_player_flag }
			}
			set_variable = {
				name = rm_4_convincing_flag
				days = 180
			}
			random_list = {
				5 = {
					if = {
						limit = {
							OR = {
								is_subject_of = c:CAR
								alliance_with = c:CAR
							}
						}
						hidden_effect = {
							add_opinion = { target = c:ROM modifier = rm_4_loyal_rom_opmod }
							add_opinion = { target = c:CAR modifier = rm_4_loyal_car_opmod }
						}
					}
					modifier = {
						factor = 10
						AND = {
							OR = {
								alliance_with = c:CAR
								is_subject_of = c:CAR
							}
							opinion = { target = c:CAR value >= 100 }
						}
					}
					modifier = {
						factor = 10
						AND = {
							OR = {
								alliance_with = c:CAR
								is_subject_of = c:CAR
							}
							opinion = { target = c:ROM value <= 0 }
						}
					}
					modifier = {
						factor = 10
						AND = {
							NOR = {
								alliance_with = c:CAR
								is_subject_of = c:CAR
							}
							opinion = { target = c:CAR value >= 50 }
						}
					}
					modifier = {
						factor = 10
						AND = {
							NOR = {
								alliance_with = c:CAR
								is_subject_of = c:CAR
							}
							opinion = { target = c:ROM value <= 50 }
						}
					}
					modifier = {
						factor = 5
						country_culture_group = west_levantine
					}
				}
				3 = {
					set_variable = {
						name = rm_4_deter_convinced_flag
						days = 180
					}
					hidden_effect = {
						add_opinion = { target = c:ROM modifier = rm_4_convinced_rom_opmod }
						add_opinion = { target = c:CAR modifier = rm_4_convinced_car_opmod }
						if = {
							limit = { is_subject = yes }
							add_country_modifier = {
								name = rm_4_disloyal_cmod
								duration = 3650 # 10 years
							}
						}
					}
					modifier = {
						factor = 10
						alliance_with = c:CAR
						opinion = { target = c:CAR value <= 25 }
					}
					modifier = {
						factor = 10
						alliance_with = c:CAR
						opinion = { target = c:ROM value >= 50 }
					}
					modifier = {
						factor = 10
						is_subject_of = c:CAR
						opinion = { target = c:CAR value <= 50 }
					}
					modifier = {
						factor = 10
						is_subject_of = c:CAR
						opinion = { target = c:CAR value <= 0 }
					}
					modifier = {
						factor = 10
						opinion = { target = c:ROM value >= 50 }
					}
					modifier = {
						factor = 5
						c:ROM = { has_variable = rm_4_deter_big_spender_flag }
					}
					modifier = {
						factor = 10
						c:CAR.num_of_cities < rm_4_rome_city_count_counter_svalue
					}
				}
			}
		}
		if = {
			limit = {
				NAND = {
					exists = scope:rm_4_deter_1
					exists = scope:rm_4_deter_2
					exists = scope:rm_4_deter_3
				}
				any_country = {
					has_variable = rm_4_deter_convinced_flag
					NOR = {
						AND = {
							exists = scope:rm_4_deter_1
							this = scope:rm_4_deter_1
						}
						AND = {
							exists = scope:rm_4_deter_2
							this = scope:rm_4_deter_2
						}
						AND = {
							exists = scope:rm_4_deter_3
							this = scope:rm_4_deter_3
						}
					}
				}
			}
			while = {
				limit = {
					NAND = {
						exists = scope:rm_4_deter_1
						exists = scope:rm_4_deter_2
						exists = scope:rm_4_deter_3
					}
					any_country = {
						has_variable = rm_4_deter_convinced_flag
						NOR = {
							AND = {
								exists = scope:rm_4_deter_1
								this = scope:rm_4_deter_1
							}
							AND = {
								exists = scope:rm_4_deter_2
								this = scope:rm_4_deter_2
							}
							AND = {
								exists = scope:rm_4_deter_3
								this = scope:rm_4_deter_3
							}
						}
					}
				}
				ordered_country = {
					limit = { 
						has_variable = rm_4_deter_convinced_flag
						NOR = {
							AND = {
								exists = scope:rm_4_deter_1
								this = scope:rm_4_deter_1
							}
							AND = {
								exists = scope:rm_4_deter_2
								this = scope:rm_4_deter_2
							}
							AND = {
								exists = scope:rm_4_deter_3
								this = scope:rm_4_deter_3
							}
						}
					}
					order_by = num_of_cities
					if = {
						limit = { 
							NOT = { exists = scope:rm_4_deter_1 }
						}
						save_scope_as = rm_4_deter_1
					}
					else_if = {
						limit = { 
							exists = scope:rm_4_deter_1
							NOT = { exists = scope:rm_4_deter_2 }
						}
						save_scope_as = rm_4_deter_2
					}
					else_if = {
						limit = { 
							exists = scope:rm_4_deter_1
							exists = scope:rm_4_deter_2
							NOT = { exists = scope:rm_4_deter_3 }
						}
						save_scope_as = rm_4_deter_3
					}
				}
			}
		}
	}

    option = {							# Results  
        name = me_roman_4_punic_rivals.8.a
		custom_tooltip = me_roman_4_punic_rivals.8.countertt
		if = {
			limit = {
				any_country = { 
					NOT = { has_variable = rm_4_deter_convinced_flag }
					has_variable = rm_4_convincing_flag
				}
			}
			custom_tooltip = me_roman_4_punic_rivals.8.loyal_countertt
		}
		if = {
			limit = {
				any_country = {
					OR = {
						alliance_with = c:CAR
						is_subject_of = c:CAR
					}
					has_variable = rm_4_deter_convinced_flag
				}
			}
			hidden_effect = {
				every_country = {
					limit = {
						OR = {
							alliance_with = c:CAR
							is_subject_of = c:CAR
						}
						has_variable = rm_4_deter_convinced_flag
					}
					reverse_add_opinion = { target = c:CAR modifier = rm_4_betrayed_opmod }
				}
			}
			custom_tooltip = me_roman_4_punic_rivals.8.at
		}
		c:CAR = {
			trigger_event = { id = me_roman_4_punic_rivals.10 }
		}
	}
}

me_roman_4_punic_rivals.9 = {							# 4 - Undermine Allies - Player event
    type = country_event
    title = me_roman_4_punic_rivals.3.t
    desc = {
		desc = me_roman_4_punic_rivals.9.desc
		first_valid = {
			triggered_desc = {
				trigger = { alliance_with = c:CAR }
				desc = me_roman_4_punic_rivals.9.desc_1
			}
			triggered_desc = {
				trigger = { is_subject_of = c:CAR }
				desc = me_roman_4_punic_rivals.9.desc_2
			}
		}
	}
    picture = council_country
    
    left_portrait = current_ruler
	right_portrait = c:ROM.current_ruler
	right_portrait = c:CAR.current_ruler

    trigger = { 
		has_land = yes
		c:CAR = { has_land = yes }
	}
	
	immediate = {
		if = {
			limit = {
				c:ROM = { has_variable = rm_4_deter_big_spender_flag }
			}
			add_treasury = {
				value = has_monthly_income
				multiply = 2
			}					
		}
		else = {
			add_treasury = {
				value = has_monthly_income
				multiply = 1
			}
		}
		set_variable = {
			name = rm_4_deter_done_flag
			days = 180
		}
	}

    option = {							# Loyal to Carthage   
        name = me_roman_4_punic_rivals.3.a
		trigger = {
			OR = {
				is_subject_of = c:CAR
				alliance_with = c:CAR
			}
		}
		add_opinion = { target = c:ROM modifier = rm_4_loyal_rom_opmod }
		add_opinion = { target = c:CAR modifier = rm_4_loyal_car_opmod }		
	}
	
	option = {							# Distrustful    
        name = me_roman_4_punic_rivals.3.b
		trigger = {
			NOR = {
				is_subject_of = c:CAR
				alliance_with = c:CAR
			}
		}
    }
	
	option = {							# Convinced  
        name = me_roman_4_punic_rivals.3.c
		set_variable = {
			name = rm_4_deter_convinced_flag
			value = 3 # Convinced
			days = 180
		}
		add_opinion = { target = c:ROM modifier = rm_4_convinced_rom_opmod }
		add_opinion = { target = c:CAR modifier = rm_4_convinced_car_opmod }
    }
}

me_roman_4_punic_rivals.10 = {							# 4 - Deter/Undermine - Carthage ping
	type = country_event
    title = me_roman_4_punic_rivals.10.t
    desc = {
		first_valid = {
			triggered_desc = {
				trigger = { 
					c:ROM = { has_variable = rm_4_deter_support_flag }
				}
				desc = me_roman_4_punic_rivals.10.desc_1
			}
			triggered_desc = {
				trigger = { 
					c:ROM = { has_variable = rm_4_undermine_allies_flag }
				}
				desc = me_roman_4_punic_rivals.10.desc_2
			}
		}
	}
    picture = council_country
    
    left_portrait = current_ruler
	right_portrait = c:ROM.current_ruler

    trigger = { 
		has_land = yes
		c:ROM = { has_land = yes }
	}
	
	immediate = {
		if = {
			limit = {
				c:ROM = { has_variable = rm_4_deter_support_flag }
			}
			custom_tooltip = me_roman_4_punic_rivals.10.tt1
			if = {
				limit = {
					any_country = { 
						NOT = { has_variable = rm_4_deter_convinced_flag }
						has_variable = rm_4_convincing_flag
						OR = {
							alliance_with = c:CAR
							is_subject_of = c:CAR
						}
					}
				}
				custom_tooltip = me_roman_4_punic_rivals.10.tt2
			}
		}
		else_if = {
			limit = { 
				c:ROM = { has_variable = rm_4_undermine_allies_flag }
			}
			custom_tooltip = me_roman_4_punic_rivals.10.tt3
		}
	}

    option = {							# Loyal to Carthage   
        name = me_roman_4_punic_rivals.10.a
		add_opinion = { target = c:ROM modifier = rm_4_badmouthed_opmod }
		if = {
			limit = {
				any_country = {
					OR = {
						alliance_with = c:CAR
						is_subject_of = c:CAR
					}
					has_variable = rm_4_deter_convinced_flag
				}
			}
			hidden_effect = {
				every_country = {
					limit = {
						OR = {
							alliance_with = c:CAR
							is_subject_of = c:CAR
						}
						has_variable = rm_4_deter_convinced_flag
					}
					reverse_add_opinion = { target = c:CAR modifier = rm_4_betrayed_opmod }
				}
			}
			custom_tooltip = me_roman_4_punic_rivals.10.at
		}
	}
}

me_roman_4_punic_rivals.11 = {							# 4 - Debt of Carthage - Rome - Carthage has broken oath
	type = country_event
    title = me_roman_4_punic_rivals.11.t
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = { has_variable = rm_4_carthage_breaking_debt_flag }
				desc = me_roman_4_punic_rivals.11.desc_1
			}
			triggered_desc = {
				trigger = {
					NOT = {
						has_variable = rm_4_carthage_breaking_debt_flag
					}
				}
				desc = me_roman_4_punic_rivals.11.desc_2
			}
		}
	}
    picture = council_country
    
    left_portrait = current_ruler
	right_portrait = c:CAR.current_ruler

    trigger = { 
		tag = ROM
		has_land = yes
		c:CAR = { 
			has_land = yes 
			has_variable = rm_4_carthage_debt_flag
			NAND = {
				is_subject_of = c:ROM
				is_subject_type = tributary
			}
		}
	}

    option = {							# Demands 
        name = me_roman_4_punic_rivals.11.a
		custom_tooltip = me_roman_4_punic_rivals.11.at
		if = {
			limit = {
				c:CAR = {
					owns = 3256
					p:3256 = { has_city_status = yes }
				}
			}
			custom_tooltip = me_roman_4_punic_rivals.11.at1
		}
		if = {
			limit = {
				c:CAR = {
					any_owned_province = {
						is_in_area = carthage_area
						is_coastal = yes
					}
				}
			}
			custom_tooltip = me_roman_4_punic_rivals.11.at2
		}
		custom_tooltip = me_roman_4_punic_rivals.11.at3
	}
	
	after = {
		c:CAR = { 
			remove_variable = rm_4_carthage_debt_flag
			trigger_event = {
				id = me_roman_4_punic_rivals.13 
				days = 5
			}
		}
	}
}

me_roman_4_punic_rivals.12 = {							# 4 - Debt of Carthage - Carthage - Breaking tributary oath 
	type = country_event
    title = me_roman_4_punic_rivals.12.t
	desc = me_roman_4_punic_rivals.12.desc
    picture = council_country
    
    left_portrait = scope:rm_4_punic_leader_scope
	right_portrait = c:ROM.current_ruler
	
	fire_only_once = yes

    trigger = { 
		has_land = yes 
		has_variable = rm_4_carthage_debt_flag
		is_subject_of = c:ROM
		is_subject_type = tributary
	}
	
	immediate = {
		if = {
			limit = {
				is_republic = yes
				current_ruler = { character_oligarchic_party_trigger = yes }
			}
			current_ruler = { save_scope_as = rm_4_punic_leader_scope }
		}
		else_if = {
			limit = {
				is_republic = yes
			}
			ordered_character = {
				limit = {
					is_adult = yes
					is_ruler = no
					character_oligarchic_party_trigger = yes
					trigger_if = {
						limit = {
							employer = { gender_equality = no }
						}
						is_female = no
					}
				}
				order_by = martial
				save_scope_as = rm_4_punic_leader_scope
			}
		}
		else = {
			current_ruler = { save_scope_as = rm_4_punic_leader_scope }
		}
	}

    option = {							# Time to end this   
        name = me_roman_4_punic_rivals.12.a
		if = {
			limit = { 
				NOT = {
					scope:rm_4_punic_leader_scope = root.current_ruler
				} 
			}
			set_as_ruler = scope:rm_4_punic_leader_scope
		}
		c:ROM = {
			set_variable = {
				name = rm_4_carthage_breaking_debt_flag
				days = 180
			}
			release_subject = c:CAR
			trigger_event = { 
				id = me_roman_4_punic_rivals.11
				days = 5
			}
		}
		custom_tooltip = me_roman_4_punic_rivals.12.at
		ai_chance = {
			factor = 9
		}
	}
	
	option = {							# Loyal 
        name = me_roman_4_punic_rivals.12.b
		custom_tooltip = me_roman_4_punic_rivals.12.bt
		hidden_effect = {
			scope:rm_4_punic_leader_scope = {
				death = {
					killer = scope:rm_4_punic_leader_scope
					death_reason = death_execution
				}
			}
		}
		ai_chance = {
			factor = 1
			modifier = {
				factor = 100
				num_of_cities <= 10
				c:ROM = { num_of_cities > 75 }
			}
		}
	}
}

me_roman_4_punic_rivals.13 = {							# 4 - Debt of Carthage - Carthage - Ultimatum from Rome
    type = country_event
    title = me_roman_4_punic_rivals.13.t
    desc = me_roman_4_punic_rivals.13.desc
    picture = council_country
    
    left_portrait = current_ruler
	right_portrait = c:ROM.current_ruler

    trigger = { 
		has_land = yes
		c:ROM = { has_land = yes }
	}

    option = {							# War   
        name = me_roman_4_punic_rivals.13.a
		show_as_tooltip = {
			c:ROM = {
				declare_war_with_wargoal = {
					war_goal = conquer_wargoal
					province = c:CAR.capital_scope
					target = c:CAR
				}
			}
		}
		set_variable = { 
			name = rm_4_carthage_war_flag
			days = 180
		}
		trigger_event = {
			id = me_roman_4_punic_rivals.12
			days = { 5475 10950 } # 15-30 years
		}
		ai_chance = {
			factor = 1
		}
	}
	
	option = {							# Give in  
        name = me_roman_4_punic_rivals.13.b
		custom_tooltip = me_roman_4_punic_rivals.13.bt
		if = {
			limit = {
				p:3256 = { 
					owner = c:CAR
					has_city_status = yes
				}
			}
			hidden_effect = { 
				p:3256 = { set_city_status = settlement }
			}
			custom_tooltip = me_roman_4_punic_rivals.13.bt1
		}
		if = {
			limit = {
				root.capital_scope = {
					AND = {
						is_in_area = carthage_area
						is_coastal = yes
					}
				}
			}
			hidden_effect = {
				capital_scope = { save_scope_as = rm_4_old_capital_scope }
				if = {
					limit = {
						any_owned_province = {
							is_in_area = carthage_area
							is_coastal = no
						}
					}
					ordered_owned_province = {
						limit = {
							is_in_area = carthage_area
							is_coastal = no
						}
						order_by = total_population
						save_scope_as = rm_4_new_capital_scope
					}
				}
				else = {
					ordered_owned_province = {
						limit = {
							is_coastal = no
						}
						order_by = total_population
						save_scope_as = rm_4_new_capital_scope
					}
				}
				set_capital = scope:rm_4_new_capital_scope
				if = {
					limit = {
						scope:rm_4_old_capital_scope = { num_of_fortress_building > 0 }
					}
					while = {
						limit = {
							scope:rm_4_old_capital_scope = { num_of_fortress_building > 0 }
						}
						scope:rm_4_old_capital_scope = { remove_building_level = fortress_building }
					}
				}
			}
			custom_tooltip = me_roman_4_punic_rivals.13.bt3
		}
		if = {
			limit = { 
				scope:rm_4_old_capital_scope = { total_population > population_cap }
			}
			while = {
				limit = {
					scope:rm_4_old_capital_scope = { total_population > population_cap }
				}
				random_owned_province = {
					weight = {
						modifier = {
							factor = 10
							total_population > population_cap
						}
						modifier = {
							factor = 10
							total_population > 10
						}
						modifier = {
							factor = 5
							is_capital = yes
						}
					}
					save_scope_as = rm_4_relocation_scope
				}
				scope:rm_4_old_capital_scope = {
					random_pops_in_province = {
						move_pop = scope:rm_4_new_capital_scope
					}
				}
			}
		}
		if = {
			limit = {
				p:3256.area = { 
					any_area_province = {
						owned_or_subject_owned = c:CAR
						is_coastal = yes
					}
				}
			}
			hidden_effect = {
				p:3256.area = { 
					every_area_province = {
						limit = {
							owned_or_subject_owned = c:CAR
							is_coastal = yes
						}
						set_conquered_by = c:ROM
					}
				}
			}
			custom_tooltip = me_roman_4_punic_rivals.13.bt2
		}
		
		ai_chance = {
			factor = 5
		}
	}
	
	after = {
		c:ROM = {
			trigger_event = {
				id = me_roman_4_punic_rivals.14
				days = 5
			}
		}
	}
}

me_roman_4_punic_rivals.14 = {							# 4 - Debt of Carthage - Rome - Ultimatum Response
    type = country_event
    title = me_roman_4_punic_rivals.6.t
    desc = {
		first_valid = {
			triggered_desc = {
				trigger = {
					c:CAR = { has_variable = rm_4_carthage_war_flag }
				}
				desc = me_roman_4_punic_rivals.14.desc_1
			}
			triggered_desc = {
				trigger = {
					NOT = {
						c:CAR = { has_variable = rm_4_carthage_war_flag }
					}
				}
				desc = me_roman_4_punic_rivals.14.desc_2
			}
		}
	}
    picture = council_country
    
    left_portrait = current_ruler
	right_portrait = c:CAR.current_ruler

    trigger = { 
		has_land = yes
		c:CAR = { has_land = yes }
	}
	
	immediate = {
	
	}

    option = {							#    
        name = me_roman_4_punic_rivals.14.a
		trigger = {
			c:CAR = { has_variable = rm_4_carthage_war_flag }
		}
		hidden_effect = {
			c:CAR.capital_scope.area = {
				every_area_province = {
					add_claim = c:ROM
				}
			}
		}
		custom_tooltip = me_roman_4_punic_rivals.6.bt
		declare_war_with_wargoal = {
			war_goal = conquer_wargoal
			province = c:CAR.capital_scope
			target = c:CAR
		}
	}
	
	option = {							#    
        name = me_roman_4_punic_rivals.14.b
		trigger = {
			c:CAR = { 
				NOT = { has_variable = rm_4_carthage_war_flag }
			}
		}
		custom_tooltip = me_roman_4_punic_rivals.14.bt
	}
}

me_roman_4_punic_rivals.15 = {							# 4 - Demand Servitude - Start
    type = country_event
    title = me_roman_4_punic_rivals.15.t
    desc = me_roman_4_punic_rivals.15.desc
    picture = council_country
    
    left_portrait = current_ruler
	right_portrait = c:CAR.current_ruler

    trigger = { 
		has_land = yes
		c:CAR = { 
			has_land = yes
			is_subject_of = c:ROM
			is_subject_type = tributary
		}
	}

    option = {							#    
        name = me_roman_4_punic_rivals.15.a
		custom_tooltip = me_roman_4_punic_rivals.15.at
		c:CAR = {
			trigger_event = {
				id = me_roman_4_punic_rivals.16
				days = 5
			}
		}
	}
}

me_roman_4_punic_rivals.16 = {							# 4 - Demand Servitude - Event for Carthage
    type = country_event
    title = me_roman_4_punic_rivals.16.t
    desc = me_roman_4_punic_rivals.16.desc
    picture = council_country
    
    left_portrait = current_ruler
	right_portrait = c:ROM.current_ruler

    trigger = { 
		has_land = yes
		c:ROM = { has_land = yes }
	}

    option = {							# Accept   
        name = me_roman_4_punic_rivals.16.a
		show_as_tooltip = {
			add_opinion = { target = c:ROM modifier = rm_4_client_state_opmod }
			c:ROM = {
				add_opinion = { target = c:CAR modifier = rm_4_client_state_opmod }
				make_subject = {
					target = root
					type = client_state
				}
			}
		}
		set_variable = { 
			name = rm_4_carthage_client_flag
			days = 180 # 0.5 years
		}
		ai_chance = {
			factor = 95
			modifier = {
				factor = 3
				opinion = { target = c:ROM value > 100 }
			}
			modifier = {
				factor = 2
				opinion = { target = c:ROM value > 50 }
			}
		}
	}
	
	option = {							# Refuse  
        name = me_roman_4_punic_rivals.16.b
		custom_tooltip = me_roman_4_punic_rivals.16.bt
		ai_chance = {
			factor = 5
			modifier = {
				factor = 3
				opinion = { target = c:ROM value < 100 }
			}
			modifier = {
				factor = 2
				opinion = { target = c:ROM value < 50 }
			}
		}
	}
	
	after = {
		c:ROM = {
			trigger_event = {
				id = me_roman_4_punic_rivals.17
				days = 5
			}
		}
	}
}

me_roman_4_punic_rivals.17 = {							# 4 - Disarm Carthage - Response from Carthage
    type = country_event
    title = me_roman_4_punic_rivals.6.t
    desc = {
		desc = me_roman_4_punic_rivals.17.desc
		first_valid = {
			triggered_desc = {
				trigger = { 
					c:CAR = { has_variable = rm_4_carthage_client_flag }
				}
				desc = me_roman_4_punic_rivals.17.desc_1
			}
			triggered_desc = {
				trigger = { 
					NOT = {
						c:CAR = { has_variable = rm_4_carthage_client_flag }
					}
				}
				desc = me_roman_4_punic_rivals.17.desc_2
			}
		}
	}
    picture = council_country
    
    left_portrait = current_ruler
	right_portrait = c:CAR.current_ruler

    trigger = { 
		has_land = yes
		c:CAR = { has_land = yes }
	}

    option = {							# Carthage submits
        name = me_roman_4_punic_rivals.17.a
		trigger = { 
			c:CAR = { has_variable = rm_4_carthage_debt_flag }
		}
		hidden_effect = {
			release_subject = c:CAR
		}
		make_subject = { # Client state
			target = c:CAR
			type = client_state
		}
		add_opinion = { target = c:CAR modifier = rm_4_client_state_opmod }
		reverse_add_opinion = { target = c:CAR modifier = rm_4_client_state_opmod }
	}
	
	option = {							# Carthage refuses
		name = me_roman_4_punic_rivals.17.b
		trigger = { 
			NOT = {
				c:CAR = { has_variable = rm_4_carthage_debt_flag }
			}
		}
		custom_tooltip = me_roman_4_punic_rivals.17.bt
	}
}

me_roman_4_punic_rivals.18 = {							# 4 - Carthago Delenda Est
    type = country_event
	title = me_roman_4_punic_rivals.18.t
    desc = me_roman_4_punic_rivals.18.desc
    picture = romans_marching
    
    left_portrait = current_ruler
	
	fire_only_once = yes

    trigger = { has_land = yes }

    option = {								# Enslave
        name = me_roman_4_punic_rivals.18.a 
		if = {
			limit = {
				any_owned_province = { is_in_region = africa_region }
			}
			random_owned_province = {
				limit = { is_in_region = africa_region }
				save_scope_as = rm_settle_cisalpine_scope
			}
			scope:rm_settle_cisalpine_scope.governorship = {
				every_governorship_state = {
					custom = roman_4_punic_rivals_end.modtt
					add_state_modifier = {
						name = rm_production_smod
						duration = 7200 # 20 years
					}
				}
			}
		}
	}
	
	option = {								# Integrate
        name = me_roman_4_punic_rivals.18.b 
		if = {
			limit = {
				any_owned_province = { is_in_region = africa_region }
			}
			random_owned_province = {
				limit = { is_in_region = africa_region }
				save_scope_as = rm_settle_cisalpine_scope
			}
			scope:rm_settle_cisalpine_scope.governorship = {
				every_governorship_state = {
					custom = roman_4_punic_rivals_end.modtt
					add_state_modifier = {
						name = rm_integration_smod
						duration = 7200 # 20 years
					}
				}
			}
		}
	}
}