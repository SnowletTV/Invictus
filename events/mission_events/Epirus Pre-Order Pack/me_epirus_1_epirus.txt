namespace = me_epirus_1_epirus

me_epirus_1_epirus.110 = {							# Start
    type = country_event
    title = me_epirus_1_epirus.110.t
    desc = me_epirus_1_epirus.110.desc
    picture = epirote_phalanx

    trigger = { 
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    option = {      
        name = me_epirus_1_epirus.110.a
        add_country_modifier = {
            name = me_epi_1_cmod
            duration = 9125 # 25 years
        }
    }
}

me_epirus_1_epirus.111 = {							# End
    type = country_event
    title = me_epirus_1_epirus.111.t
    desc = me_epirus_1_epirus.111.desc
    picture = pyrrhus

    trigger = { 
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    option = {      
        name = me_epirus_1_epirus.111.a
    }
}

me_epirus_1_epirus.1 = {                            # Expand Royal Kennels - Start
    type = country_event
    title = me_epirus_1_epirus.1.t
    desc = me_epirus_1_epirus.1.desc
    picture = greek_court

    trigger = { 
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    immediate = {  add_treasury = -50  }

    option = {      
        name = me_epirus_1_epirus.1.a
        custom_tooltip = me_epirus_1_epirus.1.at
    }
}

me_epirus_1_epirus.2 = {							# Taulantian Diplomacy - Start
    type = country_event
    title = me_epirus_1_epirus.2.t
    desc = me_epirus_1_epirus.2.desc
    picture = greek_court
    left_portrait = current_ruler
    left_portrait = scope:epirote_diplomat_scope   
    right_portrait = c:TLN.current_ruler
    goto_location = c:TLN.capital_scope

    trigger = { 
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    immediate = {
        add_political_influence = -20
        custom_tooltip = me_epirus_1_epirus.2.tt
        me_epi_1_kineas_effect = yes
    }

    option = { # Peaceful  
        name = me_epirus_1_epirus.2.a
        add_treasury = -20
        custom_tooltip = epirus_1_epirus_2_if_tt
        show_as_tooltip = {
            if = {
               limit = {
                   current_ruler = { is_rival = c:TLN.current_ruler }
               }
               current_ruler = { remove_rival = c:TLN.current_ruler }
            }
            add_opinion = { target = c:TLN modifier = me_epi_1_2_opmod }
            reverse_add_opinion = { target = c:TLN modifier = me_epi_1_2_opmod }
            if = {
               limit = {
                   NOT = { alliance_with = c:TLN }
               }
               add_alliance = c:TLN
            }
            if = {
               limit = {
                   current_ruler = char:118
                   c:TLN.current_ruler = char:105
                   c:TLN = { is_ai = yes }
               }
               custom_tooltip = epirus_1_epirus_2_rival_tt
            }
            if = {
               limit = {
                   current_ruler = char:70
                   c:TLN.current_ruler = char:105
                   c:TLN = { is_ai = yes }
               }
               custom_tooltip = epirus_1_epirus_2_friend_tt
            }
            custom_tooltip = epirus_1_epirus_2_else_tt
        }
        c:TLN = {
            trigger_event = { 
                id = me_epirus_1_epirus.30
                days = 10
            }
        }
        ai_chance = {
            factor = 80
        }
    }

    option = { # Aggressive     
        name = me_epirus_1_epirus.2.b
        show_as_tooltip = {
            if = {
                limit = {
                    current_ruler = { is_friend = c:TLN.current_ruler }
                }
                current_ruler = { remove_friend = c:TLN.current_ruler }
            }
        }
        custom_tooltip = epirus_1_epirus_1_reward_tt
        show_as_tooltip = {
            if = {
                limit = { alliance_with = c:TLN }
                break_alliance = c:TLN
            }
        }
        add_opinion = { target = c:TLN modifier = me_epi_1_1_opmod }
        reverse_add_opinion = { target = c:TLN modifier = me_epi_1_1_opmod }
        if = {
            limit = {
                NOR = {
                    AND = {
                        current_ruler = char:70
                        c:TLN.current_ruler = char:105
                    }
                    current_ruler = { is_friend = c:TLN.current_ruler }
                    alliance_with = c:TLN
                }
            }
            add_aggressive_expansion = 5
        }
        else_if = {
            limit = {
                OR = {
                    AND = {
                        current_ruler = char:70
                        c:TLN.current_ruler = char:105
                    }
                    current_ruler = { is_friend = c:TLN.current_ruler }
                    alliance_with = c:TLN
                }
            }
            custom_tooltip = epirus_1_epirus_1_glaukias_tt
            add_aggressive_expansion = 10
            add_country_modifier = {
                name = epirus_1_1_cmod
                duration = 3650 # 10 years
            }
        }
        custom_tooltip = epirus_1_epirus_2_bypass_tt
        hidden_effect = {
            area:illyria_graeca_area = {
                every_area_province = {
                    limit = { owner = c:TLN }
                    add_claim = root
                }
            }
            area:epirus_area = {
                every_area_province = {
                    limit = { owner = c:TLN }
                    add_claim = root
                }
            }
        }
        set_variable = me_epi_1_2_aggression_flag
        c:TLN = {
            trigger_event = { id = me_epirus_1_epirus.41 }
        }
        ai_chance = {
            factor = 1
        }
    }
}

me_epirus_1_epirus.3 = {                           # Tribal Command - End
    type = country_event
    title = me_epirus_1_epirus.3.t
    desc = me_epirus_1_epirus.3.desc
    picture = epirote_phalanx

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }  

    immediate = {
        random_character = { 
            limit = { has_office = office_marshal }
            save_scope_as = epi_marshal
        }
        custom_tooltip = me_epirus_1_epirus.3.at
    }

    option = {
        name = me_epirus_1_epirus.3.a
        
        add_country_modifier = {
            name = me_epi_1_3_cmod
            duration = 10950 # 30 years
        }
    }
}

me_epirus_1_epirus.4 = {							# Southern Claims - End
    type = country_event
    title = me_epirus_1_epirus.4.t
    desc = me_epirus_1_epirus.4.desc
    picture = greek_siege

    trigger = { 
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    immediate = { custom_tooltip = me_epirus_1_epirus.4.at }

    option = {      
        name = me_epirus_1_epirus.4.a
        if = {
            limit = {
                NOT = { owns_or_subject_owns = p:462 }
            }
            p:462 = { add_claim = root }
        }
        if = {
            limit = {
                NOT = { owns_or_subject_owns = p:463 }
            }
            p:463 = { add_claim = root }
        }
        if = {
            limit = {
                NOT = { owns_or_subject_owns = p:465 }
            }
            p:465 = { add_claim = root }
        }
        if = {
            limit = {
                is_ai = yes
                c:AKR = {
                    is_ai = yes
                }
                c:MAC = {
                    is_ai = yes
                }
            }
            if = {
                limit = {
                    c:AKR = { is_subject = yes }
                }
                c:AKR.overlord = { release_subject = c:AKR }
            }
            make_subject = {
                target = c:AKR
                type = feudatory
            }
            p:463 = {
                set_owned_by = root
            }
            p:462 = {
                set_owned_by = root
            }    
        }
        if = {
            limit = {
                is_ai = yes
                c:AMK = {
                    is_ai = yes
                }
                c:MAC = {
                    is_ai = yes
                }
            }
            p:465 = {
                set_owned_by = root
            }          
        }
    }
}

me_epirus_1_epirus.5 = {							# Tighten Administration - End
    type = country_event
    title = me_epirus_1_epirus.5.t
    desc = me_epirus_1_epirus.5.desc
    picture = greek_court

    trigger = { 
        has_land = yes
        has_dlc = "Epirus Flavor Pack"
    }

    immediate = { custom_tooltip = me_epirus_1_epirus.5.at }

    option = {      
        name = me_epirus_1_epirus.5.a
        add_country_modifier = {
            name = me_epi_1_5_cmod
            duration = 3650
        }
    }
}

me_epirus_1_epirus.6 = {							# Expand Royal Kennels - End
    type = country_event
    title = me_epirus_1_epirus.6.t
    desc = me_epirus_1_epirus.6.desc
    picture = greek_home

    trigger = { 
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    immediate = { custom_tooltip = me_epirus_1_epirus.6.at }

    option = {      
        name = me_epirus_1_epirus.6.a
        add_country_modifier = { 
            name = me_epi_1_6_cmod
            duration = -1
        }
    }
}

me_epirus_1_epirus.7 = {                           # The Illyrian Hinterland - End
    type = country_event
    title = me_epirus_1_epirus.7.t
    desc = {
        desc = "me_epirus_1_epirus.7.desc"
        first_valid = {
            triggered_desc = { #
                trigger = { root.var:illyria_demands = 1 }
                desc = "me_epirus_1_epirus.7.desc_1_1"
            }
            triggered_desc = { #
                trigger = { root.var:illyria_demands = 2 }
                desc = "me_epirus_1_epirus.7.desc_1_2"
            }
            triggered_desc = { #
                trigger = { root.var:illyria_demands = 3 }
                desc = "me_epirus_1_epirus.7.desc_1_3"
            }
        }
        first_valid = {
            triggered_desc = { #
                trigger = { 
                    c:TLN = { has_variable = illyria_rejection }
                }
                desc = "me_epirus_1_epirus.7.desc_2_1"
            }
            triggered_desc = { #
                trigger = { 
                    NOT = { 
                        c:TLN = { has_variable = illyria_rejection }
                    }
                }
                desc = "me_epirus_1_epirus.7.desc_2_2"
            }
        }
    }
    picture = greek_court

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }  

    option = { #
        name = me_epirus_1_epirus.7.a
        trigger = {
            c:TLN = { has_variable = illyria_rejection }
        }
        if = {
            limit = { scope:me_epirus_scope.var:illyria_demands = 1 }
            scope:byllis_scope = { add_claim = scope:me_epirus_scope }
        }
        else_if = {
            limit = { scope:me_epirus_scope.var:illyria_demands = 2 }
            custom_tooltip = me_epirus_1_epirus.7.at1
            hidden_effect = {
                c:TLN = {
                    every_owned_province = {
                        limit = {
                            OR = {
                                province_id = 422
                                province_id = 455
                                province_id = 1445
                                province_id = 3192
                                province_id = 467
                                province_id = 464
                                province_id = 421
                            }
                        }
                        add_claim = root
                    }
                }
            }
        }
        else_if = {
            limit = { scope:me_epirus_scope.var:illyria_demands = 3 }
            custom_tooltip = me_epirus_1_epirus.7.at2
            hidden_effect = {
                c:TLN = {
                    every_owned_province = { add_claim = root }
                }
            }
        }
        add_opinion = { target = c:TLN modifier = me_epi_1_16_demand_rejected }
    }


    option = {
        name = me_epirus_1_epirus.7.b
        trigger = {
            NOT = { 
                c:TLN = { has_variable = illyria_rejection }
            }
        }
        if = {
            limit = { scope:me_epirus_scope.var:illyria_demands = 1 }
            scope:byllis_scope = { set_owned_by = scope:me_epirus_scope }
        }
        else_if = {
            limit = { scope:me_epirus_scope.var:illyria_demands = 2 }
            custom_tooltip = me_epirus_1_epirus.7.bt
            hidden_effect = {
                c:TLN = {
                    every_owned_province = {
                        limit = {
                            OR = {
                                province_id = 422
                                province_id = 455
                                province_id = 1445
                                province_id = 3192
                                province_id = 467
                                province_id = 464
                                province_id = 421
                            }
                        }
                        set_owned_by = root
                    }
                }
            }
        }
        else_if = {
            limit = { scope:me_epirus_scope.var:illyria_demands = 3 }
            make_subject = {
                target = c:TLN
                type = vassal_tribe
            }
        }
    }

    after = {
        remove_variable = illyria_demands
        if = {
            limit = {
                c:TLN = { has_variable = illyria_rejection }
            }
            c:TLN = { remove_variable = illyria_rejection }
        }
    }
}

me_epirus_1_epirus.8 = {							# A New City - End
    type = country_event
    title = me_epirus_1_epirus.8.t
    desc = me_epirus_1_epirus.8.desc
    picture = city_construction
    goto_location = scope:berenicis_scope

    trigger = { 
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
        has_variable = berenicis_flag
        var:berenicis_flag.owner = ROOT
    }

    immediate = {
        var:berenicis_flag = { save_scope_as = berenicis_scope }
        custom_tooltip = me_epirus_1_epirus.8.tt
    }

    option = {      
        name = me_epirus_1_epirus.8.a
        scope:berenicis_scope = {
            if = {
                limit = {
                    OR = {
                        trade_goods = grain
                        trade_goods = fish
                        trade_goods = cattle
                        trade_goods = vegetables
                    }
                }
                switch = { #Must not be cleared!
                    trigger = trade_goods
                    grain = { set_variable = had_grain }
                    fish = { set_variable = had_fish }
                    cattle = { set_variable = had_cattle  }
                    vegetables = { set_variable = had_vegetables }
                }
            }
            create_state_pop = citizen
            create_state_pop = citizen
            create_state_pop = freemen
            set_city_status = city
            set_trade_goods = dye
            add_province_modifier = { 
                name = me_epi_1_8_pmod
                duration = 18250
            }
            if = {
                limit = { 
                    root = { has_variable = berenicis_country_flag }
                }
                if = {
                    limit = { root.var:berenicis_country_flag = c:TRE }
                    change_province_name = "Nikais"
                }
                else_if = {
                    limit = { root.var:berenicis_country_flag = c:EGY }
                    change_province_name = "Berenikis"
                }
                else_if = {
                    limit = { root.var:berenicis_country_flag = c:PRY }
                    change_province_name = "Stratonikis"
                }
                else_if = {
                    limit = { root.var:berenicis_country_flag = c:MAC }
                    change_province_name = "Thessalonikis"
                }
                else_if = {
                    limit = { root.var:berenicis_country_flag = c:SEL }
                    change_province_name = "Laodikis"
                }
                else_if = {
                    limit = { root.var:berenicis_country_flag = c:TLN }
                    change_province_name = "Beroais"
                }
            }
            else = { change_province_name = "Achilleia"  }
        }
        remove_variable = berenicis_flag
    }
}

me_epirus_1_epirus.9 = {							# Lean on Korkyra - End
    type = country_event
    title = me_epirus_1_epirus.9.t
    desc = me_epirus_1_epirus.9.desc
    picture = ship_in_storm
    left_portrait = current_ruler
    left_portrait = scope:epirote_diplomat_scope
    right_portrait = c:KRK.current_ruler
    goto_location = p:470

    trigger = { 
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    immediate = { 
        me_epi_1_kineas_effect = yes # save diplomat scope effect
        custom_tooltip = me_epirus_1_epirus.9.at
    }

    option = {      
        name = me_epirus_1_epirus.9.a
        custom_tooltip = me_epirus_1_epirus.9.tt
        if = {
            limit = {
                c:KRK = {
                    owns = 470 
                    is_subject = no
                    num_of_cities <= 3
                }
            }
            c:KRK = {
                trigger_event = { id = me_epirus_1_epirus.32 }
            }
        }
        else = {
            p:470 = { add_claim = root }
        }
    }
}

me_epirus_1_epirus.10 = {							# Adriatic Colonies - End
    type = country_event
    title = me_epirus_1_epirus.10.t
    desc = me_epirus_1_epirus.10.desc
    picture = greek_city

    trigger = { 
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    immediate = { custom_tooltip = me_epirus_1_epirus.10.at }

    option = {      
        name = me_epirus_1_epirus.10.a
        custom_tooltip = epirus_1_epirus_10_reward_tt
        p:422 = {
            create_state_pop = citizen
            create_state_pop = freemen
            add_province_modifier = {
                name = me_epi_1_10_pmod
                duration = 7300 # 20 years
            }
        }
        hidden_effect = {
            p:415 = {
                create_state_pop = citizen
                create_state_pop = freemen
                add_province_modifier = {
                    name = me_epi_1_10_pmod
                    duration = 7300 # 20 years
                }
            }
            p:2336 = {
                create_state_pop = citizen
                create_state_pop = freemen
                add_province_modifier = {
                    name = me_epi_1_10_pmod
                    duration = 7300 # 20 years
                }
            }
        }
    }
}

me_epirus_1_epirus.11 = {							# Settled Crown Disputes - End 
    type = country_event
    title = me_epirus_1_epirus.11.t
    desc = me_epirus_1_epirus.11.desc
    picture = greek_court

    trigger = { 
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    immediate = { 
        if = {
            limit = { has_country_modifier = me_epi_1_cmod }
            remove_country_modifier = me_epi_1_cmod
        }
        custom_tooltip = me_epirus_1_epirus.11.at }

    option = {      
        name = me_epirus_1_epirus.11.a
        add_country_modifier = {
            name = me_epi_1_11_cmod
            duration = 7300 # 20 years
        }
        add_stability = 10
    }
}

me_epirus_1_epirus.12 = {							# Urbanize Passaron - End
    type = country_event
    title = me_epirus_1_epirus.12.t
    desc = me_epirus_1_epirus.12.desc
    picture = greek_city

    trigger = { 
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    immediate = { custom_tooltip = me_epirus_1_epirus.12.at }

    option = {      
        name = me_epirus_1_epirus.12.a
        capital_scope = {
            add_province_modifier = {
                name = me_epi_1_12_pmod
                duration = 7300
            }
        }
    }
}

me_epirus_1_epirus.13 = {							# Cult of Dione - End 
    type = country_event
    title = me_epirus_1_epirus.13.t
    desc = me_epirus_1_epirus.13.desc
    picture = greek_religious_rite

    trigger = { 
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    immediate = {
        custom_tooltip = me_epirus_1_epirus.13.tt
    }

    option = {      
        name = me_epirus_1_epirus.13.a
        custom_tooltip = epirus_1_epirus_13_reward_tt
    }
}

me_epirus_1_epirus.14 = {							# Macedonian Lessons - End
    type = country_event
    title = me_epirus_1_epirus.14.t
    desc = me_epirus_1_epirus.14.desc
    picture = epirote_phalanx
    left_portrait = current_ruler
    right_portrait = scope:epi_general_scope

    trigger = { 
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    immediate = { custom_tooltip = me_epirus_1_epirus.14.at }

    option = {      
        name = me_epirus_1_epirus.14.a
        scope:epi_general_scope = {
            add_character_modifier = {
                name = me_epi_1_14_charmod
                duration = -1
            }
        }
        add_country_modifier = {
            name = me_epi_1_14_cmod
            duration = 10950 # 30 years
        }
    }
}

me_epirus_1_epirus.15 = {							# Royal Wedding - Bride Selection
    type = country_event
    title = me_epirus_1_epirus.15.t
    desc = me_epirus_1_epirus.15.desc
    picture = greek_court
    left_portrait = current_ruler
    right_portrait = root.var:me_epi_royal_wedding_bride_scope_1
    right_portrait = root.var:me_epi_royal_wedding_bride_scope_2
    right_portrait = root.var:me_epi_royal_wedding_bride_scope_3

    trigger = { 
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    immediate = {
        every_in_list = {
            list = me_epi_1_wedding_brides_list
            limit = { me_epi_royal_marriage_bride_trigger = no }
            remove_from_list = me_epi_1_wedding_brides_list
        }
        current_ruler.family = {
            every_family_member = {
                limit = { 
                    me_epi_royal_marriage_bride_trigger = yes 
                    NOT = { is_in_list = me_epi_1_wedding_brides_list }
                }
                add_to_list = me_epi_1_wedding_brides_list
            }
        }
        me_epi_1_royal_wedding_bride_list_scope_effect = yes # build list of brides
        if = {
            limit = {
                any_in_list = {
                    list = me_epi_1_wedding_brides_list
                    count >= 4
                }
            }
            ordered_in_list = {
                list = me_epi_1_wedding_brides_list
                order_by = {
                    value = 0
                    subtract = age
                }
                position = 4
                scope:me_epirus_scope = {
                    set_variable = {
                        name = me_epi_royal_wedding_bride_scope_4
                        value = prev
                    }
                }
            }
        }
    }

    option = {      
        name = me_epirus_1_epirus.15.a
        root.var:me_epi_royal_wedding_bride_scope_1 = { save_scope_as = me_epi_royal_wedding_bride_scope }
        custom_tooltip = me_epirus_1_epirus.15.at
        ai_chance = {
            factor = 10
            modifier = {
                root.var:me_epi_royal_wedding_bride_scope_1 = char:116
                factor = 100
            }
        }
    }

    option = {      
        name = me_epirus_1_epirus.15.b
        trigger = { has_variable = me_epi_royal_wedding_bride_scope_2 }
        root.var:me_epi_royal_wedding_bride_scope_2 = { save_scope_as = me_epi_royal_wedding_bride_scope }
        custom_tooltip = me_epirus_1_epirus.15.at
        ai_chance = {
            factor = 1.5
            modifier = {
                root.var:me_epi_royal_wedding_bride_scope_2 = char:116
                factor = 100
            }
        }
    }

    option = {      
        name = me_epirus_1_epirus.15.c
        trigger = { has_variable = me_epi_royal_wedding_bride_scope_3 }
        root.var:me_epi_royal_wedding_bride_scope_3 = { save_scope_as = me_epi_royal_wedding_bride_scope }
        custom_tooltip = me_epirus_1_epirus.15.at
        ai_chance = {
            factor = 1
            modifier = {
                root.var:me_epi_royal_wedding_bride_scope_3 = char:116
                factor = 100
            }
        }
    }

    option = {      
        name = me_epirus_1_epirus.15.d
        trigger = { has_variable = me_epi_royal_wedding_bride_scope_4 }
        root.var:me_epi_royal_wedding_bride_scope_4 = { save_scope_as = me_epi_royal_wedding_bride_scope }
        custom_tooltip = me_epirus_1_epirus.15.at
        ai_chance = {
            factor = 0.5
            modifier = {
                root.var:me_epi_royal_wedding_bride_scope_4 = char:116
                factor = 100
            }
        }
    }

    after = {
        trigger_event = { 
            on_action = me_epi_royal_wedding_step_1_country_on_action
            days = 3
        }
        every_in_list = {
            list = me_epi_1_wedding_brides_list
            remove_from_list = me_epi_1_wedding_brides_list
        }   
    }
}

me_epirus_1_epirus.16 = {                           # Royal Wedding - Country Selection
    type = country_event
    title = me_epirus_1_epirus.16.t
    desc = me_epirus_1_epirus.16.desc
    picture = greek_court
    left_portrait = current_ruler
    left_portrait = scope:me_epi_royal_wedding_bride_scope
    right_portrait = root.var:me_epi_royal_wedding_country_scope_1.current_ruler
    right_portrait = root.var:me_epi_royal_wedding_country_scope_2.current_ruler
    right_portrait = root.var:me_epi_royal_wedding_country_scope_3.current_ruler

    trigger = { 
        has_land = yes 
        exists = scope:me_epi_royal_wedding_bride_scope
        scope:me_epi_royal_wedding_bride_scope = { is_alive = yes } 
    }

    immediate = {
        if = {
            limit = {
                NOT = { has_variable = me_epi_royal_wedding_country_view_count }
            }
            set_variable = {
                name = me_epi_royal_wedding_country_view_count
                value = 1
            }
        }
        if = {
            limit = {
                any_in_list = {
                    list = me_epi_1_wedding_countries_list
                    OR = {
                        me_epi_royal_marriage_country_trigger = no
                        current_ruler.family = {
                            any_family_member = { me_epi_royal_marriage_groom_trigger = no }
                        }
                        has_variable = me_epi_royal_wedding_rejected_flag
                    }
                }
            }
            every_in_list = {
                list = me_epi_1_wedding_countries_list
                limit = {
                    OR = {
                        me_epi_royal_marriage_country_trigger = no
                        current_ruler.family = {
                            any_family_member = { me_epi_royal_marriage_groom_trigger = no }
                        }
                        has_variable = me_epi_royal_wedding_rejected_flag
                    }
                }
                remove_from_list = me_epi_1_wedding_countries_list
            }
        }
        ordered_country = {
            limit = {
                NOT = { is_in_list = me_epi_1_wedding_countries_list }
                me_epi_royal_marriage_country_trigger = yes
                current_ruler.family = {
                    any_family_member = { me_epi_royal_marriage_groom_trigger = yes }
                }
            }
            max = 12
            check_range_bounds = no
            order_by = country_population
            add_to_list = me_epi_1_wedding_countries_list
        }
        me_epi_1_royal_wedding_countries_list_scope_effect = yes # build list of countries
    }

    option = {      
        name = me_epirus_1_epirus.16.a
        trigger = { root.var:me_epi_royal_wedding_country_view_count = 1 }
        root.var:me_epi_royal_wedding_country_scope_1 = { save_scope_as = me_epi_royal_wedding_country_scope }
        custom_tooltip = me_epirus_1_epirus.16.at
        if = {
            limit = { alliance_with = root.var:me_epi_royal_wedding_country_scope_1 }
            custom_tooltip = me_epirus_1_epirus.16.tt
        }
        change_variable = {
            name = me_epi_royal_wedding_country_view_count
            add = 2
        }
        ai_chance = {
            factor = 1
            modifier = {
                root.var:me_epi_royal_wedding_country_scope_1 = c:PRY
                factor = 10
            }
        }
    }

    option = {      
        name = me_epirus_1_epirus.16.b
        trigger = {
            root.var:me_epi_royal_wedding_country_view_count = 1
            has_variable = me_epi_royal_wedding_country_scope_2
        }
        root.var:me_epi_royal_wedding_country_scope_2 = { save_scope_as = me_epi_royal_wedding_country_scope }
        custom_tooltip = me_epirus_1_epirus.16.at
        if = {
            limit = { alliance_with = root.var:me_epi_royal_wedding_country_scope_2 }
            custom_tooltip = me_epirus_1_epirus.16.tt
        }
        change_variable = {
            name = me_epi_royal_wedding_country_view_count
            add = 2
        }
        ai_chance = {
            factor = 1
            modifier = {
                root.var:me_epi_royal_wedding_country_scope_2 = c:PRY
                factor = 10
            }
        }
    }

    option = {      
        name = me_epirus_1_epirus.16.c
        trigger = {
            root.var:me_epi_royal_wedding_country_view_count = 1
            has_variable = me_epi_royal_wedding_country_scope_3
        }
        root.var:me_epi_royal_wedding_country_scope_3 = { save_scope_as = me_epi_royal_wedding_country_scope }
        custom_tooltip = me_epirus_1_epirus.16.at
        if = {
            limit = { alliance_with = root.var:me_epi_royal_wedding_country_scope_3 }
            custom_tooltip = me_epirus_1_epirus.16.tt
        }
        change_variable = {
            name = me_epi_royal_wedding_country_view_count
            add = 2
        }
        ai_chance = {
            factor = 1
            modifier = {
                root.var:me_epi_royal_wedding_country_scope_3 = c:PRY
                factor = 10
            }
        }
    }

    option = {      
        name = me_epirus_1_epirus.16.d
        trigger = {
            root.var:me_epi_royal_wedding_country_view_count = 1
            has_variable = me_epi_royal_wedding_country_scope_4
        }
        root.var:me_epi_royal_wedding_country_scope_4 = { save_scope_as = me_epi_royal_wedding_country_scope }
        custom_tooltip = me_epirus_1_epirus.16.at
        if = {
            limit = { alliance_with = root.var:me_epi_royal_wedding_country_scope_4 }
            custom_tooltip = me_epirus_1_epirus.16.tt
        }
        change_variable = {
            name = me_epi_royal_wedding_country_view_count
            add = 2
        }
        ai_chance = {
            factor = 1
            modifier = {
                root.var:me_epi_royal_wedding_country_scope_4 = c:PRY
                factor = 10
            }
        }
    }

    option = {      
        name = me_epirus_1_epirus.16.e
        trigger = { 
            root.var:me_epi_royal_wedding_country_view_count = 2
            has_variable = me_epi_royal_wedding_country_scope_5
        }
        root.var:me_epi_royal_wedding_country_scope_5 = { save_scope_as = me_epi_royal_wedding_country_scope }
        custom_tooltip = me_epirus_1_epirus.16.at
        if = {
            limit = { alliance_with = root.var:me_epi_royal_wedding_country_scope_5 }
            custom_tooltip = me_epirus_1_epirus.16.tt
        }
        change_variable = {
            name = me_epi_royal_wedding_country_view_count
            add = 2
        }
        ai_chance = {
            factor = 1
            modifier = {
                root.var:me_epi_royal_wedding_country_scope_5 = c:PRY
                factor = 10
            }
        }
    }

    option = {      
        name = me_epirus_1_epirus.16.f
        trigger = {
            root.var:me_epi_royal_wedding_country_view_count = 2
            has_variable = me_epi_royal_wedding_country_scope_6
        }
        root.var:me_epi_royal_wedding_country_scope_6 = { save_scope_as = me_epi_royal_wedding_country_scope }
        custom_tooltip = me_epirus_1_epirus.16.at
        if = {
            limit = { alliance_with = root.var:me_epi_royal_wedding_country_scope_6 }
            custom_tooltip = me_epirus_1_epirus.16.tt
        }
        change_variable = {
            name = me_epi_royal_wedding_country_view_count
            add = 2
        }
        ai_chance = {
            factor = 1
            modifier = {
                root.var:me_epi_royal_wedding_country_scope_6 = c:PRY
                factor = 10
            }
        }
    }

    option = {      
        name = me_epirus_1_epirus.16.g
        trigger = {
            root.var:me_epi_royal_wedding_country_view_count = 2
            has_variable = me_epi_royal_wedding_country_scope_7
        }
        root.var:me_epi_royal_wedding_country_scope_7 = { save_scope_as = me_epi_royal_wedding_country_scope }
        custom_tooltip = me_epirus_1_epirus.16.at
        if = {
            limit = { alliance_with = root.var:me_epi_royal_wedding_country_scope_7 }
            custom_tooltip = me_epirus_1_epirus.16.tt
        }
        change_variable = {
            name = me_epi_royal_wedding_country_view_count
            add = 2
        }
        ai_chance = {
            factor = 1
            modifier = {
                root.var:me_epi_royal_wedding_country_scope_7 = c:PRY
                factor = 10
            }
        }
    }

    option = {      
        name = me_epirus_1_epirus.16.h
        trigger = {
            root.var:me_epi_royal_wedding_country_view_count = 2
            has_variable = me_epi_royal_wedding_country_scope_8
        }
        root.var:me_epi_royal_wedding_country_scope_8 = { save_scope_as = me_epi_royal_wedding_country_scope }
        custom_tooltip = me_epirus_1_epirus.16.at
        if = {
            limit = { alliance_with = root.var:me_epi_royal_wedding_country_scope_8 }
            custom_tooltip = me_epirus_1_epirus.16.tt
        }
        change_variable = {
            name = me_epi_royal_wedding_country_view_count
            add = 2
        }
        ai_chance = {
            factor = 1
            modifier = {
                root.var:me_epi_royal_wedding_country_scope_8 = c:PRY
                factor = 10
            }
        }
    }

    option = { # Change page
        name = me_epirus_1_epirus.16.i 
        trigger = { has_variable = me_epi_royal_wedding_country_scope_5 }
        if = {
            limit = { root.var:me_epi_royal_wedding_country_view_count < 2 }
            change_variable = {
                name = me_epi_royal_wedding_country_view_count
                add = 1
            }
        }
        else_if = {
            limit = { root.var:me_epi_royal_wedding_country_view_count > 1 }
            change_variable = {
                name = me_epi_royal_wedding_country_view_count
                subtract = 1
            }
        }
        trigger_event = { id = me_epirus_1_epirus.16 }
    }

    option = { # Cancel
        name = me_epirus_1_epirus.16.j
        custom_tooltip = me_epirus_1_epirus.20.bt
        add_treasury = 50
        add_legitimacy = subtract_legitimacy_medium
    }

    after = {   
        every_in_list = {
            list = me_epi_1_wedding_countries_list
            remove_from_list = me_epi_1_wedding_countries_list
        }
        if = {
            limit = { root.var:me_epi_royal_wedding_country_view_count >= 3 }
            remove_variable = me_epi_royal_wedding_country_scope_1
            if = {
                limit = { has_variable = me_epi_royal_wedding_country_scope_2 }
                remove_variable = me_epi_royal_wedding_country_scope_2
            }
            if = {
                limit = { has_variable = me_epi_royal_wedding_country_scope_3 }
                remove_variable = me_epi_royal_wedding_country_scope_3
            }
            if = {
                limit = { has_variable = me_epi_royal_wedding_country_scope_4 }
                remove_variable = me_epi_royal_wedding_country_scope_4
            }
            if = {
                limit = { has_variable = me_epi_royal_wedding_country_scope_5 }
                remove_variable = me_epi_royal_wedding_country_scope_5
            }
            if = {
                limit = { has_variable = me_epi_royal_wedding_country_scope_6 }
                remove_variable = me_epi_royal_wedding_country_scope_6
            }
            if = {
                limit = { has_variable = me_epi_royal_wedding_country_scope_7 }
                remove_variable = me_epi_royal_wedding_country_scope_7
            }
            if = {
                limit = { has_variable = me_epi_royal_wedding_country_scope_8 }
                remove_variable = me_epi_royal_wedding_country_scope_8
            }
            trigger_event = { 
                on_action = me_epi_royal_wedding_step_2_groom_on_action
                days = 3
            }
            remove_variable = me_epi_royal_wedding_country_view_count
        }
    }
}

me_epirus_1_epirus.17 = {                           # Royal Wedding - Groom Selection
    type = country_event
    title = me_epirus_1_epirus.17.t
    desc = me_epirus_1_epirus.17.desc
    picture = successors
    left_portrait = current_ruler
    left_portrait = scope:me_epi_royal_wedding_bride_scope
    right_portrait = root.var:me_epi_royal_wedding_groom_scope_1
    right_portrait = root.var:me_epi_royal_wedding_groom_scope_2
    right_portrait = root.var:me_epi_royal_wedding_groom_scope_3
    goto_location = scope:me_epi_royal_wedding_country_scope.capital_scope

    trigger = { 
        has_land = yes 
        exists = scope:me_epi_royal_wedding_bride_scope
        scope:me_epi_royal_wedding_bride_scope = { is_alive = yes }
        exists = scope:me_epi_royal_wedding_country_scope
        scope:me_epi_royal_wedding_country_scope = { has_land = yes }
    }

    immediate = {
        scope:me_epi_royal_wedding_country_scope.current_ruler.family = {
            every_family_member = {
                limit = { me_epi_royal_marriage_groom_trigger = yes }
                add_to_list = me_epi_1_wedding_grooms_list
            }
        }
        set_variable = {
            name = epi_country_flag
            value = scope:me_epi_royal_wedding_country_scope
        }
        me_epi_1_royal_wedding_grooms_list_scope_effect = yes # build list of grooms
    }

    option = {      
        name = me_epirus_1_epirus.17.a
        root.var:me_epi_royal_wedding_groom_scope_1 = { me_epi_royal_wedding_groom_effect = yes } # save scope and fire event for employer
        custom_tooltip = me_epirus_1_epirus.17.at
        ai_chance = {
            factor = 1
            modifier = {
                root.var:me_epi_royal_wedding_groom_scope_1 = char:38
                factor = 10
            }
        }
    }

    option = {      
        name = me_epirus_1_epirus.17.b
        trigger = { has_variable = me_epi_royal_wedding_groom_scope_2 }
        root.var:me_epi_royal_wedding_groom_scope_2 = { me_epi_royal_wedding_groom_effect = yes } # save scope and fire event for employer
        custom_tooltip = me_epirus_1_epirus.17.at
        ai_chance = {
            factor = 1
            modifier = {
                root.var:me_epi_royal_wedding_groom_scope_2 = char:38
                factor = 10
            }
        }
    }

    option = {      
        name = me_epirus_1_epirus.17.c
        trigger = { has_variable = me_epi_royal_wedding_groom_scope_3 }
        root.var:me_epi_royal_wedding_groom_scope_3 = { me_epi_royal_wedding_groom_effect = yes } # save scope and fire event for employer
        custom_tooltip = me_epirus_1_epirus.17.at
        ai_chance = {
            factor = 1
            modifier = {
                root.var:me_epi_royal_wedding_groom_scope_3 = char:38
                factor = 10
            }
        }
    }

    option = {      
        name = me_epirus_1_epirus.17.d
        trigger = { has_variable = me_epi_royal_wedding_groom_scope_4 }
        root.var:me_epi_royal_wedding_groom_scope_4 = { me_epi_royal_wedding_groom_effect = yes } # save scope and fire event for employer
        custom_tooltip = me_epirus_1_epirus.17.at
        ai_chance = {
            factor = 1
            modifier = {
                root.var:me_epi_royal_wedding_groom_scope_4 = char:38
                factor = 10
            }
        }
    }

    option = { # Cancel
        name = me_epirus_1_epirus.17.e
        scope:me_epi_royal_wedding_country_scope = { 
            set_variable = {
                name = me_epi_royal_wedding_rejected_flag
                days = 3650
            }
        }
        custom_tooltip = me_epirus_1_epirus.17.et
        trigger_event = {
            id = me_epirus_1_epirus.16
            days = 3
        }
    }

    after = {
        every_in_list = {
            list = me_epi_1_wedding_grooms_list
            remove_from_list = me_epi_1_wedding_grooms_list
        }
        remove_variable = epi_country_flag
        remove_variable = me_epi_royal_wedding_groom_scope_1
        if = {
            limit = { has_variable = me_epi_royal_wedding_groom_scope_2 }
            remove_variable = me_epi_royal_wedding_groom_scope_2
        }
        if = {
            limit = { has_variable = me_epi_royal_wedding_groom_scope_3 }
            remove_variable = me_epi_royal_wedding_groom_scope_3
        }
        if = {
            limit = { has_variable = me_epi_royal_wedding_groom_scope_4 }
            remove_variable = me_epi_royal_wedding_groom_scope_4
        }
    }
}

me_epirus_1_epirus.18 = {                           # Royal Wedding - Proposal Offer
    type = country_event
    title = "me_epirus_1_epirus.18.t"
    desc = "me_epirus_1_epirus.18.desc"
    picture = greek_court
    left_portrait = current_ruler
    left_portrait = scope:me_epi_royal_wedding_groom_scope
    right_portrait = scope:me_epirus_scope.current_ruler
    right_portrait = scope:me_epi_royal_wedding_bride_scope
    goto_location = scope:me_epirus_scope.capital_scope
    
    option = {
        name = me_epirus_1_epirus.18.a # Accept
        add_treasury = 50
        show_as_tooltip = {
            scope:me_epi_royal_wedding_groom_scope = { marry_character = scope:me_epi_royal_wedding_bride_scope }
        }
        custom_tooltip = dhe_thrace.1.at2
        scope:me_epirus_scope = {
            trigger_event = { 
                id = me_epirus_1_epirus.19
                days = 3
            }
        }
        ai_chance = { 
            factor = 50
            modifier = {
                factor = 1.2
                scope:me_epi_royal_wedding_bride_scope.martial > scope:me_epi_royal_wedding_groom_scope.martial
            }
            modifier = {
                factor = 1.2
                scope:me_epi_royal_wedding_bride_scope.charisma > scope:me_epi_royal_wedding_groom_scope.charisma
            }
            modifier = {
                factor = 1.2
                scope:me_epi_royal_wedding_bride_scope.finesse > scope:me_epi_royal_wedding_groom_scope.finesse
            }
            modifier = {
                factor = 1.2
                scope:me_epi_royal_wedding_bride_scope.zeal > scope:me_epi_royal_wedding_groom_scope.zeal
            }
            modifier = {
                factor = 1.2
                scope:me_epirus_scope.country_population > root.country_population
            }
            modifier = {
                factor = 1.2
                opinion = { target = scope:me_epirus_scope value > 50 }
            }
            modifier = {
                factor = 1.2
                opinion = { target = scope:me_epirus_scope value > 100 }
            }
            modifier = {
                factor = 1.2
                alliance_with = scope:me_epirus_scope
            }
            modifier = {
                factor = 1.2
                scope:me_epi_royal_wedding_bride_scope = { has_trait = aeacidae }
            }
            modifier = {
                factor = 1.2
                scope:me_epi_royal_wedding_bride_scope = { has_trait = argeads }
            }
            modifier = {
                factor = 1.2
                scope:me_epi_royal_wedding_bride_scope = { age <= 20 }
            }
            modifier = {
                factor = 1.1
                scope:me_epi_royal_wedding_bride_scope = { age <= 30 }
            }
            modifier = {
                factor = 0.75
                scope:me_epi_royal_wedding_bride_scope = { age > 39 }
            }
            modifier = {
                factor = 0.5
                scope:me_epi_royal_wedding_bride_scope = { age > 50 }
            }
        }
    }
    
    
    option = {
        name = me_epirus_1_epirus.18.b # Reject
        set_variable = {
            name = me_epi_royal_wedding_rejected_flag
            days = 3650
        }
        scope:me_epi_royal_wedding_groom_scope = {
            set_variable = {
                name = me_epi_royal_marriage_rejected_bride_flag
                value = scope:me_epi_royal_wedding_bride_scope
            }
        }
        scope:me_epirus_scope = {
            trigger_event = { 
                on_action = me_epi_royal_wedding_step_4_wedding_on_action
                days = 3
            }
        }
        show_as_tooltip = {
            scope:me_epirus_scope = { 
                add_opinion = { modifier = opinion_royal_marriage_refused target = root }
            }
        }
        ai_chance = { factor = 50 }
    }
}

me_epirus_1_epirus.19 = {                           # Royal Wedding - Ceremony
    type = country_event
    title = "me_epirus_1_epirus.19.t"
    desc = {
        first_valid = {
            triggered_desc = { # EPI
                trigger = { this = scope:me_epirus_scope }
                desc = "flavor_epi.3.desc_1"
            }
            triggered_desc = { # Other
                trigger = { this = scope:me_epi_royal_wedding_country_scope }
                desc = "flavor_epi.3.desc_2"
            }
        }
    }
    picture = celtic_religious_festival
    left_portrait = scope:me_epirus_scope.current_ruler
    left_portrait = scope:me_epi_royal_wedding_bride_scope
    right_portrait = scope:me_epi_royal_wedding_country_scope.current_ruler
    right_portrait = scope:me_epi_royal_wedding_groom_scope
    goto_location = scope:me_epi_royal_wedding_country_scope.capital_scope
    
    trigger = {
        has_dlc = "Epirus Flavor Pack"
        scope:me_epirus_scope = { has_land = yes }
        scope:me_epi_royal_wedding_country_scope = { 
            has_land = yes
            NOT = { has_variable = me_epi_royal_wedding_rejected_flag }
        }
    }

    immediate = {
        if = {
            limit = { this = scope:me_epirus_scope }
            scope:me_epi_royal_wedding_bride_scope = {  
                if = {
                    limit = { is_married = yes }
                    spouse = { save_scope_as = me_epi_royal_wedding_bride_spouse_scope }
                    divorce_character = spouse
                }
                move_country = scope:me_epi_royal_wedding_country_scope
                hidden_effect = { 
                    remove_character_modifier = foreign_citizen
                    set_home_country = scope:me_epi_royal_wedding_country_scope 
                    set_as_minor_character = scope:me_epi_royal_wedding_bride_scope
                }
            }
            scope:me_epi_royal_wedding_groom_scope = {
                if = {
                    limit = { is_married = yes }
                    spouse = { save_scope_as = me_epi_royal_wedding_groom_spouse_scope }
                    divorce_character = spouse
                }
            }
            scope:me_epi_royal_wedding_country_scope = {
                add_treasury = 50
                add_opinion = { modifier = flavor_epi_pry_marriage_op target = scope:me_epirus_scope }
                reverse_add_opinion = { modifier = flavor_epi_pry_marriage_op target = scope:me_epirus_scope }
            }
            char:70 = {
                if = {
                    limit = { 
                        is_alive = yes
                        c:EPI = {
                            NOT = { has_variable = epi_molossian_ultimatum_flag }
                        }
                    }
                    set_variable = { 
                        name = flavor_epi_deidamia_demetrius_married_flag
                        value = scope:me_epi_royal_wedding_country_scope
                    }
                }
            }
        }
        else = {
            show_as_tooltip = {
                scope:me_epi_royal_wedding_bride_scope = {  
                    if = {
                        limit = { exists = scope:me_epi_royal_wedding_bride_spouse_scope }
                        divorce_character = scope:me_epi_royal_wedding_bride_spouse_scope
                    }
                    move_country = scope:me_epi_royal_wedding_country_scope
                }
                scope:me_epi_royal_wedding_groom_scope = {
                    if = {
                        limit = { exists = scope:me_epi_royal_wedding_groom_spouse_scope }
                        divorce_character = scope:me_epi_royal_wedding_groom_spouse_scope
                    }
                    marry_character = scope:me_epi_royal_wedding_bride_scope
                }
                scope:me_epi_royal_wedding_country_scope = {
                    add_treasury = 50
                    add_opinion = { modifier = flavor_epi_pry_marriage_op target = scope:me_epirus_scope }
                    reverse_add_opinion = { modifier = flavor_epi_pry_marriage_op target = scope:me_epirus_scope }
                }
            }
        }
    }

    option = { # EPI
        name = "flavor_epi.3.a"
        trigger = { this = scope:me_epirus_scope }
        scope:me_epi_royal_wedding_groom_scope = { marry_character = scope:me_epi_royal_wedding_bride_scope }
        scope:me_epi_royal_wedding_country_scope = {
            trigger_event = { id = me_epirus_1_epirus.19 }
        }
    }
   
    option = { # Other
        name = "flavor_epi.3.a"
        trigger = { this = scope:me_epi_royal_wedding_country_scope }
    }
}

me_epirus_1_epirus.20 = {                           # Royal Wedding - Rejected Restart
    type = country_event
    title = me_epirus_1_epirus.20.t
    desc = me_epirus_1_epirus.20.desc
    picture = greek_court
    left_portrait = current_ruler
    left_portrait = scope:me_epi_royal_wedding_bride_scope
    right_portrait = scope:me_epi_royal_wedding_country_scope.current_ruler
    right_portrait = scope:me_epi_royal_wedding_groom_scope

    trigger = { 
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    immediate = {
        add_opinion = { modifier = opinion_royal_marriage_refused target = scope:me_epi_royal_wedding_country_scope }
    }

    option = {      
        name = me_epirus_1_epirus.20.a
        trigger = {
            any_country = { me_epi_royal_marriage_country_trigger = yes }
        }
        trigger_event = {
            id = me_epirus_1_epirus.16
            days = 3
        }
        custom_tooltip = me_epirus_1_epirus.20.at
    }

    option = {      
        name = me_epirus_1_epirus.20.b
        trigger = {
            any_country = { me_epi_royal_marriage_country_trigger = yes }
        }
        custom_tooltip = me_epirus_1_epirus.20.bt
    }

    option = {      
        name = me_epirus_1_epirus.20.c
        trigger = {
            NOT = {
                any_country = { me_epi_royal_marriage_country_trigger = yes }
            }
        }
        custom_tooltip = me_epirus_1_epirus.20.ct
    }
}

me_epirus_1_epirus.21 = {                           # Royal Wedding - Restart Fallback
    type = country_event
    title = me_epirus_1_epirus.21.t
    desc = me_epirus_1_epirus.21.desc
    picture = greek_court

    trigger = { 
        has_dlc = "Epirus Flavor Pack"
        has_land = yes 
    }

    option = {      
        name = me_epirus_1_epirus.21.a
        custom_tooltip = me_epirus_1_epirus.21.at
        trigger_event = {
            id = me_epirus_1_epirus.15
            days = 3
        }
    }

    after = { me_epi_1_clear_wedding_effect = yes }
}

me_epirus_1_epirus.22 = {                           # Royal Wedding - Angry Groom
    type = character_event
    hidden = yes

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_variable = me_epi_royal_marriage_rejected_bride_flag
        var:me_epi_royal_marriage_rejected_bride_flag = {
            is_married = yes
            spouse = { 
                is_alive = yes
                NOT = { is_rival = root }
            }
        }
    }

    weight_multiplier = { # Has corrupt traits
        base = 1
        modifier = {
            factor = 4
            OR = {
                has_trait = cruel
                has_trait = proud
            }
        } 
    }

    immediate = {
        var:me_epi_royal_marriage_rejected_bride_flag = { add_rival = root }
        remove_variable = me_epi_royal_marriage_rejected_bride_flag
    }
}

me_epirus_1_epirus.23 = {                           # Royal Wedding - Start
    type = country_event
    title = me_epirus_1_epirus.23.t
    desc = me_epirus_1_epirus.23.desc
    picture = greek_court
    left_portrait = current_ruler
    right_portrait = root.var:me_epi_royal_wedding_bride_scope_1
    right_portrait = root.var:me_epi_royal_wedding_bride_scope_2

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    option = {
        name = me_epirus_1_epirus.23.a
        custom_tooltip = me_epirus_1_epirus.23.at
    }

    after = {
        remove_variable = me_epi_royal_wedding_bride_scope_1
        if = {
            limit = { has_variable = me_epi_royal_wedding_bride_scope_2 }
            remove_variable = me_epi_royal_wedding_bride_scope_2
        }
        if = {
            limit = { has_variable = me_epi_royal_wedding_bride_scope_3 }
            remove_variable = me_epi_royal_wedding_bride_scope_3
        }
        if = {
            limit = { has_variable = me_epi_royal_wedding_bride_scope_4 }
            remove_variable = me_epi_royal_wedding_bride_scope_4
        }
    }
}

me_epirus_1_epirus.24 = {                           # Royal Wedding - Bypass
    type = country_event
    title = me_epirus_1_epirus.24.t
    desc = {
        desc = me_epirus_1_epirus.24.desc
        first_valid = {
            triggered_desc = { # No brides
                trigger = { 
                    current_ruler.family = {
                        any_family_member = { me_epi_royal_marriage_bride_trigger = yes }
                    }
                }
                desc = "me_epirus_1_epirus.24.desc_1"
            }
            triggered_desc = { # No grooms
                trigger = { 
                    current_ruler.family = {
                        any_family_member = { me_epi_royal_marriage_groom_trigger = yes }
                    }
                }
                desc = "me_epirus_1_epirus.24.desc_2"
            }
        }
    }
    picture = greek_court

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    option = {
        name = me_epirus_1_epirus.24.a
        custom_tooltip = me_epirus_1_epirus.24.at
    }
}

me_epirus_1_epirus.25 = {                           # Tighten Administration - Start
    type = country_event
    title = me_epirus_1_epirus.25.t
    desc = me_epirus_1_epirus.25.desc
    picture = greek_court
    left_portrait = current_ruler
    right_portrait = scope:epi_steward

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }  

    immediate = { 
        add_stability = -5
        random_character = { 
            limit = { has_office = office_steward }
            save_scope_as = epi_steward
        }
    }

    option = {
        name = me_epirus_1_epirus.25.a
        custom_tooltip = me_epirus_1_epirus.25.at
    }
}

me_epirus_1_epirus.26 = {                           # Tribal Command - Start
    type = country_event
    title = me_epirus_1_epirus.26.t
    desc = me_epirus_1_epirus.26.desc
    picture = epirote_phalanx
    left_portrait = current_ruler
    right_portrait = scope:epi_marshal

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }  

    immediate = { 
        add_stability = -5
        random_character = { 
            limit = { has_office = office_marshal }
            save_scope_as = epi_marshal
        }
    }

    option = {
        name = me_epirus_1_epirus.26.a
        custom_tooltip = me_epirus_1_epirus.26.at
    }
}

me_epirus_1_epirus.27 = {                           # Settle Crown Disputes - Start
    type = country_event
    title = me_epirus_1_epirus.27.t
    desc = me_epirus_1_epirus.27.desc
    picture = road_construction
    left_portrait = current_ruler

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }  

    option = {
        name = me_epirus_1_epirus.27.a
        custom_tooltip = me_epirus_1_epirus.27.at
    }
}

me_epirus_1_epirus.28 = {                           # A New City - Start
    type = country_event
    title = me_epirus_1_epirus.28.t
    desc = {
        desc = me_epirus_1_epirus.28.desc
        first_valid = {
            triggered_desc = { # Diadochi
                trigger = { has_variable = berenicis_country_flag }
                desc = "me_epirus_1_epirus.28.desc_1"
            }
            triggered_desc = { # Achilles
                trigger = { always = yes }
                desc = "me_epirus_1_epirus.28.desc_2"
            }
        }
        first_valid = {
            triggered_desc = { # Choices
                trigger = {
                    list_size = {
                        name = me_epi_1_8_city_list
                        value > 1
                    }
                }
                desc = "me_epirus_1_epirus.28.desc_3"
            }
            triggered_desc = { # One
                trigger = { always = yes }
                desc = "me_epirus_1_epirus.28.desc_4"
            }
        }
    }
    picture = road_construction
    goto_location = scope:berenicis_scope

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }  

    immediate = {
        add_treasury = -100
        if = {
            limit = { current_ruler = char:70 }
            current_ruler = { 
                save_scope_as = pyrrhus
                if = {
                    limit = {
                        has_variable = pyrrhus_supported_small_flag
                        OR = {
                            var:pyrrhus_supported_small_flag = c:TRE
                            var:pyrrhus_supported_small_flag = c:MAC
                            var:pyrrhus_supported_small_flag = c:PRY
                            var:pyrrhus_supported_small_flag = c:SEL
                            var:pyrrhus_supported_small_flag = c:EGY
                        }
                    }
                    root = { me_epi_1_berenicis_effect_1 = yes }
                }
                else_if = {
                    limit = {
                        has_variable = pyrrhus_supported_big_flag
                        OR = {
                            var:pyrrhus_supported_big_flag = c:TRE
                            var:pyrrhus_supported_big_flag = c:MAC
                            var:pyrrhus_supported_big_flag = c:PRY
                            var:pyrrhus_supported_big_flag = c:SEL
                            var:pyrrhus_supported_big_flag = c:EGY
                        }
                    }
                    root = { me_epi_1_berenicis_effect_2 = yes }
                }
            }
        }
        ordered_owned_province = {
            limit = {
                is_coastal = yes
                is_capital = no
                has_city_status = no
                is_in_area = epirus_area
                NOR = {
                    this = p:470
                    has_construction = yes
                    has_province_rank = city_metropolis
                    has_city_status = yes
                    has_province_modifier = revoked_city_status_modifier
                    has_province_modifier = founding_city_in_progress
                    has_province_modifier = urban_development_in_progress
                }
            }
            max = 4
            check_range_bounds = no
            add_to_list = me_epi_1_8_city_list
        }
        ordered_in_list = {
            list = me_epi_1_8_city_list
            order_by = total_population
            position = 0
            save_scope_as = me_epi_1_8_city_1
        }
        if = {
            limit = {
                list_size = {
                    name = me_epi_1_8_city_list
                    value >= 2
                }
            }
            ordered_in_list = {
                list = me_epi_1_8_city_list
                order_by = total_population
                position = 1
                save_scope_as = me_epi_1_8_city_2
            }
        }
        if = {
            limit = {
                list_size = {
                    name = me_epi_1_8_city_list
                    value >= 3
                }
            }
            ordered_in_list = {
                list = me_epi_1_8_city_list
                order_by = total_population
                position = 2
                save_scope_as = me_epi_1_8_city_3
            }
        }
        if = {
            limit = {
                list_size = {
                    name = me_epi_1_8_city_list
                    value >= 4
                }
            }
            ordered_in_list = {
                list = me_epi_1_8_city_list
                order_by = total_population
                position = 3
                save_scope_as = me_epi_1_8_city_4
            }
        }
    }

    option = {
        name = me_epirus_1_epirus.28.a
        trigger = {
            list_size = {
                name = me_epi_1_8_city_list
                value < 2
            }
        }
        set_variable = {
            name = berenicis_flag
            value = scope:me_epi_1_8_city_1
        }
        scope:me_epi_1_8_city_1 = { 
            add_province_modifier = {
                name = founding_city_in_progress
                duration = 365
            }
        }
        custom_tooltip = me_epirus_1_epirus.28.bt
    }

    option = {
        name = me_epirus_1_epirus.28.b
        trigger = {
            list_size = {
                name = me_epi_1_8_city_list
                value > 1
            }
        }
        set_variable = {
            name = berenicis_flag
            value = scope:me_epi_1_8_city_1
        }
        scope:me_epi_1_8_city_1 = { 
            save_scope_as = berenicis_scope
            add_province_modifier = {
                name = founding_city_in_progress
                duration = 365
            }
        }
        custom_tooltip = me_epirus_1_epirus.28.bt
    }

    option = {
        name = me_epirus_1_epirus.28.c
        trigger = { exists = scope:me_epi_1_8_city_2 }
        set_variable = {
            name = berenicis_flag
            value = scope:me_epi_1_8_city_2
        }
        scope:me_epi_1_8_city_2 = { 
            save_scope_as = berenicis_scope
            add_province_modifier = {
                name = founding_city_in_progress
                duration = 365
            }
        }
        custom_tooltip = me_epirus_1_epirus.28.bt
    }

    option = {
        name = me_epirus_1_epirus.28.d
        trigger = { exists = scope:me_epi_1_8_city_3 }
        set_variable = {
            name = berenicis_flag
            value = scope:me_epi_1_8_city_3
        }
        scope:me_epi_1_8_city_3 = { 
            save_scope_as = berenicis_scope
            add_province_modifier = {
                name = founding_city_in_progress
                duration = 365
            }
        }
        custom_tooltip = me_epirus_1_epirus.28.bt
    }

    option = {
        name = me_epirus_1_epirus.28.e
        trigger = { exists = scope:me_epi_1_8_city_4 }
        set_variable = {
            name = berenicis_flag
            value = scope:me_epi_1_8_city_4
        }
        scope:me_epi_1_8_city_4 = { 
            save_scope_as = berenicis_scope
            add_province_modifier = {
                name = founding_city_in_progress
                duration = 365
            }
        }
        custom_tooltip = me_epirus_1_epirus.28.bt
    }

    after = { set_variable = epirus_1_epirus_8_bypass_flag }
}

me_epirus_1_epirus.29 = {                           # Adriatic City - Bypass
    type = country_event
    title = me_epirus_1_epirus.29.t
    desc = me_epirus_1_epirus.29.desc
    picture = greek_court

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }  

    option = {
        name = me_epirus_1_epirus.29.a
        custom_tooltip = me_epirus_1_epirus.29.at
    }
}

me_epirus_1_epirus.30 = {                           # Taulantian Diplomacy - Ping
    type = country_event
    title = me_epirus_1_epirus.30.t
    desc = {
        desc = me_epirus_1_epirus.30.desc
        first_valid = {
            triggered_desc = { # 
                trigger = { 
                    scope:me_epirus_scope.current_ruler = char:118
                    current_ruler = char:105
                }
                desc = "me_epirus_1_epirus.30.desc_1"
            }
            triggered_desc = { # 
                trigger = { 
                    scope:me_epirus_scope.current_ruler = char:70
                    current_ruler = char:105
                }
                desc = "me_epirus_1_epirus.30.desc_2"
            }
            triggered_desc = { #
                trigger = { always = yes }
                desc = "me_epirus_1_epirus.30.desc_3"
            }
        }
    }
    picture = greek_court
    left_portrait = current_ruler
    left_portrait = scope:allies_pyrrhos_portrait_scope
    right_portrait = scope:me_epirus_scope.current_ruler
    right_portrait = scope:epirote_diplomat_scope
    goto_location = scope:me_epirus_scope.capital_scope

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }  

    immediate = {
        if = {
            limit = { scope:me_epirus_scope.current_ruler = char:118 }
            char:70 = { save_scope_as = allies_pyrrhos_portrait_scope }
        }
    }

    option = {
        name = me_epirus_1_epirus.30.a
        show_as_tooltip = {
            if = {
                limit = {
                    current_ruler = { is_rival = scope:me_epirus_scope.current_ruler }
                }
                current_ruler = { remove_rival = scope:me_epirus_scope.current_ruler }
            }
            add_opinion = { target = scope:me_epirus_scope modifier = me_epi_1_2_opmod }
            reverse_add_opinion = { target = scope:me_epirus_scope modifier = me_epi_1_2_opmod }
            if = {
                limit = {
                    NOT = { alliance_with = scope:me_epirus_scope }
                }
                add_alliance = scope:me_epirus_scope
            }
        }
        set_variable = me_epi_1_friendship_accept
        ai_chance = {
            factor = 3
            modifier = {
                factor = 2
                current_ruler = char:105
                scope:me_epirus_scope.current_ruler = char:70
            }
        }
    }

    option = {
        name = me_epirus_1_epirus.30.b
        custom_tooltip = me_epirus_1_epirus.30.bt
        show_as_tooltip = {
            if = {
                limit = {
                    current_ruler = { is_friend = scope:me_epirus_scope.current_ruler }
                }
                current_ruler = { remove_friend = scope:me_epirus_scope.current_ruler }
            }
            if = {
                limit = { alliance_with = scope:me_epirus_scope }
                break_alliance = scope:me_epirus_scope
            }
        }
        ai_chance = {
            factor = 1
            modifier = {
                factor = 3
                current_ruler = char:105
                scope:me_epirus_scope.current_ruler = char:118
            }
        }
    }

    after = {
        scope:me_epirus_scope = {
            trigger_event = { id = me_epirus_1_epirus.31 }
        }
    }
}

me_epirus_1_epirus.31 = {                           # Taulantian Diplomacy - Response
    type = country_event
    title = me_epirus_1_epirus.31.t
    desc = {
        desc = "me_epirus_1_epirus.31.desc"
        first_valid = {
            triggered_desc = { # 
                trigger = { 
                    c:TLN = { has_variable = me_epi_1_friendship_accept }
                }
                desc = "me_epirus_1_epirus.31.desc_1"
            }
            triggered_desc = { #
                trigger = { always = yes }
                desc = "me_epirus_1_epirus.31.desc_2"
            }
        }
    }
    picture = greek_court
    left_portrait = current_ruler
    left_portrait = scope:epirote_diplomat_scope
    right_portrait = c:TLN.current_ruler

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }  

    option = {
        name = me_epirus_1_epirus.31.a
        trigger = { 
            c:TLN = { has_variable = me_epi_1_friendship_accept }
        }
        if = {
            limit = {
                current_ruler = { is_rival = c:TLN.current_ruler }
            }
            current_ruler = { remove_rival = c:TLN.current_ruler }
        }
        add_opinion = { target = c:TLN modifier = me_epi_1_2_opmod }
        reverse_add_opinion = { target = c:TLN modifier = me_epi_1_2_opmod }
        if = {
            limit = {
                NOT = { alliance_with = c:TLN }
            }
            add_alliance = c:TLN
        }
        ai_chance = {
            factor = 80
        }
    }

    option = {
        name = me_epirus_1_epirus.31.b
        trigger = { 
            c:TLN = { 
                NOT = { has_variable = me_epi_1_friendship_accept }
            }
        }
        custom_tooltip = epirus_1_epirus_1_reward_tt
        set_variable = me_epi_1_2_aggression_flag
        hidden_effect = {
            area:illyria_graeca_area = {
                every_area_province = {
                    limit = { owner = c:TLN }
                    add_claim = root
                }
            }
            area:epirus_area = {
                every_area_province = {
                    limit = { owner = c:TLN }
                    add_claim = root
                }
            }
        }
        if = {
            limit = {
                current_ruler = { is_friend = c:TLN.current_ruler }
            }
            current_ruler = { remove_friend = c:TLN.current_ruler }
        }
        if = {
            limit = { alliance_with = c:TLN }
            break_alliance = scope:me_epirus_scope
        }
        custom_tooltip = me_epirus_1_epirus.31.bt
        ai_chance = {
            factor = 1
        }
    }

    after = {
        c:TLN = {
            if = {
                limit = { has_variable = me_epi_1_friendship_accept }
            }
            remove_variable = me_epi_1_friendship_accept
        }
    }
}

me_epirus_1_epirus.32 = {                           # Lean on Korkyra - Ping
    type = country_event
    title = me_epirus_1_epirus.32.t
    desc = "me_epirus_1_epirus.32.desc"
    picture = council_country
    left_portrait = current_ruler
    right_portrait = scope:me_epirus_scope.current_ruler
    right_portrait = scope:epirote_diplomat_scope
    goto_location = scope:me_epirus_scope.capital_scope

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }  

    immediate = { save_scope_as = korkyra_scope }

    option = {
        name = me_epirus_1_epirus.32.a
        if = {
            limit = {
                c:KRK = { is_subject = yes }
            }
            c:KRK.overlord = { release_subject = c:KRK }
        }
        scope:me_epirus_scope = {
            make_subject = {
                type = feudatory
                target = root
            }
        }
        ai_chance = {
            factor = 1
            modifier = {
                factor = 1.5
                scope:epirote_diplomat_scope.charisma >= 8 
            }
            modifier = {
                factor = 2
                scope:epirote_diplomat_scope.charisma >= 10
            }
            modifier = {
                factor = 3
                root.num_of_cities < scope:me_epirus_scope.num_of_cities
            }
            modifier = {
                factor = 3
                root.num_of_cohorts < scope:me_epirus_scope.num_of_cohorts
            }
            modifier = {
                factor = 99
                c:EPI = { is_ai = yes }
            }
        }
    }

    option = {
        name = me_epirus_1_epirus.32.b
        p:470 = { add_claim = scope:me_epirus_scope }
        ai_chance = {
            factor = 2
            modifier = {
                factor = 10
                root.num_of_cities > scope:me_epirus_scope.num_of_cities
            }
            modifier = {
                factor = 5
                root.num_of_cohorts > scope:me_epirus_scope.num_of_cohorts
            }
        }
    }

    after = {
        scope:me_epirus_scope = {
            trigger_event = { 
                id = me_epirus_1_epirus.37 
                days = 5
            }
        }
    }
}

me_epirus_1_epirus.33 = {                           # Lean on Korkyra - Start
    type = country_event
    title = me_epirus_1_epirus.33.t
    desc = "me_epirus_1_epirus.33.desc"
    picture = ship_in_storm

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }  

    immediate = { add_political_influence = -5 }

    option = {
        name = me_epirus_1_epirus.33.a
        custom_tooltip = me_epirus_1_epirus.33.at
    }
}

me_epirus_1_epirus.34 = {                           # Apollo Aktiakos - Start
    type = country_event
    title = me_epirus_1_epirus.34.t
    desc = "me_epirus_1_epirus.34.desc"
    picture = dodona

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }  

    immediate = {
        add_treasury = -150
    }

    option = {
        name = me_epirus_1_epirus.34.a
        custom_tooltip = me_epirus_1_epirus.34.at
    }
}

me_epirus_1_epirus.35 = {                           # Apollo Aktiakos - End
    type = country_event
    title = me_epirus_1_epirus.35.t
    desc = "me_epirus_1_epirus.35.desc"
    picture = greek_religious_rite

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }  

    immediate = { custom_tooltip = me_epirus_1_epirus.35.at }

    option = {
        name = me_epirus_1_epirus.35.a
        custom_tooltip = epirus_1_epirus_18_reward_tt
    }
}

me_epirus_1_epirus.36 = {                           # Urbanize Passaron - Start
    type = country_event
    title = me_epirus_1_epirus.36.t
    desc = "me_epirus_1_epirus.36.desc"
    picture = greek_court

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }  

    option = {
        name = me_epirus_1_epirus.36.a
        custom_tooltip = me_epirus_1_epirus.36.at
    }
}

me_epirus_1_epirus.37 = {                           # Lean on Korkyra - Response
    type = country_event
    title = me_epirus_1_epirus.37.t
    desc = {
        desc = "me_epirus_1_epirus.37.desc"
        first_valid = {
            triggered_desc = { # 
                trigger = { 
                    c:KRK = { is_subject_of = root }
                }
                desc = "me_epirus_1_epirus.37.desc_1"
            }
            triggered_desc = { # Other
                trigger = { always = yes }
                desc = "me_epirus_1_epirus.37.desc_2"
            }
        }
    }
    picture = greek_court
    left_portrait = current_ruler
    left_portrait = scope:epirote_diplomat_scope
    right_portrait = c:KRK.current_ruler

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }  

    immediate = {
        if = {
            limit = {
                c:KRK = { is_subject_of = root }
            }
            show_as_tooltip = {
                make_subject = {
                    type = feudatory
                    target = scope:korkyra_scope
                }
            }
        }
        else = {
            p:470 = { add_claim = scope:me_epirus_scope }
        }
    }

    option = {
        name = me_epirus_1_epirus.37.a
        trigger = { 
            c:KRK = { is_subject_of = root }
        }
    }

    option = {
        name = me_epirus_1_epirus.37.b
        trigger = { 
            c:KRK = { is_subject = no }
        }
    }
}

me_epirus_1_epirus.38 = {                           # Korkyran Claims - Bypass
    type = country_event
    title = me_epirus_1_epirus.38.t
    desc = {
        first_valid = {
            triggered_desc = { # 
                trigger = { 
                    NOT = { owns_or_subject_owns = 470 }
                }
                desc = "me_epirus_1_epirus.38.desc_1"
            }
            triggered_desc = { # Other
                trigger = { owns_or_subject_owns = 470 }
                desc = "me_epirus_1_epirus.38.desc_2"
            }
        }
    }
    picture = greek_court

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }  

    immediate = { 
        custom_tooltip = me_epirus_1_epirus.38.tt
        if = {
            limit = {
                NOT = { owns_or_subject_owns = 470 }
                c:KRK = { 
                    OR = {
                        has_land = no
                        NOT = { owns = 470 }
                    }
                }
            }
            trigger_event = { id = me_epirus_1_epirus.38 }
        }
    }

    option = {
        name = me_epirus_1_epirus.38.a
       
    }
}

me_epirus_1_epirus.39 = {                           # The Illyrian Hinterland - Start
    type = country_event
    title = me_epirus_1_epirus.39.t
    desc = "me_epirus_1_epirus.39.desc"
    picture = greek_court
    goto_location = c:TLN.capital_scope

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }  

    immediate = {
        me_epi_1_kineas_effect = yes # save diplomat scope effect
        custom_tooltip = me_epirus_1_epirus.39.tt 
        set_variable = {
            name = illyria_demands
            value = 0
        }
        if = {
            limit = {
                c:TLN = { owns = 3192 }
                p:3192 = {
                    any_neighbor_province = { owner = scope:me_epirus_scope }
                }
            }
            p:3192 = { save_scope_as = byllis_scope }
        }
        else = {
            random_owned_province = {
                limit = {
                    any_neighbor_province = { owner = c:TLN }
                }
            }
        }
    }

    option = { # Byllis
        name = me_epirus_1_epirus.39.a
        trigger = { exists = scope:byllis_scope }
        change_variable = {
            name = illyria_demands
            add = 1
        }
        custom_tooltip = me_epirus_1_epirus.39.at
        show_as_tooltip = {
            reverse_add_opinion = { target = c:TLN modifier = me_epi_1_16_wounded_opmod }
        }
        me_epi_16_ai_effect = yes
        ai_chance = {
            factor = 1
        }
    }

    option = { # More
        name = me_epirus_1_epirus.39.b
        trigger = { 
            c:TLN = {
                any_owned_province = {
                    OR = {
                        province_id = 422
                        province_id = 455
                        province_id = 1445
                        province_id = 3192
                        province_id = 467
                        province_id = 464
                        province_id = 421
                    }
                    any_neighbor_province = { owner = scope:me_epirus_scope }
                }
            }
        }
        change_variable = {
            name = illyria_demands
            add = 2
        }
        custom_tooltip = me_epirus_1_epirus.39.bt
        show_as_tooltip = {
            reverse_add_opinion = { target = c:TLN modifier = me_epi_1_16_bad_opmod }
        }
        me_epi_16_ai_effect = yes
        ai_chance = {
            factor = 99
        }
    }

    option = { # Even more
        name = me_epirus_1_epirus.39.c
        trigger ={
            c:TLN = { is_subject = no }
        }
        change_variable = {
            name = illyria_demands
            add = 3
        }
        custom_tooltip = me_epirus_1_epirus.39.ct
        show_as_tooltip = {
            reverse_add_opinion = { target = c:TLN modifier = me_epi_1_16_grave_opmod }
        }
        me_epi_16_ai_effect = yes
        ai_chance = {
            factor = 2
        }
    }

    option = { # Nothing
        name = me_epirus_1_epirus.39.d
        reverse_add_opinion = { target = c:TLN modifier = me_epi_1_16_4_opmod }
        ai_chance = { factor = 0 }
    }

    after = {
        c:TLN = {
            trigger_event = { 
                id = me_epirus_1_epirus.46 
                days = 15
            }
        }
    }
}

me_epirus_1_epirus.40 = {                           # Cult of Dione - Start
    type = country_event
    title = me_epirus_1_epirus.40.t
    desc = "me_epirus_1_epirus.40.desc"
    picture = dodona

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }  

    immediate = {
        add_treasury = -150
    }

    option = {
        name = me_epirus_1_epirus.40.a
        custom_tooltip = me_epirus_1_epirus.40.tt
    }
}

me_epirus_1_epirus.41 = {                           # Taulantian Diplomacy - Aggression Ping
    type = country_event
    title = me_epirus_1_epirus.41.t
    desc = me_epirus_1_epirus.41.desc
    picture = greek_court
    left_portrait = current_ruler
    right_portrait = scope:me_epirus_scope.current_ruler
    right_portrait = scope:epirote_diplomat_scope

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }  

    option = {
        name = me_epirus_1_epirus.41.a
        if = {
            limit = {
                scope:me_epirus_scope.current_ruler = { is_friend = root.current_ruler }
            }
            scope:me_epirus_scope.current_ruler = { remove_friend = root.current_ruler }
        }
        show_as_tooltip = {
            scope:me_epirus_scope = {
                add_opinion = { target = c:TLN modifier = me_epi_1_1_opmod }
                reverse_add_opinion = { target = c:TLN modifier = me_epi_1_1_opmod }
            }
        }
        if = {
            limit = { alliance_with = scope:me_epirus_scope }
            scope:me_epirus_scope = { break_alliance = root }
        }
        custom_tooltip = epirus_1_epirus_1_reward_tt
    }
}

me_epirus_1_epirus.42 = {                           # Southern Claims - Start
    type = country_event
    title = me_epirus_1_epirus.42.t
    desc = me_epirus_1_epirus.42.desc
    picture = greek_siege

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }  

    immediate = { add_political_influence = -5 }

    option = {
        name = me_epirus_1_epirus.42.a
        custom_tooltip = me_epirus_1_epirus.42.at
    }
}

me_epirus_1_epirus.43 = {                           # Coastal Capital - Start
    type = country_event
    title = me_epirus_1_epirus.43.t
    desc = me_epirus_1_epirus.43.desc
    picture = greek_court

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }  

    immediate = { 
        add_treasury = -50
    }

    option = {
        name = me_epirus_1_epirus.43.a
        custom_tooltip = me_epirus_1_epirus.43.at
    }

    after = {
        set_variable = me_epi_1_17_bypass
    }
}

me_epirus_1_epirus.44 = {                           # Coastal Capital - End
    type = country_event
    title = me_epirus_1_epirus.44.t
    desc = me_epirus_1_epirus.44.desc
    picture = greek_court

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }  

    immediate = { custom_tooltip = me_epirus_1_epirus.44.at }

    option = {
        name = me_epirus_1_epirus.44.a
        set_capital = p:465
        p:465 = {
            if = {
                limit = { has_city_status = no }
                set_city_status = city
            }
            define_pop = {
                type = citizen
                culture = root.culture
                religion = root.religion
            }
            define_pop = {
                type = freemen
                culture = root.culture
                religion = root.religion
            }
            define_pop = {
                type = freemen
                culture = root.culture
                religion = root.religion
            }
            add_province_modifier = {
                name = me_epi_1_17_pmod
                duration = -1
            }
        }
    }
}

me_epirus_1_epirus.45 = {                           # Coastal Capital - Bypass
    type = country_event
    title = me_epirus_1_epirus.45.t
    desc = me_epirus_1_epirus.45.desc
    picture = greek_court

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }  

    option = {
        name = me_epirus_1_epirus.45.a
        custom_tooltip = me_epirus_1_epirus.45.at
    }
}

me_epirus_1_epirus.46 = {                           # The Illyrian Hinterland - Ping
    type = country_event
    title = me_epirus_1_epirus.46.t
    desc = {
        desc = "me_epirus_1_epirus.46.desc"
        first_valid = {
            triggered_desc = { # EPI
                trigger = { scope:me_epirus_scope.var:illyria_demands = 1 }
                desc = "me_epirus_1_epirus.46.desc_1"
            }
            triggered_desc = { # Other
                trigger = { scope:me_epirus_scope.var:illyria_demands = 2 }
                desc = "me_epirus_1_epirus.46.desc_2"
            }
            triggered_desc = { # Other
                trigger = { scope:me_epirus_scope.var:illyria_demands = 3 }
                desc = "me_epirus_1_epirus.46.desc_3"
            }
            triggered_desc = { # Other
                trigger = { scope:me_epirus_scope.var:illyria_demands < 1 }
                desc = "me_epirus_1_epirus.46.desc_4"
            }
        }
    }
    picture = greek_court
    left_portrait = current_ruler
    right_portrait = scope:me_epirus_scope.current_ruler
    right_portrait = scope:epirote_diplomat_scope

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
        exists = scope:me_epirus_scope
        scope:me_epirus_scope = {
            has_land = yes
            has_variable = illyria_demands
        }
    }  

    immediate = {
        if = {
            limit = { scope:me_epirus_scope.var:illyria_demands < 1 }
            add_opinion = { target = scope:me_epirus_scope modifier = me_epi_1_16_4_opmod }
        }
        else_if = {
            limit = { scope:me_epirus_scope.var:illyria_demands = 2 }
            add_opinion = { target = scope:me_epirus_scope modifier = me_epi_1_16_wounded_opmod }
        }
        else_if = {
            limit = { scope:me_epirus_scope.var:illyria_demands = 3 }
            add_opinion = { target = scope:me_epirus_scope modifier = me_epi_1_16_bad_opmod }
        }
        else_if = {
            limit = { scope:me_epirus_scope.var:illyria_demands = 4 }
            add_opinion = { target = scope:me_epirus_scope modifier = me_epi_1_16_grave_opmod }
        }
    }

    option = { #
        name = me_epirus_1_epirus.46.a
        if = {
            limit = { scope:me_epirus_scope.var:illyria_demands = 1 }
            show_as_tooltip = {
                scope:byllis_scope = { set_owned_by = scope:me_epirus_scope }
            }
        }
        else_if = {
            limit = { scope:me_epirus_scope.var:illyria_demands = 2 }
            custom_tooltip = me_epirus_1_epirus.46.at2
        }
        else_if = {
            limit = { scope:me_epirus_scope.var:illyria_demands = 3 }
            show_as_tooltip = {
                scope:me_epirus_scope = {
                    make_subject = {
                        target = root
                        type = vassal_tribe
                    }
                }
            }
        }
        ai_chance = {
            factor = 5
            modifier = {
                scope:me_epirus_scope.var:illyria_demands = 1
                factor = 2
            }
            modifier = {
                scope:me_epirus_scope.var:illyria_demands = 2
                factor = 0.75
            }
            modifier = {
                scope:me_epirus_scope.var:illyria_demands = 3
                factor = 0.25
            }
            modifier = {
                c:EPI = { is_ai = yes }
                factor = 99
            }
        }
    }

    option = { #
        name = me_epirus_1_epirus.46.b
        set_variable = illyria_rejection
        if = {
            limit = { scope:me_epirus_scope.var:illyria_demands = 1 }
            show_as_tooltip = {
                scope:byllis_scope = { add_claim = scope:me_epirus_scope }
            }
        }
        else_if = {
            limit = { scope:me_epirus_scope.var:illyria_demands = 2 }
            custom_tooltip = me_epirus_1_epirus.46.bt1
        }
        else_if = {
            limit = { scope:me_epirus_scope.var:illyria_demands = 3 }
            custom_tooltip = me_epirus_1_epirus.46.bt2
        }
        show_as_tooltip = {
            reverse_add_opinion = { target = scope:me_epirus_scope modifier = me_epi_1_16_demand_rejected }
        }
        ai_chance = {
            factor = 5
        }
    }

    after = {
        if = {
            limit = {
                scope:me_epirus_scope.var:illyria_demands > 0
            }
            scope:me_epirus_scope = {
                trigger_event = { id = me_epirus_1_epirus.7 }
            }
        }
    }
}