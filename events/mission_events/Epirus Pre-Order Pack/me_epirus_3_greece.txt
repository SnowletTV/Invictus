namespace = me_epirus_3_greece

me_epirus_3_greece.110 = {							# Start
    type = country_event
    title = me_epirus_3_greece.110.t
    desc = me_epirus_3_greece.110.desc
    picture = epirote_phalanx
    fire_only_once = yes

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    option = {
        name = me_epirus_3_greece.110.a
        add_country_modifier = {
            name = epirus_3_greece_cmod
            duration = 7300 # 20 years
        }
    }
}

me_epirus_3_greece.111 = {							# End
    type = country_event
    title = me_epirus_3_greece.111.t
    desc = me_epirus_3_greece.111.desc
    picture = pyrrhus

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    option = {
        name = me_epirus_3_greece.111.a
        custom_tooltip = me_epirus_3_greece.111.at
    }
}

me_epirus_3_greece.1 = {							# Liberate the Cities - End
    type = country_event
    title = me_epirus_3_greece.1.t
    desc = me_epirus_3_greece.1.desc
    picture = epirote_phalanx

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    immediate = {
        custom_tooltip = me_epirus_3_greece.1.tt
        hidden_effect = {
            if = {
                limit = {
                    any_country = {
                        capital_scope = {
                            is_in_region = greece_region
                            NOR = {
                                is_in_area = crete_area
                                is_in_area = aetolia_area
                                is_in_area = epirus_area
                            }
                        }
                        country_culture_group = hellenic
                        is_subject = yes
                        overlord = {
                            NOT = { alliance_with = scope:me_epirus_scope }
                        }
                    }
                }
                every_country = {
                    limit = {
                        capital_scope = {
                            is_in_region = greece_region
                            NOR = {
                                is_in_area = crete_area
                                is_in_area = aetolia_area
                                is_in_area = epirus_area
                            }
                        }
                        country_culture_group = hellenic
                        is_subject = yes
                        overlord = {
                            NOT = { alliance_with = scope:me_epirus_scope }
                        }
                    }
                    every_owned_province = { add_claim = root }
                }
            }
            if = {
                limit = {
                    region:greece_region = {
                        any_region_province = {
                            NOR = {
                                is_in_area = crete_area
                                is_in_area = aetolia_area
                                is_in_area = epirus_area
                            }
                            has_owner = yes
                            owner = {
                                OR = {
                                    tag = MAC
                                    tag = PRY
                                    tag = EGY
                                    tag = SEL
                                    tag = TRE
                                    NOT = { country_culture_group = hellenic }
                                }
                                NOT = { alliance_with = scope:me_epirus_scope }
                            }
                        }
                    }
                }
                region:greece_region = {
                    every_region_province = {
                        limit = {
                            NOR = {
                                is_in_area = crete_area
                                is_in_area = aetolia_area
                                is_in_area = epirus_area
                            }
                            has_owner = yes
                            owner = {
                                OR = {
                                    tag = MAC
                                    tag = PRY
                                    tag = EGY
                                    tag = SEL
                                    tag = TRE
                                    NOT = { country_culture_group = hellenic }
                                }
                                NOT = { alliance_with = scope:me_epirus_scope }
                            }
                        }
                        add_claim = root
                    }
                }
            }
        }
    }

    option = {
        name = me_epirus_3_greece.1.a
        custom_tooltip = epirus_3_greece_1_reward_tt
    }
}

me_epirus_3_greece.2 = {							# Expedient Allies - Start/Select
    type = country_event
    title = me_epirus_3_greece.2.t
    desc = me_epirus_3_greece.2.desc
    picture = greek_court
    left_portrait = current_ruler
    left_portrait = scope:epirote_diplomat_scope
    right_portrait = root.var:me_epi_3_2_aid_1.current_ruler
    right_portrait = root.var:me_epi_3_2_aid_2.current_ruler

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    immediate = {
        add_treasury = -25
        custom_tooltip = me_epirus_3_greece.2.tt
        me_epi_1_kineas_effect = yes
        hidden_effect = {
            ordered_in_list = {
                list = me_epi_3_2_list
                order_by = country_population
                max = 4
                check_range_bounds = no
                me_epi_3_2_ally_scope_effect = yes
            }
        }
    }

    option = {
        name = me_epirus_3_greece.2.a
        root.var:me_epi_3_2_aid_1 = { me_epi_3_2_ally_effect = yes }
        ai_chance = {
            factor = 8
            modifier = {
                root.var:me_epi_3_2_aid_1 = c:TRE
                factor = 4
            }
        }
    }

    option = {
        name = me_epirus_3_greece.2.b
        trigger = { has_variable = me_epi_3_2_aid_2 }
        root.var:me_epi_3_2_aid_2 = { me_epi_3_2_ally_effect = yes }
        ai_chance = {
            factor = 6
            modifier = {
                root.var:me_epi_3_2_aid_1 = c:TRE
                factor = 4
            }
        }
    }

    option = {
        name = me_epirus_3_greece.2.c
        trigger = { has_variable = me_epi_3_2_aid_3 }
        root.var:me_epi_3_2_aid_3 = { me_epi_3_2_ally_effect = yes }
        ai_chance = {
            factor = 4
            modifier = {
                root.var:me_epi_3_2_aid_1 = c:TRE
                factor = 4
            }
        }
    }

    option = {
        name = me_epirus_3_greece.2.d
        add_treasury = 25
        custom_tooltip = me_epirus_3_greece.2.dt
    }

    after = {
        remove_variable = me_epi_3_2_aid_1
        if = {
            limit = { has_variable = me_epi_3_2_aid_2 }
            remove_variable = me_epi_3_2_aid_2
        }
        if = {
            limit = { has_variable = me_epi_3_2_aid_3 }
            remove_variable = me_epi_3_2_aid_3
        }
    }
}

me_epirus_3_greece.3 = {							# Forced Service
    type = country_event
    title = me_epirus_3_greece.3.t
    desc = me_epirus_3_greece.3.desc
    picture = greek_home

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    immediate = {
        custom_tooltip = me_epirus_3_greece.3.tt
    }

    option = {
        name = me_epirus_3_greece.3.a
        add_political_influence = -50
        add_manpower = epirus_3_3_svalue
        add_country_modifier = {
            name = epirus_3_greece_3_cmod_1
            duration = 9125
        }
        if = {
            limit = {
                any_subject = {
                    NOR = {
                        is_subject_type = client_state
                        is_subject_type = tributary
                    }
                    country_culture_group = hellenic
                }
            }
            every_subject = {
                limit = {
                    NOR = {
                        is_subject_type = client_state
                        is_subject_type = tributary
                    }
                    country_culture_group = hellenic
                }
                add_country_modifier = {
                    name = epirus_3_greece_3_cmod
                    duration = 9125 # 25 years
                }
            }
        }
        every_country_state = {
            limit = {
                any_state_province = {
                    OR = {
                        is_in_region = greece_region
                        is_in_region = magna_graecia_region
                        NOR = { is_in_area = epirus_area }
                    }
                }
            }
            custom = epirus_3_greece_3_reward_tt_state
            add_state_modifier = {
                name = epirus_3_greece_3_smod
                duration = 9125 # 25 years
            }
        }
    }

    option = {
        name = me_epirus_3_greece.3.b
        add_political_influence = -50
        add_manpower = epirus_3_3_svalue
        add_country_modifier = {
            name = epirus_3_greece_3_cmod_2
            duration = 9125
        }
        if = {
            limit = {
                any_subject = {
                    NOR = {
                        is_subject_type = client_state
                        is_subject_type = tributary
                    }
                    country_culture_group = hellenic
                }
            }
            every_subject = {
                limit = {
                    NOR = {
                        is_subject_type = client_state
                        is_subject_type = tributary
                    }
                    country_culture_group = hellenic
                }
                add_country_modifier = {
                    name = epirus_3_greece_3_cmod
                    duration = 9125 # 25 years
                }
            }
        }
        every_country_state = {
            limit = {
                any_state_province = {
                    OR = {
                        is_in_region = greece_region
                        is_in_region = magna_graecia_region
                        NOR = { is_in_area = epirus_area }
                    }
                }
            }
            custom = epirus_3_greece_3_reward_tt_state
            add_state_modifier = {
                name = epirus_3_greece_3_smod
                duration = 9125 # 25 years
            }
        }
    }

    option = {
        name = me_epirus_3_greece.3.c
        custom_tooltip = me_epirus_3_greece.3.ct
    }
}

me_epirus_3_greece.4 = {							# Support Greek Claimant - End
    type = country_event
    title = me_epirus_3_greece.4.t
    desc = me_epirus_3_greece.4.desc
    picture = greek_court
    left_portrait = current_ruler
    right_portrait = root.var:me_epi_3_4_claimant_1
    right_portrait = root.var:me_epi_3_4_claimant_2
    right_portrait = root.var:me_epi_3_4_claimant_3
    goto_location = root.var:me_epi_3_4_claimant_1.capital_scope

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    immediate = {
        custom_tooltip = me_epirus_3_greece.4.tt
        hidden_effect = {
            every_country = {
                limit = {
                    NOT = { this = scope:me_epirus_scope }
                    capital_scope = { is_in_region = greece_region }
                    is_monarchy = yes
                    country_culture_group = hellenic
                    NOT = { tag = MAC }
                    NOR = {
                        alliance_with = root
                        is_subject_of = root
                    }
                }
                add_to_list = me_epi_3_4_list
            }
            ordered_in_list = {
                list = me_epi_3_4_list
                limit = {
                    NOT = {
                        capital_scope = { is_in_area = crete_area }
                    }
                }
                order_by = country_population
                max = 4
                check_range_bounds = no
                me_epi_3_4_claim_scope_effect = yes
                me_epi_3_4_claimant_finder_effect = yes
            }
            if = {
                limit = {
                    NAND = {
                        has_variable = me_epi_3_4_aid_1
                        has_variable = me_epi_3_4_aid_2
                        has_variable = me_epi_3_4_aid_3
                        has_variable = me_epi_3_4_aid_4
                    }
                }
                ordered_in_list = {
                    list = me_epi_3_4_list
                    order_by = country_population
                    max = 4
                    check_range_bounds = no
                    me_epi_3_4_claim_scope_effect = yes
                    me_epi_3_4_claimant_finder_effect = yes
                }
            }
        }
    }

    option = {
        name = me_epirus_3_greece.4.a
        trigger = { has_variable = me_epi_3_4_aid_1 }
        root.var:me_epi_3_4_claimant_1 = { me_epi_3_4_claimant_effect = yes }
    }

    option = {
        name = me_epirus_3_greece.4.b
        trigger = { has_variable = me_epi_3_4_claimant_2 }
        root.var:me_epi_3_4_claimant_2 = { me_epi_3_4_claimant_effect = yes }
    }

    option = {
        name = me_epirus_3_greece.4.c
        trigger = { has_variable = me_epi_3_4_claimant_3 }
        root.var:me_epi_3_4_claimant_3 = { me_epi_3_4_claimant_effect = yes }
    }

    option = {
        name = me_epirus_3_greece.4.d
        trigger = { has_variable = me_epi_3_4_claimant_4 }
        root.var:me_epi_3_4_claimant_4 = { me_epi_3_4_claimant_effect = yes }
    }

    after = {
        root.var:me_epi_3_4_claimant_1 = { me_epi_3_4_claimant_cull_effect = yes }
        if = {
            limit = { has_variable = me_epi_3_4_claimant_2 }
             root.var:me_epi_3_4_claimant_2 = { me_epi_3_4_claimant_cull_effect = yes }
        }
        if = {
            limit = { has_variable = me_epi_3_4_claimant_3 }
             root.var:me_epi_3_4_claimant_3 = { me_epi_3_4_claimant_cull_effect = yes }
        }
        if = {
            limit = { has_variable = me_epi_3_4_claimant_4 }
             root.var:me_epi_3_4_claimant_4 = { me_epi_3_4_claimant_cull_effect = yes }
        }
        remove_variable = me_epi_3_4_aid_1
        remove_variable = me_epi_3_4_claimant_1
        if = {
            limit = { has_variable = me_epi_3_4_aid_2 }
            remove_variable = me_epi_3_4_aid_2
            remove_variable = me_epi_3_4_claimant_2
        }
        if = {
            limit = { has_variable = me_epi_3_4_aid_3 }
            remove_variable = me_epi_3_4_aid_3
            remove_variable = me_epi_3_4_claimant_3
        }
        if = {
            limit = { has_variable = me_epi_3_4_aid_4 }
            remove_variable = me_epi_3_4_aid_4
            remove_variable = me_epi_3_4_claimant_4
        }
    }
}

me_epirus_3_greece.5 = {							# Greek Power Base - End
    type = country_event
    title = me_epirus_3_greece.5.t
    desc = me_epirus_3_greece.5.desc
    picture = greek_city

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    immediate = {
        add_treasury = -25
        custom_tooltip = me_epirus_3_greece.5.tt
    }

    option = {
        name = me_epirus_3_greece.5.a
        trigger = { owns = 426 }
        p:426 = { me_epi_3_5_effect = yes }
    }

    option = {
        name = me_epirus_3_greece.5.b
        trigger = { owns = 416 }
        p:416 = { me_epi_3_5_effect = yes }
    }

    option = {
        name = me_epirus_3_greece.5.c
        trigger = { owns = 418 }
        p:418 = { me_epi_3_5_effect = yes }
    }

    option = {
        name = me_epirus_3_greece.5.d
        trigger = { owns = 440 }
        p:440 = { me_epi_3_5_effect = yes }
    }

    option = {
        name = me_epirus_3_greece.5.e
        trigger = { owns = 427 }
        p:427 = { me_epi_3_5_effect = yes }
    }
}

me_epirus_3_greece.6 = {							# Argead Claim - End
    type = country_event
    title = me_epirus_3_greece.6.t
    desc = me_epirus_3_greece.6.desc
    picture = pyrrhus
    left_portrait = current_ruler
    right_portrait = c:MAC.current_ruler

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    immediate = {
        custom_tooltip = me_epirus_3_greece.6.tt
        custom_tooltip = epirus_3_greece_6_reward_tt
        hidden_effect = {
            me_epi_3_lists_effect = yes
            every_in_list = {
                list = me_epi_3_6_list
                add_claim = root
            }
            if = {
                limit = {
                    any_country = {
                        has_land = yes
                        primary_culture = macedonian
                    }
                }
                every_country = {
                    limit = {
                        has_land = yes
                        primary_culture = macedonian
                    }
                    add_opinion = { target = root modifier = epirus_3_greece_6_opmod }
                }
            }
        }
    }

    option = {
        name = me_epirus_3_greece.6.a
    }
}

me_epirus_3_greece.7 = {							# Alexander's Throne - End
    type = country_event
    title = me_epirus_3_greece.7.t
    desc = me_epirus_3_greece.7.desc
    picture = pyrrhus

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    immediate = {
        custom_tooltip = me_epirus_3_greece.7.tt
        monarchy_formable_government_change_effect = yes
        custom_tooltip = epirus_3_greece_7_reward_tt
        hidden_effect = {
            region:macedonia_region = { formable_region_province_effect = yes }
        }
        add_3_free_province_investments = yes
    }

    option = {
        name = me_epirus_3_greece.7.a
        change_country_name = "MACEDONIA_NAME"
        hidden_effect = {
            change_country_adjective = "MACEDONIA_ADJECTIVE"
            change_country_flag = EPI_MAC
            set_variable = epi_macedon_missions_unlocked
        }
        if = {
            limit = {
                p:379 = { is_capital = no }
            }
            set_capital = 379
            hidden_effect = {
                p:379.state = { set_state_capital = 379 }
            }
            capital_scope = { establish_city_effect = yes }
        }
        p:379 = {
            add_province_modifier = {
                name = epirus_3_greece_7_pmod
                duration = -1
            }
            capital_formable_medium_effect = yes
        }
    }

    option = {
        name = me_epirus_3_greece.7.b
        capital_scope = {
            establish_city_effect = yes
            add_province_modifier = {
                name = epirus_3_greece_7_pmod
                duration = -1
            }
            capital_formable_medium_effect = yes
        }
    }
}

me_epirus_3_greece.8 = {							# Thessalian Liberation - End
    type = country_event
    title = me_epirus_3_greece.8.t
    desc = me_epirus_3_greece.8.desc
    picture = greek_city
    left_portrait = current_ruler
    right_portrait = scope:epi_thessaly_scope.current_ruler
    goto_location = scope:epi_thessaly_scope.capital_scope

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    immediate = {
        custom_tooltip = me_epirus_3_greece.8.tt
        hidden_effect = {
            random_owned_province = {
                limit = { is_in_area = thessaly_area }
                create_country = {
                    name = {
                        name = THESSALY_NAME
                        adjective = THESSALY_ADJECTIVE
                    }
                    change_country_flag = THESSALY_FLAG
                    save_scope_as = epi_thessaly_scope
					if = {
						limit = {
							NOT = {
								primary_culture = thessalian
							}
						}
						set_primary_culture_cleanup_effect = {
							NEW_PRIMARY_CULTURE = thessalian
							MAKE_OLD_CULTURE_INTEGRATED = yes
						}
					}
                }
            }
            every_owned_province = {
                limit = { is_in_area = thessaly_area }
                set_owned_by = scope:epi_thessaly_scope
            }
            make_subject = {
                target = scope:epi_thessaly_scope
                type = feudatory
            }
            area:thessaly_area = {
                ordered_area_province = {
                    limit = {
                        OR = {
                            province_id = 394
                            province_id = 389
                            province_id = 390
                        }
                    }
                    order_by = total_population
                    save_scope_as = epi_thessaly_cap_scope
                }
            }
            scope:epi_thessaly_scope = { set_capital = scope:epi_thessaly_cap_scope }
            scope:epi_thessaly_scope = {
                add_manpower = 5
                add_treasury = 50
                add_opinion = {
                    target = root
                    modifier = opinion_liberated_us
                }
            }
        }
        custom_tooltip = epirus_3_greece_8_reward_tt
    }

    option = {
        name = me_epirus_3_greece.8.a
        add_country_modifier = {
            name = me_epi_3_4_cmod_2
            duration = -1
        }
        scope:epi_thessaly_scope = {
            add_country_modifier = {
                name = epirus_3_greece_4_cmod
                duration = 7300 # 20 years
            }
        }
    }
}

me_epirus_3_greece.10 = {							# Cult of Achilles - End
    type = country_event
    title = me_epirus_3_greece.10.t
    desc = me_epirus_3_greece.10.desc
    picture = greek_religious_rite

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    immediate = {
        set_variable = deity_unlocked_achilles
        custom_tooltip = me_epirus_3_greece.10.tt
    }

    option = {
        name = me_epirus_3_greece.10.a
        custom_tooltip = epirus_3_greece_10_reward_tt
        p:257 = {
            change_province_name = "Achilleion"
            set_province_deity = deity:omen_achilles
        }
        if = {
            limit = { has_dlc = "Magna Graecia" }
            treasure:treasure_tomb_of_achilles = { transfer_treasure_to_province = p:257 }
        }
        if = {
            limit = { p:257.free_building_slots > 0 }
            p:257 = { add_building_level = library_building }
        }
        if = {
            limit = {
                p:257 = {
                    any_pops_in_province = {
                        count >= 1
                        NOT = { pop_religion = root.religion }
                    }

                }
            }
            while = {
                count = 2
                p:257 = {
                    random_pops_in_province = {
                        limit = {
                            NOT = { pop_religion = root.religion }
                        }
                        set_pop_religion = root.religion
                    }
                }
            }
        }
    }
}

me_epirus_3_greece.11 = {							# Master of Greece - End
    type = country_event
    title = me_epirus_3_greece.11.t
    desc = me_epirus_3_greece.11.desc
    picture = greek_city

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    immediate = {
        custom_tooltip = me_epirus_3_greece.11.tt
        if = {
            limit = {
                region:greece_region = {
                    any_region_province = {
                        NOT = { owned_or_subject_owned = root }
                    }
                }
            }
            hidden_effect = {
                region:greece_region = {
                    every_region_province = {
                        limit = {
                            NOT = { owned_or_subject_owned = root }
                        }
                        add_claim = root
                    }
                }
            }
            custom_tooltip = epirus_3_greece_11_reward_tt
        }
        add_country_modifier = {
            name = epirus_3_greece_11_cmod
            duration = 9125 # 25 years
        }
    }

    option = {
        name = me_epirus_3_greece.11.a
        current_ruler = { add_nickname = "NICKNAME_ELEUTHERIOS" }
    }

    option = {
        name = me_epirus_3_greece.11.b
    }
}

me_epirus_3_greece.12 = {							# Aetolian Domination - End
    type = country_event
    title = me_epirus_3_greece.12.t
    desc = me_epirus_3_greece.12.desc
    picture = greek_siege

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    immediate = { custom_tooltip = me_epirus_3_greece.12.tt }

    option = {
        name = me_epirus_3_greece.12.a
        if = {
            limit = {
                area:aetolia_area = {
                    any_area_province = {
                        NOT = { owner = root }
                    }
                }
            }
            custom_tooltip = epirus_3_greece_12_reward_tt
            hidden_effect = {
                area:aetolia_area = {
                    every_area_province = {
                        limit = {
                            NOT = { owner = root }
                        }
                        add_claim = root
                    }
                }
            }
        }
        random_owned_province = {
            limit = { is_in_area = aetolia_area }
            state = {
                add_state_modifier = {
                    name = me_epi_3_12_smod
                    duration = 7300
                }
            }
        }
    }
}

me_epirus_3_greece.13 = {							# Tharrhypas Legacy - End
    type = country_event
    title = me_epirus_3_greece.13.t
    desc = me_epirus_3_greece.13.desc
    picture = greek_city_market

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    immediate = {
        custom_tooltip = me_epirus_3_greece.13.tt
    }

    option = {
        name = me_epirus_3_greece.13.a
        scope:me_3_13_scope = {
            add_province_modifier = {
                name = epirus_3_greece_13_pmod
                duration = -1
            }
        }
    }
}

me_epirus_3_greece.20 = {                           # Cult of Achilles - Start
    type = country_event
    title = me_epirus_3_greece.20.t
    desc = me_epirus_3_greece.20.desc
    picture = dodona

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    immediate = { add_treasury = -150 }

    option = {
        name = me_epirus_3_greece.20.a
        custom_tooltip = me_epirus_3_greece.20.at
    }
}

me_epirus_3_greece.21 = {                           # Cult of Achilles - Bypass
    type = country_event
    title = me_epirus_3_greece.21.t
    desc = me_epirus_3_greece.21.desc
    picture = greek_siege

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    immediate = { add_treasury = 75 }

    option = {
        name = me_epirus_3_greece.21.a
        custom_tooltip = me_epirus_3_greece.21.at
    }
}

me_epirus_3_greece.22 = {                           # Argead Claim - Start
    type = country_event
    title = me_epirus_3_greece.22.t
    desc = me_epirus_3_greece.22.desc
    picture = greek_siege

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    immediate = { add_legitimacy = -10 }

    option = {
        name = me_epirus_3_greece.22.a
        custom_tooltip = me_epirus_3_greece.22.at
    }
}

me_epirus_3_greece.23 = {                           # Liberate the Cities - Start
    type = country_event
    title = me_epirus_3_greece.23.t
    desc = me_epirus_3_greece.23.desc
    picture = greek_siege

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    option = {
        name = me_epirus_3_greece.23.a
        custom_tooltip = me_epirus_3_greece.23.at
    }
}

me_epirus_3_greece.24 = {                           # Liberate the Cities - Bypass
    type = country_event
    title = me_epirus_3_greece.24.t
    desc = me_epirus_3_greece.24.desc
    picture = greek_siege

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    option = {
        name = me_epirus_3_greece.24.a
        custom_tooltip = me_epirus_3_greece.24.at
    }
}

me_epirus_3_greece.25 = {                           # Expedient Allies - Offer
    type = country_event
    title = "me_epirus_3_greece.25.t"
    desc = me_epirus_3_greece.25.desc
    picture = successors
    left_portrait = current_ruler
    right_portrait = scope:me_epirus_scope.current_ruler
    right_portrait = scope:me_epi_3_2_enemy_scope.current_ruler
    goto_location = scope:me_epi_3_2_ally_scope.capital_scope

    trigger = {
        has_dlc = "Epirus Flavor Pack" # Has DLC?
        has_land = yes
        NOR = {
            alliance_with = scope:me_epi_3_2_enemy_scope
            war_with = scope:me_epi_3_2_enemy_scope
            alliance_with = scope:me_epirus_scope
            war_with = scope:me_epirus_scope
            is_subject = yes
        }
    }

    option = { # Accept
        name = "me_epirus_3_greece.25.a"
        show_as_tooltip = {
            add_alliance = scope:me_epirus_scope
            reverse_add_opinion = { target = scope:me_epirus_scope modifier = me_epi_3_2_accept_opmod }
        }
        ai_chance = { factor = 95 }
    }

    option = { # Refuse
        name = "me_epirus_3_greece.25.b"
        set_variable = me_epi_3_2_rejected_flag
        show_as_tooltip = {
            reverse_add_opinion = { target = scope:me_epirus_scope modifier = me_epi_3_2_reject_opmod }
        }
        ai_chance = { factor = 5 }
    }

    after = {
        scope:me_epirus_scope = {
            trigger_event = {
                id = me_epirus_3_greece.26
                days = 10
            }
        }
    }
}

me_epirus_3_greece.26 = {                           # Expedient Allies - Response
    type = country_event
    title = "me_epirus_3_greece.26.t"
    desc = {
        desc = me_epirus_3_greece.26.desc
        first_valid = {
            triggered_desc = { #
                trigger = {
                    NOT = {
                        scope:me_epi_3_2_ally_scope = { has_variable = me_epi_3_2_rejected_flag }
                    }
                }
                desc = "me_epirus_3_greece.26.desc_1"
            }
            triggered_desc = { #
                trigger = { always = yes }
                desc = "me_epirus_3_greece.26.desc_2"
            }
        }
    }
    picture = successors
    left_portrait = current_ruler
    left_portrait = scope:epirote_diplomat_scope
    right_portrait = scope:me_epi_3_2_ally_scope.current_ruler
    right_portrait = scope:me_epi_3_2_enemy_scope.current_ruler
    goto_location = scope:me_epi_3_2_ally_scope.capital_scope

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
        NOR = {
            alliance_with = scope:me_epi_3_2_enemy_scope
            war_with = scope:me_epi_3_2_enemy_scope
            alliance_with = scope:me_epi_3_2_ally_scope
            war_with = scope:me_epi_3_2_ally_scope
            is_subject = yes
        }
    }

    immediate = {
        if = {
            limit = {
                NOT = {
                    scope:me_epi_3_2_ally_scope = { has_variable = me_epi_3_2_rejected_flag }
                }
            }
            add_alliance = scope:me_epi_3_2_ally_scope
            reverse_add_opinion = { target = scope:me_epi_3_2_ally_scope modifier = me_epi_3_2_accept_opmod }
            hidden_effect = {
                add_opinion = { target = scope:me_epi_3_2_ally_scope modifier = me_epi_3_2_accept_opmod }
            }
            scope:me_epi_3_2_enemy_scope = {
                add_opinion = { target = root modifier = me_epi_3_2_target_opmod }
                add_opinion = { target = scope:me_epi_3_2_ally_scope modifier = me_epi_3_2_target_opmod }
                if = {
                    limit = { is_ai = no }
                    trigger_event = { id = me_epirus_3_greece.27 }
                }
            }
        }
        else = {
            add_opinion = { target = scope:me_epi_3_2_ally_scope modifier = me_epi_3_2_accept_opmod }
        }
    }

    option = { #
        name = "me_epirus_3_greece.26.a"
        trigger = {
            NOT = {
                scope:me_epi_3_2_ally_scope = { has_variable = me_epi_3_2_rejected_flag }
            }
        }
    }

    option = { #
        name = "me_epirus_3_greece.26.b"
        trigger = {
            scope:me_epi_3_2_ally_scope = { has_variable = me_epi_3_2_rejected_flag }
            any_neighbour_country = {
                primary_culture = macedonian
                num_of_cities >= 10
                any_neighbour_country = {
                    country_culture_group = hellenic
                    num_of_cities >= 10
                    is_tribal = no
                    NOT = { alliance_with = prev }
                    NOT = { has_variable = me_epi_3_2_rejected_flag }
                }
            }
        }
        custom_tooltip = me_epirus_3_greece.26.bt
        trigger_event = {
            id = me_epirus_3_greece.2
            days = 5
        }
        ai_chance = { factor = 10 }
    }

    option = { #
        name = "me_epirus_3_greece.26.c"
        trigger = {
            scope:me_epi_3_2_ally_scope = { has_variable = me_epi_3_2_rejected_flag }
        }
        custom_tooltip = me_epirus_3_greece.26.ct
        ai_chance = { factor = 1 }
    }
}

me_epirus_3_greece.27 = {                           # Expedient Allies - Target Ping
    type = country_event
    title = me_epirus_3_greece.27.t
    desc = me_epirus_3_greece.27.desc
    picture = greek_siege
    left_portrait = current_ruler
    right_portrait = scope:me_epirus_scope.current_ruler
    right_portrait = scope:me_epi_3_2_ally_scope.current_ruler

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    immediate = {
        show_as_tooltip = {
            add_opinion = { target = root modifier = me_epi_3_2_target_opmod }
            add_opinion = { target = scope:me_epi_3_2_ally_scope modifier = me_epi_3_2_target_opmod }
        }
    }

    option = { name = me_epirus_3_greece.27.a }
}

me_epirus_3_greece.28 = {                           # Support Greek Claimant - Start
    type = country_event
    title = me_epirus_3_greece.28.t
    desc = me_epirus_3_greece.28.desc
    picture = greek_court
    left_portrait = current_ruler

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    immediate = { add_political_influence = subtract_influence_large }

    option = {
        name = me_epirus_3_greece.28.a
        custom_tooltip = me_epirus_3_greece.28.at
    }
}

me_epirus_3_greece.29 = {                           # Support Greek Claimant - Employer ping
    type = country_event
    title = me_epirus_3_greece.29.t
    desc = {
        desc = me_epirus_3_greece.29.desc
        first_valid = {
            triggered_desc = { #
                trigger = {
                    scope:me_epi_3_4_claimant_scope = { is_close_relative = scope:me_epi_3_4_claimant_emp_scope.current_ruler }
                }
                desc = "me_epirus_3_greece.29.desc_1"
            }
            triggered_desc = { #
                trigger = {
                    scope:me_epi_3_4_claimant_scope.spouse = { is_close_relative = scope:me_epi_3_4_claimant_emp_scope.current_ruler }
                }
                desc = "me_epirus_3_greece.29.desc_2"
            }
            triggered_desc = { #
                trigger = { always = yes }
                desc = "me_epirus_3_greece.29.desc_3"
            }
        }
        desc = me_epirus_3_greece.29.desc_4
    }

    picture = greek_court
    left_portrait = current_ruler
    right_portrait = scope:me_epirus_scope.current_ruler
    right_portrait = scope:me_epi_3_4_claimant_scope

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    immediate = {
        show_as_tooltip = {
            scope:me_epi_3_4_claimant_scope = { move_country = scope:me_epirus_scope }
        }
        custom_tooltip = me_epirus_3_greece.29.at
        add_opinion = { target = scope:me_epirus_scope modifier = me_epi_3_4_claimant_opmod }
    }

    option = { name = me_epirus_3_greece.29.a }
}

me_epirus_3_greece.30 = {                           # Support Greek Claimant - Epi ping
    type = country_event
    title = me_epirus_3_greece.30.t
    desc = {
        desc = me_epirus_3_greece.30.desc
        first_valid = {
            triggered_desc = { #
                trigger = {
                    scope:me_epi_3_4_claimant_scope = { is_close_relative = scope:me_epi_3_4_claimant_emp_scope.current_ruler }
                }
                desc = "me_epirus_3_greece.29.desc_1"
            }
            triggered_desc = { #
                trigger = {
                    scope:me_epi_3_4_claimant_scope = { is_married = yes }
                    scope:me_epi_3_4_claimant_scope.spouse = { is_close_relative = scope:me_epi_3_4_claimant_emp_scope.current_ruler }
                }
                desc = "me_epirus_3_greece.29.desc_2"
            }
            triggered_desc = { #
                trigger = { always = yes }
                desc = "me_epirus_3_greece.29.desc_3"
            }
        }
        desc = me_epirus_3_greece.30.desc_1
    }
    picture = greek_court
    left_portrait = current_ruler
    left_portrait = scope:me_epi_3_4_claimant_scope
    right_portrait = scope:me_epi_3_4_claimant_emp_scope.current_ruler
    goto_location = scope:me_epi_3_4_claimant_emp_scope.capital_scope

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    immediate = {
        show_as_tooltip = {
            scope:me_epi_3_4_claimant_scope = { move_country = scope:me_epirus_scope }
        }
        custom_tooltip = me_epirus_3_greece.29.at
        hidden_effect = {
            scope:me_epi_3_4_claimant_emp_scope = {
                every_owned_province = { add_claim = root }
            }
        }
    }

    option = {
        name = me_epirus_3_greece.30.a
        reverse_add_opinion = { target = scope:me_epi_3_4_claimant_emp_scope modifier = me_epi_3_4_claimant_opmod }
        custom_tooltip = me_epirus_3_greece.30.at
    }
}

me_epirus_3_greece.31 = {                           # Support Greek Claimant - Char event
    type = character_event
    hidden = yes

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        is_alive = yes
    }

    immediate = {
        scope:me_epirus_scope = {
             set_variable = {
                name = epi_claimant
                value = root
            }
            set_variable = {
                name = epi_claimant_tag
                value = root.employer
            }
            set_variable = {
                name = epi_claimant_objective
                value = root.employer.capital_scope
            }
        }
        employer = {
            trigger_event = { id = me_epirus_3_greece.29 }
        }
        scope:me_epirus_scope = {
            trigger_event = { id = me_epirus_3_greece.30 }
        }
        hidden_effect = {
            move_country = scope:me_epirus_scope
            remove_character_modifier = foreign_citizen
        }
    }
}

me_epirus_3_greece.32 = {                           # Support Greek Claimant - Decision ping
    type = country_event
    title = me_epirus_3_greece.32.t
    desc = me_epirus_3_greece.32.desc
    picture = greek_court
    left_portrait = current_ruler
    right_portrait = scope:epi_claimant_new_country_ruler_scope
    goto_location = scope:epi_claimant_new_country_scope.capital_scope

    trigger = {
        has_dlc = "Epirus Flavor Pack"
        has_land = yes
    }

    immediate = {
        root.var:epi_claimant_objective = { save_scope_as = epi_claimant_new_capital_scope }
        root.var:epi_claimant = { save_scope_as = epi_claimant_new_country_ruler_scope }
        hidden_effect = {
            scope:epi_claimant_new_capital_scope = {
                create_country = {
                    set_as_ruler = root.var:epi_claimant
                    save_scope_as = epi_claimant_new_country_scope
                }
            }
            scope:epi_claimant_new_capital_scope.area = {
                every_area_province = {
                    limit = { owner = root }
                    set_owned_by = scope:epi_claimant_new_country_scope
                }
            }
            make_subject = {
                target = scope:epi_claimant_new_country_scope
                type = client_state
            }
            scope:epi_claimant_new_country_scope = {
                add_manpower = 5
                add_treasury = 50
                if = {
                    limit = { capital_scope = p:427 }
                    change_country_name = SPA
                    change_country_adjective = SPA_ADJ
                    change_country_color = spartan_brown
                    change_country_flag = SPA
                    change_country_tag = SPA
					if = {
						limit = {
							NOT = {
								primary_culture = peloponnesian
							}
						}
						set_primary_culture_cleanup_effect = {
							NEW_PRIMARY_CULTURE = peloponnesian
							MAKE_OLD_CULTURE_INTEGRATED = yes
						}
					}
                    set_country_heritage = spartan_heritage
                }
                add_opinion = {
                    target = root
                    modifier = opinion_liberated_us
                }
            }
        }
        custom_tooltip = me_epi_3_4_decision_tt
    }

    option = {
        name = me_epirus_3_greece.32.a
        scope:epi_claimant_new_country_scope = {
            add_country_modifier = {
                name = epirus_3_greece_4_cmod
                duration = 7300 # 20 years
            }
        }
    }

    after = {
        remove_variable = epi_claimant
        remove_variable = epi_claimant_tag
        remove_variable = epi_claimant_objective
        hidden_effect = {
            scope:epi_claimant_new_country_scope = { create_family = scope:epi_claimant_new_country_ruler_scope }
        }
    }
}