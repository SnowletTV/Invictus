namespace = me_bastarnia

me_bastarnia.1 = { # Start Migration Effect + Mission Event
    type = country_event

    title = me_bastarnia_1_title
    desc = me_bastarnia_1_desc
    picture = celtic_chiefs
    right_portrait = root.ruler

    immediate = {
        add_country_modifier = {
            name = "bastarnian_migration"
            duration = 180
        }
    }

    option = {
        name = "me_bastarnia_1.a"
        custom_tooltip = "me_bastarnia_1_tooltip"
    }
}

me_bastarnia.2 = { # Migrate to Black Sea Effect + Mission Event
    type = country_event

    title = me_bastarnia_2_title
    desc = me_bastarnia_2_desc
    picture = farming
    right_portrait = root.ruler

    immediate = {
        hidden_effect = {
            area:zargidava_area = { mission_area_claim_effect = yes }
            area:clepia_area = { mission_area_claim_effect = yes }
            area:getia_orientalis_area = { mission_area_claim_effect = yes }
            area:olbia_area = { mission_area_claim_effect = yes }
            area:scythia_area = { mission_area_claim_effect = yes }
        }
        custom_tooltip = barbaricum_bastarnia_claims_1_tt
    }

    option = {
        name = "me_bastarnia_2.a"
        custom_tooltip = "me_bastarnia_2_tooltip"
        add_country_modifier = {
            name = "bastarnia_new_home"
            duration = 1800
        }
    }
}

me_bastarnia.3 = { # Danube Delta Effect + Mission Event
    type = country_event

    title = me_bastarnia_3_title
    desc = me_bastarnia_3_desc
    picture = celtic_village
    right_portrait = root.ruler

    immediate = {
        add_military_experience = 20
    }

    option = {
        name = "me_bastarnia_3.a"
        custom_tooltip = "me_bastarnia_3_tooltip"
    }
}

me_bastarnia.4 = { # Ally Makedonia Effect - saves Macedonia as scope, and triggers mission event 
    type = country_event
    hidden = yes

    immediate = {
        random_country = {
            limit = {
                AND = {
                    alliance_with = root
                    OR = {
                        tag = MAC
                        tag = MCD
                    }
                }
            }
            save_scope_as = macedonia_tag_bastarnia_ally
        }
        trigger_event = { id = me_bastarnia.11 }
    }
}

me_bastarnia.5 = { # Raid on Olbia Effect + Mission Event
    type = country_event

    title = me_bastarnia_5_title
    desc = me_bastarnia_5_desc
    picture = greek_siege
    right_portrait = root.ruler

    immediate = {
        custom_tooltip = barbaricum_bastarnia_claims_2_tt
        hidden_effect = { 
           area:borysthenia_minor_area = { mission_area_claim_effect = yes }
           area:maeotia_area = { mission_area_claim_effect = yes }
           area:taurica_area = { mission_area_claim_effect = yes }
        }
    }

    option = {
        name = "me_bastarnia_5.a"
        custom_tooltip = "me_bastarnia_5_tooltip"
        p:4529 = {
            while = {
                count = 4
                random_pops_in_province = {
                    kill_pop = yes
                }
            }
        }
        add_treasury = 30
    }
}

me_bastarnia.6 = { # Sea of Azov Effect + Mission Event
    type = country_event

    title = me_bastarnia_6_title
    desc = me_bastarnia_6_desc
    picture = trade_port
    right_portrait = root.ruler

    immediate = {
        add_country_modifier = {
            name = "black_sea_scourge"
            duration = -1
        }
    }

    option = {
        name = "me_bastarnia_6.a"
        custom_tooltip = "me_bastarnia_6_tooltip"
    }
}

me_bastarnia.7 = { # Defend new home + Mission Event
    type = country_event

    title = me_bastarnia_7_title
    desc = me_bastarnia_7_desc
    picture = interesting_histories_celt_city
    right_portrait = root.ruler

    option = {
        name = "me_bastarnia_7.a"
        custom_tooltip = "me_bastarnia_7_tooltip"
        add_country_modifier = {
            name = "bastarnian_defense"
            duration = 7300
        }
    }
}

me_bastarnia.8 = { # Alliance of the crown-shaped neckrings Effect + Mission Event
    type = country_event

    title = me_bastarnia_8_title
    desc = me_bastarnia_8_desc
    picture = celtic_diplomacy
    right_portrait = root.ruler

    immediate = {
        add_country_modifier = {
            name = "crown_shaped_neckrings"
            duration = -1
        }
    }

    option = {
        name = "me_bastarnia_8_a"
        custom_tooltip = "me_bastarnia_8_tooltip"
        change_government = tribal_federation
    }
}

me_bastarnia.9 = { # Moesian settlement Effect + Mission Event
    type = country_event

    title = me_bastarnia_9_title
    desc = {
        first_valid = {
            triggered_desc = { #Has alliance and marriage to macedonians
                trigger = { 
                    AND = {
                        has_completed_mission_task = barbaricum_bastarnia_mission_task_4
                        OR = {
                            alliance_with = c:MAC
                            alliance_with = c:MCD
                        }   
                    }
                }
                desc = me_bastarnia_9_desc_1
            }
            triggered_desc = { # Normal Desc
                trigger = { 
                    NOT = {
                        AND = {
                            has_completed_mission_task = barbaricum_bastarnia_mission_task_4
                            OR = {
                                alliance_with = c:MAC
                                alliance_with = c:MCD
                            }   
                        }
                    }
                }
                desc = me_bastarnia_9_desc_2
            }
        }
    }
    picture = interesting_histories_celt_hills
    right_portrait = root.ruler

    immediate = {
        hidden_effect = {
            random_owned_province = {
                limit = {
                    OR = {
                        is_in_area = moesia_orientalis_area
                        is_in_area = moesia_occidentalis_area
                    }
                }
                save_scope_as = bstrn_moesian_migration_p_destination
            }
        }
        custom_tooltip = "me_bastarnia_9_migration_tooltip" #Migration of 4 pops
        hidden_effect = {
            random_owned_province = {
                limit = {
                    any_pops_in_province = {
                        count >= 1
                        pop_culture = root.culture
                    }
                }
                random_pops_in_province = {
                    limit = {
                        pop_culture = root.culture
                    }
                    move_pop = scope:bstrn_moesian_migration_p_destination
                }
            }
            random_owned_province = {
                limit = {
                    any_pops_in_province = {
                        count >= 1
                        pop_culture = root.culture
                    }
                }
                random_pops_in_province = {
                    limit = {
                        pop_culture = root.culture
                    }
                    move_pop = scope:bstrn_moesian_migration_p_destination
                }
            }
            random_owned_province = {
                limit = {
                    any_pops_in_province = {
                        count >= 1
                        pop_culture = root.culture
                    }
                }
                random_pops_in_province = {
                    limit = {
                        pop_culture = root.culture
                    }
                    move_pop = scope:bstrn_moesian_migration_p_destination
                }
            }
            random_owned_province = {
                limit = {
                    any_pops_in_province = {
                        count >= 1
                        pop_culture = root.culture
                    }
                }
                random_pops_in_province = {
                    limit = {
                        pop_culture = root.culture
                    }
                    move_pop = scope:bstrn_moesian_migration_p_destination
                }
            }
            scope:bstrn_moesian_migration_p_destination = {
                create_state_pop = tribesmen
                create_state_pop = tribesmen
            }
        }
    }

    option = { #Pops settle in a moesian territory
        name = "me_bastarnia_9_a"
        custom_tooltip = "me_bastarnia_9_tooltip"
    }

    option = { #Pops settle in a moesian territory + Option to make it a new capital
        name = "me_bastarnia_9_b"
        custom_tooltip = "me_bastarnia_9_tooltip"
        set_capital = scope:bstrn_moesian_migration_p_destination
        scope:bstrn_moesian_migration_p_destination = {
            add_province_modifier = {
                name = thriving_capital
                duration = 365
            }
        }
    }
}

me_bastarnia.10 = { # Relations to old home Effect + Mission Event
    type = country_event

    title = me_bastarnia_10_title
    desc = me_bastarnia_10_desc
    picture = celtic_diplomacy
    right_portrait = root.ruler
    left_portrait = scope:vandal_country_trading_with_bastarnia.ruler

    immediate = {
        add_stability = 5
        random_country = {
            limit = {
                AND = {
                    OR = {
                        primary_culture = bastarnae
                        primary_culture = vandal
                    }
                    OR = {
                        exports_to = root
                        imports_from = root
                    }
                }
            }
            root.ruler = {
                save_scope_as = vandal_country_trading_with_bastarnia
            }
        }
    }

    option = {
        name = "me_bastarnia_10_a"
        custom_tooltip = "me_bastarnia_10_tooltip"
    }
}

me_bastarnia.11 = { # Alliance with the Macedonians
    type = country_event

    title = me_bastarnia_11_title
    desc = me_bastarnia_11_desc
    picture = celtic_diplomacy
    right_portrait = root.ruler
    left_portrait = scope:macedonia_tag_bastarnia_ally.ruler

    immediate = {
        hidden_effect = { 
           area:moesia_orientalis_area = { mission_area_claim_effect = yes }
           area:moesia_occidentalis_area = { mission_area_claim_effect = yes }
           area:dacia_superioris_area = { mission_area_claim_effect = yes }
           area:dacia_inferioris_area = { mission_area_claim_effect = yes }
        }
        custom_tooltip = "barbaricum_bastarnia_claims_4_tt"
        save_scope_as = bastarnia_country
    }

    option = {
        name = "me_bastarnia_11_a" #What a powerfull partner we have gained!
        custom_tooltip = "me_bastarnia_11_tooltip"
    }

    option = {
        name = "me_bastarnia_11_b" #Let us solidify our alliance through blood! 
        custom_tooltip = "me_bastarnia_11_b_tooltip" #We will send a marriage proposal to the Macedonians
        trigger = {
            AND = {
                OR = {
                    root.ruler = {#Checking if the ruler is male and available for marriage
                        AND = {
                            is_male = yes
                            is_married = no
                        }
                    }
                    AND = {#Checking if any children are male and available for marriage
                        NOT = {
                            root.ruler = {
                                AND = {
                                    is_male = yes
                                    is_married = no
                                }
                            }
                        }
                    }
                    any_character = {
                        count >= 1
                        is_male = yes
                        is_married = no
                        father = {
                            is_ruler = yes
                        }
                    }
                }
            }
            scope:macedonia_tag_bastarnia_ally = { #Checking if the ruler of Makedon has a daughter/nice available for marriage
                any_character = {
                    count >= 1
                    age <= 38 
                    age >= 16
                    is_male = no
                    is_married = no
                    OR = {
                        father = {
                            OR = {
                                is_ruler = yes
                                any_sibling = {
                                    is_ruler = yes
                                }
                            }
                        }
                        mother = {
                            OR = {
                                is_ruler = yes
                                any_sibling = {
                                    is_ruler = yes
                                }
                            }
                        }
                    }
                }
            }
        }
        hidden_effect = {#saving scopes for suitors
            set_variable = bastarnia_rulers_selected_as_suitor
            if = {
                limit = {
                    AND = {#Checking if any children are male and available for marriage
                        NOT = {
                            root.ruler = {
                                AND = {
                                    is_male = yes
                                    is_married = no
                                }
                            }
                        }
                        any_character = {
                            count >= 1
                            is_male = yes
                            is_married = no
                            father = {
                                is_ruler = yes
                            }
                        }
                    }
                }
                random_character = {#Selecting son for marriage
                    limit = {
                        is_male = yes
                        is_married = no
                        father = {
                            is_ruler = yes
                        }
                    }
                    save_scope_as = bastarnae_son_selected_for_marriage
                }
                remove_variable = bastarnia_ruler_selected_as_suitor
                set_variable = bastarnia_rulers_son_selected_as_suitor
            }
            scope:macedonia_tag_bastarnia_ally = { #Checking if the ruler of Makedon has a daughter/nice available for marriage
                random_character = { #First pick
                    limit = {
                        age <= 38 
                        age >= 16
                        is_male = no
                        is_married = no
                        OR = {
                            father = {
                                OR = {
                                    is_ruler = yes
                                    any_sibling = {
                                        is_ruler = yes
                                    }
                                }
                            }
                            mother = {
                                OR = {
                                    is_ruler = yes
                                    any_sibling = {
                                        is_ruler = yes
                                    }
                                }
                            }
                        }
                    }
                    save_scope_as = bst_macedorian_princess_1    
                }
                set_variable = bastarnia_1_macedonian_princess
                if = { #Checking if any princesses are left
                    limit = {
                        any_character = {
                            count >= 1
                            age <= 38 
                            age >= 16 
                            is_male = no
                            is_married = no
                            NOT = {
                                this = scope:bst_macedorian_princess_1
                            }
                            OR = {
                                father = {
                                    OR = {
                                        is_ruler = yes
                                        any_sibling = {
                                            is_ruler = yes
                                        }
                                    }
                                }
                                mother = {
                                    OR = {
                                        is_ruler = yes
                                        any_sibling = {
                                            is_ruler = yes
                                        }
                                    }
                                }
                            }
                        }
                    }
                    random_character = { #Second pick
                        limit = {
                            age <= 38 
                            age >= 16 
                            is_male = no
                            is_married = no
                            OR = {
                                father = {
                                    OR = {
                                        is_ruler = yes
                                        any_sibling = {
                                            is_ruler = yes
                                        }
                                    }
                                }
                                mother = {
                                    OR = {
                                        is_ruler = yes
                                        any_sibling = {
                                            is_ruler = yes
                                        }
                                    }
                                }
                            }
                        }
                        save_scope_as = bst_macedorian_princess_2    
                    }
                    remove_variable = bastarnia_1_macedonian_princess
                    set_variable = bastarnia_2_macedonian_princesses
                }
                if = { #Checking if any princesses are left
                    limit = {
                        any_character = {
                            count >= 1
                            age <= 38 
                            age >= 16
                            is_male = no
                            is_married = no
                            NOR = {
                                this = scope:bst_macedorian_princess_1
                                this = scope:bst_macedorian_princess_2
                            }
                            OR = {
                                father = {
                                    OR = {
                                        is_ruler = yes
                                        any_sibling = {
                                            is_ruler = yes
                                        }
                                    }
                                }
                                mother = {
                                    OR = {
                                        is_ruler = yes
                                        any_sibling = {
                                            is_ruler = yes
                                        }
                                    }
                                }
                            }
                        }
                    }
                    random_character = { #Third pick
                        limit = {
                            age <= 38 
                            age >= 16
                            is_male = no
                            is_married = no
                            OR = {
                                father = {
                                    OR = {
                                        is_ruler = yes
                                        any_sibling = {
                                            is_ruler = yes
                                        }
                                    }
                                }
                                mother = {
                                    OR = {
                                        is_ruler = yes
                                        any_sibling = {
                                            is_ruler = yes
                                        }
                                    }
                                }
                            }
                        }
                        save_scope_as = bst_macedorian_princess_3    
                    }
                    remove_variable = bastarnia_2_macedonian_princesses
                    set_variable = bastarnia_3_macedonian_princesses
                }
            }
        }
        trigger_event = { id = me_bastarnia.12 } 
    }
}

me_bastarnia.12 = { # A Proposal of Marriage
    type = country_event

    title = me_bastarnia_12_title
    desc = {
        first_valid = {
            triggered_desc = { #Ruler intends to marry
                trigger = { 
                    has_variable = bastarnia_ruler_selected_as_suitor
                }
                desc = me_bastarnia_12_desc_1
            }
            triggered_desc = { #Ruler intends son to marry
                trigger = { 
                    has_variable = bastarnia_rulers_son_selected_as_suitor
                }
                desc = me_bastarnia_12_desc_2
            }
        }
    }
    picture = trial_govtype
    right_portrait = root.ruler
    left_portrait = scope:bst_macedorian_princess_1
    right_portrait = scope:bst_macedorian_princess_2
    left_portrait = scope:bst_macedorian_princess_3

    immediate = {
        if = {
            root = {
                has_variable = bastarnia_ruler_selected_as_suitor
            } 
            root.ruler = {
                save_scope_as = bastarnian_royal_who_will_marry
            }
        }
        else = {
            scope:bastarnae_son_selected_for_marriage = {
                save_scope_as = bastarnian_royal_who_will_marry
            }
        }
        save_scope_as = bastarnian_country
    }


    option = {
        name = "me_bastarnia_12_a" #Let us propose a marriage with _____.
        scope:bst_macedorian_princess_1 = {
            save_scope_as = bst_macedonian_princess_chosen_for_proposal
        }
        scope:macedonia_tag_bastarnia_ally = {
            trigger_event = { id = me_bastarnia.13 }
        }
        custom_tooltip = "me_bastarnia_12_a_tooltip"
    }

    option = {
        name = "me_bastarnia_12_b" #_______ would be a more suitable match!
        trigger = {
            scope:macedonia_tag_bastarnia_ally = {
                has_variable = bastarnia_2_macedonian_princesses
            }
        }
        scope:bst_macedorian_princess_2 = {
            save_scope_as = bst_macedonian_princess_chosen_for_proposal
        }
        scope:macedonia_tag_bastarnia_ally = {
            trigger_event = { id = me_bastarnia.13 }
        }
        custom_tooltip = "me_bastarnia_12_b_tooltip"
    }

    option = {
        name = "me_bastarnia_12_c" #Princess ______________ is considered most fair
        trigger = {
            scope:macedonia_tag_bastarnia_ally = {
                has_variable = bastarnia_3_macedonian_princesses
            }
        }
        scope:bst_macedorian_princess_3 = {
            save_scope_as = bst_macedonian_princess_chosen_for_proposal
        }
        scope:macedonia_tag_bastarnia_ally = {
            trigger_event = { id = me_bastarnia.13 }
        }
        custom_tooltip = "me_bastarnia_12_c_tooltip"
    }
}

me_bastarnia.13 = { # The Bastarnae ask for a Macedonian bride
    type = country_event

    title = me_bastarnia_13_title
    desc = {
        first_valid = {
            triggered_desc = { #Ruler intends to marry
                trigger = { 
                    scope:bastarnian_country = {
                        has_variable = bastarnia_ruler_selected_as_suitor
                    }
                }
                desc = me_bastarnia_13_desc_1
            }
            triggered_desc = { #Ruler intends son to marry
                trigger = { 
                    scope:bastarnian_country = {
                        has_variable = bastarnia_rulers_son_selected_as_suitor
                    }
                }
                desc = me_bastarnia_13_desc_2
            }
        }
    }
    picture = throneroom
    right_portrait = root.ruler
    left_portrait = scope:bastarnian_royal_who_will_marry

    option = {
        name = "me_bastarnia_13_a" #Of course our ties should be made blood-deep!
        custom_tooltip = "me_bastarnia_13_marriage_tooltip" #We will agree to send [SCOPE.sCharacter('bst_macedorian_princess_3').GetName] off to [SCOPE.sC('bastarnian_country').GetName]
        hidden_effect = {
            scope:bst_macedonian_princess_chosen_for_proposal = {
                move_country = scope:bastarnian_country
                divorce_character = spouse
            }
        }
        scope:bastarnian_country = {
            trigger_event = { id = me_bastarnia.14 }
        }
    }

    option = {
        name = "me_bastarnia_13_b" #I cannot have a Macedonian princess relegated to such a place!
        custom_tooltip = "me_bastarnia_13_b_tooltip"
        scope:bastarnian_country = {
            trigger_event = { id = me_bastarnia.15 }
        }
    }
}

me_bastarnia.14 = { # A Royal Wedding
    type = country_event

    title = me_bastarnia_14_title
    desc = {
        first_valid = {
            triggered_desc = { #Ruler intends to marry
                trigger = { 
                    scope:bastarnian_country = {
                        has_variable = bastarnia_ruler_selected_as_suitor
                    }
                }
                desc = me_bastarnia_14_desc_1
            }
            triggered_desc = { #Ruler intends son to marry
                trigger = { 
                    scope:bastarnian_country = {
                        has_variable = bastarnia_rulers_son_selected_as_suitor
                    }
                }
                desc = me_bastarnia_14_desc_2
            }
        }
    }
    picture = celtic_religious_festival
    right_portrait = scope:bastarnian_royal_who_will_marry
    left_portrait = scope:bst_macedonian_princess_chosen_for_proposal

    immediate = {
        custom_tooltip = {
            scope:bst_macedonian_princess_chosen_for_proposal = {
                move_country = scope:bastarnian_country
            }
        }
        if = { #Make sure that royal is still single
            limit = {
                AND = {
                    scope:bastarnian_country = {
                        has_variable = bastarnia_rulers_son_selected_as_suitor
                    }
                    is_married = yes
                }
            }
            scope:bastarnae_son_selected_for_marriage = {
                divorce_character = spouse
            }
        }
        else_if = {
            limit = {
                AND = {
                    scope:bastarnian_country = {
                        has_variable = bastarnia_ruler_selected_as_suitor
                    }
                    root.ruler = {
                        is_married = yes
                    }
                }
            }
            root.ruler = {
                divorce_character = spouse
            }
        }
    }

    option = {
        name = "me_bastarnia_14_a" #Our ties to the Macedonians are ever stronger!
        trigger = {
            scope:bastarnian_country = {
                has_variable = bastarnia_ruler_selected_as_suitor
            }
        }
        root.ruler = {
            marry_character = scope:bst_macedonian_princess_chosen_for_proposal
        }
        custom_tooltip = "me_bastarnia_11_tooltip"#Mission completion
    }

    option = {
        name = "me_bastarnia_14_b" #Our ties to the Macedonians are ever stronger!
        trigger = {
            scope:bastarnian_country = {
                has_variable = bastarnia_rulers_son_selected_as_suitor
            }
        }
        scope:bastarnae_son_selected_for_marriage = {
            marry_character = scope:bst_macedonian_princess_chosen_for_proposal
        }
        custom_tooltip = "me_bastarnia_11_tooltip"#Mission completion
    }
}

me_bastarnia.15 = { # The Macedonians reject our proposal
    type = country_event

    title = me_bastarnia_15_title
    desc = me_bastarnia_15_desc #Though it would have made our ties far stronger, it seems as though the ____ of Macedon is unwilling to part with his dear kin for our sake. With mutual protection as our current priority, this is no great setback in our policy, however it is a small blow to our relations. 
    picture = trial_govtype

    immediate = {
        custom_tooltip = "me_bastarnia_15_tt"#
    }

    option = {
        name = "me_bastarnia_15_a" # A great pity.
        custom_tooltip = "me_bastarnia_11_tooltip"#Mission completion
    }
}