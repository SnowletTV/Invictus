namespace = ionian_resurgence_event

ionian_resurgence_event.1 = {
    type = country_event
    title = ionian_resurgence_event.1.t
    desc = ionian_resurgence_event.1.desc
    picture = greek_home

    left_portrait = current_ruler

    option = { # become pan-ionian league
        name = ionian_resurgence_event.1.a
        custom_tooltip = "tier_2_formable_tooltip"
        change_country_name = "IOU_FORMABLE_NAME"  
        hidden_effect = {
            change_country_adjective = "IOU_FORMABLE_ADJ"	
            change_country_color =  "ionian_league_color"			
            change_country_tag = IOU
            change_country_flag = PANIONIAN_LEAGUE_FLAG				
        }
        capital_scope = {
            capital_formable_medium_effect = yes
            formable_capital_modifier_normal_effect = yes
        }
        add_3_free_province_investments = yes
        custom_tooltip = "form_ionian_league_claims_tooltip"	
        hidden_effect = {
            area:ionia_area = {
                add_provincial_claim_effect = yes
            }
            area:aeolia_area = {
                add_provincial_claim_effect = yes
            }
            area:coastal_caria_area = {
                add_provincial_claim_effect = yes
            }
            area:mysia_area = {
                add_provincial_claim_effect = yes
            }
            area:sporades_area = {
                add_provincial_claim_effect = yes
            }
        }
        custom_tooltip = ionia_league_formation_tt
        remove_variable = ionian_rebel_var
        every_country = {
            limit = {
                has_variable = ionian_rebel_var
            }
            trigger_event = ionian_resurgence_event.19
        }
    }

    option = { # keep your local identity
        name = ionian_resurgence_event.1.b
        add_political_influence = 50
        if = {
            limit = {
                tag = MLO # Miletos
            }
            custom_tooltip = disallow_paniona_new_tree
            set_variable = disallow_paniona_var
        }
    }
}

ionian_resurgence_event.2 = {
    type = country_event
    title = ionian_resurgence_event.2.t
    desc = ionian_resurgence_event.2.desc
    picture = greek_home

    left_portrait = current_ruler

    option = { 
        name = ionian_resurgence_event.2.a
        add_political_influence = -50
        add_country_modifier = {
            name = ionian_resurgence_cmod
            duration = -1
        }
        custom_tooltip = ionia_formable_event_tt
        trigger_event = ionian_resurgence_event.1
    }
}

ionian_resurgence_event.3 = {
    type = country_event
    title = ionian_resurgence_event.3.t
    desc = ionian_resurgence_event.3.desc
    picture = greek_home

    left_portrait = current_ruler

    option = { 
        name = ionian_resurgence_event.3.a
        add_political_influence = -25
        add_country_modifier = {
            name = rallying_cmod
            duration = 3650
        }
    }
}

ionian_resurgence_event.4 = { # reaching out small event chain
    type = country_event
    title = ionian_resurgence_event.4.t
    desc = ionian_resurgence_event.4.desc
    picture = greek_home

    left_portrait = current_ruler
    right_portrait = overlord.current_ruler

    option = { # yes
        name = ionian_resurgence_event.4.a
        custom_tooltip = ionian_rebellion_added_tt
        set_variable = ionian_rebel_var
        random_country = {
            limit = {
                has_variable = ionian_rebel_leader
            }
            trigger_event = ionian_resurgence_event.5
        }
    }

    option = { # no
        name = ionian_resurgence_event.4.b
        random_country = {
            limit = {
                has_variable = ionian_rebel_leader
            }
            trigger_event = ionian_resurgence_event.6
        }
    }
}

ionian_resurgence_event.5 = { # yes
    type = country_event
    title = ionian_resurgence_event.5.t
    desc = ionian_resurgence_event.5.desc
    picture = greek_home

    left_portrait = current_ruler
    right_portrait = overlord.current_ruler

    option = { 
        name = ionian_resurgence_event.5.a
    }
}

ionian_resurgence_event.6 = { # no
    type = country_event
    title = ionian_resurgence_event.6.t
    desc = ionian_resurgence_event.6.desc
    picture = greek_home

    left_portrait = current_ruler
    right_portrait = overlord.current_ruler

    option = { 
        name = ionian_resurgence_event.6.a
    }
}

ionian_resurgence_event.7 = { # 
    type = country_event
    title = ionian_resurgence_event.7.t
    desc = ionian_resurgence_event.7.desc
    picture = greek_home

    left_portrait = current_ruler

    option = { 
        name = ionian_resurgence_event.7.a
        if = {
            limit = {
                any_character = {
                    is_mercenary = yes
                }
            }
            add_country_modifier = {
                name = ionia_mercs
                duration = 3650
            }
        }
        else_if = {
            limit = {
                any_country_sub_unit = {
                    count >= 10
                    is_cohort = yes
                }
            }
            add_country_modifier = {
                name = ionia_muster_troops
                duration = 3650
            }
        }
        else = {
            add_treasury = 100
        }
    }
}

ionian_resurgence_event.8 = { # 
    type = country_event
    title = ionian_resurgence_event.8.t
    desc = ionian_resurgence_event.8.desc
    picture = greek_home

    left_portrait = current_ruler
    right_portrait = scope:ionian_rebel_leader_scope.current_ruler

    immediate = {
        random_subject = {
            limit = {
                has_variable = ionian_rebel_leader
            }
            save_scope_as = ionian_rebel_leader_scope
        }
    }

    option = { # 
        name = ionian_resurgence_event.8.a
        every_subject = {
            limit = {
                has_variable = ionian_rebel_var
            }
            overlord = {
                release_subject = PREV
            }
        }
    }

    option = { # war
        name = ionian_resurgence_event.8.b
        scope:ionian_rebel_leader_scope = {
            every_current_war = {
                remove_from_war = this
            }
        }
        declare_war_with_wargoal = {
            war_goal = independence_wargoal
            province = scope:ionian_rebel_leader_scope.capital_scope
            target = scope:ionian_rebel_leader_scope
        }
        every_current_war = {
			limit = {
				any_war_defender = {
					this = scope:ionian_rebel_leader_scope
				}
			}
            save_scope_as = ionia_war_scope
		}
        every_country = {
            limit = { has_variable = ionian_rebel_var }
            every_current_war = {
                remove_from_war = this
            }
            add_to_war = {
                target = scope:ionia_war_scope
                attacker = no
                leader = no
            }
        }
    }
}

ionian_resurgence_event.9 = { 
    type = country_event
    title = ionian_resurgence_event.9.t
    desc = ionian_resurgence_event.9.desc
    picture = greek_home

    left_portrait = current_ruler

    option = { # help
        name = ionian_resurgence_event.9.a
        random_country = {
            limit = {
                has_variable = ionia_rhodos_target_var
            }
            trigger_event = ionian_resurgence_event.11
        }
        add_manpower = -1
        add_military_experience = -5
        add_political_influence = 50
    }

    option = { # don't help
        name = ionian_resurgence_event.9.b
        random_country = {
            limit = {
                has_variable = ionia_rhodos_target_var
            }
            trigger_event = ionian_resurgence_event.12
        }
    }
}

ionian_resurgence_event.10 = { 
    type = country_event
    title = ionian_resurgence_event.10.t
    desc = ionian_resurgence_event.10.desc
    picture = greek_home

    left_portrait = current_ruler

    option = { 
        name = ionian_resurgence_event.10.a
        add_military_experience = -25
        add_country_modifier = {
            name = wartime_inventions_ionia
            duration = -1
        }
    }
}

ionian_resurgence_event.11 = { 
    type = country_event
    title = ionian_resurgence_event.11.t
    desc = ionian_resurgence_event.11.desc
    picture = greek_home

    left_portrait = current_ruler

    option = { 
        name = ionian_resurgence_event.11.a
        # yes, the rewards magically double
        add_manpower = 2
        add_military_experience = 10
        add_innovation = 1
    }
}

ionian_resurgence_event.12 = { 
    type = country_event
    title = ionian_resurgence_event.12.t
    desc = ionian_resurgence_event.12.desc
    picture = greek_home

    left_portrait = current_ruler

    option = { 
        name = ionian_resurgence_event.12.a
        add_political_influence = 25
    }
}

ionian_resurgence_event.13 = { 
    type = country_event
    title = ionian_resurgence_event.13.t
    desc = ionian_resurgence_event.13.desc
    picture = greek_home

    left_portrait = current_ruler

    option = { 
        name = ionian_resurgence_event.13.a
        capital_scope = {
            add_permanent_province_modifier = {
                name = ionian_capital
                duration = -1
            }
        }
    }
}

ionian_resurgence_event.14 = { 
    type = country_event
    title = ionian_resurgence_event.14.t
    desc = ionian_resurgence_event.14.desc
    picture = greek_home

    left_portrait = current_ruler

    option = { 
        name = ionian_resurgence_event.14.a
        add_innovation = 1
        capital_scope = {
            add_permanent_province_modifier = {
                name = ionian_house_learning
                duration = -1
            }
        }
    }
}

ionian_resurgence_event.15 = { 
    type = country_event
    title = ionian_resurgence_event.15.t
    desc = ionian_resurgence_event.15.desc
    picture = greek_home

    left_portrait = current_ruler

    option = { # harbour
        name = ionian_resurgence_event.15.a
        trigger = {
            NOR = {
                has_variable = ionia_tour_ships
                has_variable = ionia_tour_markets
            }
        }
        trigger_event = {
            id = ionian_resurgence_event.22
            days = { 7 14 }
        }
    }

    option = { # academy
        name = ionian_resurgence_event.15.b
        trigger = {
            NOR = {
                has_variable = ionia_tour_library
                has_variable = ionia_tour_archives
            }
        }
        trigger_event = {
            id = ionian_resurgence_event.23
            days = { 7 14 }
        }
    }

    option = { # temple
        name = ionian_resurgence_event.15.c
        trigger = {
            NOR = {
                has_variable = ionia_tour_temple
                has_variable = ionia_tour_shrines
            }
        }
        trigger_event = {
            id = ionian_resurgence_event.24
            days = { 7 14 }
        }
    }
}

ionian_resurgence_event.16 = { 
    type = country_event
    title = ionian_resurgence_event.16.t
    desc = ionian_resurgence_event.16.desc
    picture = greek_home

    left_portrait = current_ruler

    option = { 
        name = ionian_resurgence_event.16.a
        capital_scope = {
            add_building_level = port_building
            add_building_level = commerce_building
        }
    }
}

ionian_resurgence_event.17 = {
    type = country_event
    title = ionian_resurgence_event.17.t
    desc = ionian_resurgence_event.17.desc
    picture = latin_tribal_path_5_event

    right_portrait = overlord.current_ruler
    left_portrait = current_ruler
    left_portrait = scope:target

    immediate = {
        hidden_effect = {
            save_scope_as = actor
            create_character = {
                add_finesse = 1
                age = 28
                female = no
                save_scope_as = target
            }
        }
    }

    option = {
        name = "ionian_resurgence_event.17.a"
        scope:target = {
            custom_tooltip = "espionage_effect_tooltip"
            if = {
                limit = {
                    exists = scope:recipient
                }
                move_country = scope:recipient
                set_variable = {
                    name = on_espionage_mission_origin
                    value = scope:actor
                    days = -1
                }
                set_variable = {
                    name = on_espionage_mission_recipient
                    value = scope:recipient
                    days = -1
                }
                if = {
                    limit = {
                        is_minor_character = no
                    }
                    set_variable = {
                        name = on_espionage_mission_family
                        value = scope:target.family
                    }
                }
                trigger_event = { 
                    id = country_diplomacy.41
                    days = { 3 5 } 
                }
            }
            add_character_modifier = {
                name = on_espionage_mission_cmod
                duration = -1
            }
            hidden_effect = {
                set_as_minor_character = THIS
            }
        }
    }
}

ionian_resurgence_event.18 = { 
    type = country_event
    title = ionian_resurgence_event.18.t
    desc = ionian_resurgence_event.18.desc
    picture = greek_home

    left_portrait = current_ruler

    option = { 
        name = ionian_resurgence_event.18.a
        add_treasury = 250
        add_country_modifier = {
            name = ionia_no_corruption
            duration = 3650
        }
    }
}

ionian_resurgence_event.19 = { 
    type = country_event
    title = ionian_resurgence_event.19.t
    desc = ionian_resurgence_event.19.desc
    picture = greek_home

    left_portrait = scope:league_target_scope.current_ruler
    right_portrait = scope:ionian_league_leader.current_ruler

    immediate = {
        save_scope_as = league_target_scope
        random_country = {
            limit = {
                has_variable = ionian_rebel_leader
            }
            save_scope_as = ionian_league_leader
        }
    }

    option = { #yes
        name = ionian_resurgence_event.19.a
        custom_tooltip = ionia_annexed_tt
        scope:ionian_league_leader = {
            trigger_event = ionian_resurgence_event.20
        } 
    }

    option = { #no
        name = ionian_resurgence_event.19.b
        add_political_influence = 50
        if = {
            limit = {
                tag = MLO # Miletos
            }
            custom_tooltip = disallow_paniona_new_tree
            set_variable = disallow_paniona_var
        }
        scope:ionian_league_leader = {
            trigger_event = ionian_resurgence_event.21
        } 
    }
}

ionian_resurgence_event.20 = { #answer yes
    type = country_event
    title = ionian_resurgence_event.20.t
    desc = ionian_resurgence_event.20.desc
    picture = greek_home

    left_portrait = current_ruler

    option = { 
        name = ionian_resurgence_event.20.a
        scope:league_target_scope = {
            every_character = {
                move_country = root
            }
            every_owned_province = {
                set_owned_by = root
            }
            every_country_treasure = {
				transfer_treasure_to_country = ROOT
			}
        }
    }
}

ionian_resurgence_event.21 = { #answer no
    type = country_event
    title = ionian_resurgence_event.21.t
    desc = ionian_resurgence_event.21.desc
    picture = greek_home

    left_portrait = current_ruler

    option = { 
        name = ionian_resurgence_event.21.a
    }
}

ionian_resurgence_event.22 = { # harbour
    type = country_event
    title = ionian_resurgence_event.22.t
    desc = ionian_resurgence_event.22.desc
    picture = greek_home

    left_portrait = current_ruler

    option = { # look at ships
        name = ionian_resurgence_event.22.a
        set_variable = ionia_tour_ships
    }

    option = { # look at the markets
        name = ionian_resurgence_event.22.b
        set_variable = ionia_tour_markets
    }

    after = {
        if = {
            limit = {
                OR = {
                    has_variable = ionia_tour_library
                    has_variable = ionia_tour_archives
                }
                OR = {
                    has_variable = ionia_tour_temple
                    has_variable = ionia_tour_shrines
                }
            }
            trigger_event = {
                id = ionian_resurgence_event.25
                days = { 7 14 }
            }
        }
        else = {
            trigger_event = {
                id = ionian_resurgence_event.15
                days = { 7 14 }
            }
        }
    }
}

ionian_resurgence_event.23 = { # academy
    type = country_event
    title = ionian_resurgence_event.23.t
    desc = ionian_resurgence_event.23.desc
    picture = greek_home

    left_portrait = current_ruler

    option = { # look at the library
        name = ionian_resurgence_event.23.a
        set_variable = ionia_tour_library
    }

    option = { # look at the archives
        name = ionian_resurgence_event.23.b
        set_variable = ionia_tour_archives
    }

    after = {
        if = {
            limit = {
                OR = {
                    has_variable = ionia_tour_ships
                    has_variable = ionia_tour_markets
                }
                OR = {
                    has_variable = ionia_tour_temple
                    has_variable = ionia_tour_shrines
                }
            }
            trigger_event = {
                id = ionian_resurgence_event.25
                days = { 7 14 }
            }
        }
        else = {
            trigger_event = {
                id = ionian_resurgence_event.15
                days = { 7 14 }
            }
        }
    }
}

ionian_resurgence_event.24 = { # temple
    type = country_event
    title = ionian_resurgence_event.24.t
    desc = ionian_resurgence_event.24.desc
    picture = greek_home

    left_portrait = current_ruler

    option = { # the big temple
        name = ionian_resurgence_event.24.a
        set_variable = ionia_tour_temple
    }

    option = { # the many smaller temples
        name = ionian_resurgence_event.24.b
        set_variable = ionia_tour_shrines
    }

    after = {
        if = {
            limit = {
                OR = {
                    has_variable = ionia_tour_ships
                    has_variable = ionia_tour_markets
                }
                OR = {
                    has_variable = ionia_tour_archives
                    has_variable = ionia_tour_library
                }
            }
            trigger_event = {
                id = ionian_resurgence_event.25
                days = { 7 14 }
            }
        }
        else = {
            trigger_event = {
                id = ionian_resurgence_event.15
                days = { 7 14 }
            }
        }
    }
}

ionian_resurgence_event.25 = { # end of the tour
    type = country_event
    title = ionian_resurgence_event.25.t
    desc = ionian_resurgence_event.25.desc
    picture = greek_home

    left_portrait = current_ruler

    option = { #
        name = ionian_resurgence_event.25.a
        if = {
            limit = {
                has_variable = ionia_tour_archives
            }
            add_research = {
                technology = military_tech
                value = 20
            }
            add_research = {
                technology = civic_tech
                value = 20
            }
            add_research = {
                technology = oratory_tech
                value = 20
            }
            add_research = {
                technology = religious_tech
                value = 20
            }
        }
        if = {
            limit = {
                has_variable = ionia_tour_library
            }
            add_innovation = 2
        }
        if = {
            limit = {
                has_variable = ionia_tour_ships
            }
            add_military_experience = 20
        }
        if = {
            limit = {
                has_variable = ionia_tour_markets
            }
            add_treasury = 250
        }
        if = {
            limit = {
                has_variable = ionia_tour_temple
            }
            add_political_influence = 50
        }
        if = {
            limit = {
                has_variable = ionia_tour_shrines
            }
            add_manpower = 2
        }
    }
}