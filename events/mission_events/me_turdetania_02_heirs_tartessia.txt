namespace = me_turdetania_2_heirs_tartessia

me_turdetania_2_heirs_tartessia.1 = { 						# A Strange Envoy
    type = country_event

    title = me_turdetania_2_heirs_tartessia.1.t
    desc = me_turdetania_2_heirs_tartessia.1.desc
    picture = ship_in_storm
    left_portrait = current_ruler
	right_portrait = scope:greek_merchant
    
    immediate = {
		hidden_effect = {
			c:REB = {
				create_character = {
					first_name = "Barnabas"
					age = 50
					culture = massalian
					religion = roman_pantheon
					save_scope_as = greek_merchant
				}
				scope:greek_merchant = {
					amazing_martial_effect = yes
					average_charisma_effect = yes
					average_finesse_effect = yes
					good_zeal_effect = yes
					add_trait = devout
					add_trait = seadog
				}
			}
		}
	}
	
	option = {
		name = "me_turdetania_2_heirs_tartessia.1.a"
		add_treasury = {
			value = root.has_monthly_income
			multiply = 3
		}
	}
	
	option = {
		name = "me_turdetania_2_heirs_tartessia.1.b"
		add_treasury = {
			value = root.has_monthly_income
			multiply = 1
		}
		scope:greek_merchant = {
			move_country = root
			set_as_minor_character = THIS
		}
		capital_scope = {
			define_pop = {
        		culture = massalian
        		religion = roman_pantheon
        		type = freemen
        	}
			define_pop = {
        		culture = massalian
        		religion = roman_pantheon
        		type = freemen
        	}
		}
	}

}

me_turdetania_2_heirs_tartessia.2 = { 						# A Greek Tale - Start
    type = country_event

    title = me_turdetania_2_heirs_tartessia.2.t
    desc = me_turdetania_2_heirs_tartessia.2.desc
    picture = interesting_histories_punic_ship_city
    left_portrait = current_ruler
	right_portrait = scope:turdetanian_ambassador
	
	trigger = {
		has_land = yes
	}
	
	immediate = {
		random_character = {
			limit = {
				is_female = no
				is_adult = yes
				has_any_office = no
				is_head_of_family = no
				is_general = no
				is_admiral = no
				is_governor = no
				has_tech_office = no
				is_minor_character = yes
			}
			save_scope_as = turdetanian_ambassador
		}
		random_country = {
			limit = {
				NOT = { this = root }
				country_culture_group = hellenic
				in_diplomatic_range = ROOT
				opinion = {
					target = ROOT
					value >= 35
				}
			}
			save_scope_as = turdetanian_greek_embassy_country_scope
		}
		root = {
			save_scope_as = turdetanian_embassy_country_root
		}
	}
	
    option = {
        name = me_turdetania_2_heirs_tartessia.2.a
		scope:turdetanian_greek_embassy_country_scope = { trigger_event = { id = me_turdetania_2_heirs_tartessia.3 days = 60 } }
		custom_tooltip = me_turdetania_2_heirs_tartessia.2.tooltip
		hidden_effect = {
			scope:turdetanian_ambassador = {
				move_country = c:REB
				set_as_minor_character = THIS
			}
		}
	}
}

me_turdetania_2_heirs_tartessia.3 = { 						# A Greek Tale - Embassy arrives Greek country
    type = country_event

    title = me_turdetania_2_heirs_tartessia.3.t
    desc = me_turdetania_2_heirs_tartessia.3.desc
    picture = interesting_histories_greek_port
    left_portrait = current_ruler
    right_portrait = scope:turdetanian_ambassador
	goto_location = scope:turdetanian_embassy_country_root.capital_scope
	
    option = {
        name = me_turdetania_2_heirs_tartessia.3.a
		add_treasury = 100
		scope:turdetanian_greek_embassy_country_scope = {
			add_opinion = {
				modifier = turdetanian_greek_embassy_opmod
				target = scope:turdetanian_embassy_country_root
			}
			reverse_add_opinion = {
				modifier = turdetanian_greek_embassy_opmod
				target = scope:turdetanian_embassy_country_root
			}
		}
		scope:turdetanian_embassy_country_root = { trigger_event = { id = me_turdetania_2_heirs_tartessia.4 days = 60 } }
    }
}

me_turdetania_2_heirs_tartessia.4 = { 						# A Greek Tale - Embassy arrives home
    type = country_event

    title = me_turdetania_2_heirs_tartessia.4.t
    desc = me_turdetania_2_heirs_tartessia.4.desc
    picture = interesting_histories_punic_ship_city
    left_portrait = current_ruler
    right_portrait = scope:turdetanian_ambassador
	
    option = {
        name = me_turdetania_2_heirs_tartessia.4.a 
		show_as_tooltip = {
			scope:turdetanian_greek_embassy_country_scope = {
				add_opinion = {
					modifier = turdetanian_greek_embassy_opmod
					target = scope:turdetanian_embassy_country_root
				}
				reverse_add_opinion = {
					modifier = turdetanian_greek_embassy_opmod
					target = scope:turdetanian_embassy_country_root
				}
			}
		}
		custom_tooltip = me_turdetania_2_heirs_tartessia.4.tooltip
		hidden_effect = {
			scope:turdetanian_ambassador = {
				move_country = root
				set_as_minor_character = THIS
			}
		}
		random_country_culture = {
			limit = { THIS.culture = c:MAS.culture }
			add_country_culture_modifier = {
				name = "leyend_arganthonios_modifier"
				duration = 3650
			}
		}
    }

}

me_turdetania_2_heirs_tartessia.5 = { 						# Tartessify the River
    type = country_event

    title = me_turdetania_2_heirs_tartessia.5.t
    desc = me_turdetania_2_heirs_tartessia.5.desc
    picture = interesting_histories_purple_soldier
    left_portrait = current_ruler
    
    option = {
        name = me_turdetania_2_heirs_tartessia.5.a
		current_ruler = {
			add_popularity = 15
		}
		p:7665 = {
			change_province_name = "Sinus Tartessicus"
		}
		custom_tooltip = turdetania_02_heirs_tartessia_inv_task_2_tooltip_a
		hidden_effect = {
			p:7771 = {
				change_province_name = "Tartis"
			}
			p:7772 = {
				change_province_name = "Tartis"
			}
		}
		custom_tooltip = turdetania_02_heirs_tartessia_inv_task_2_tooltip_b
		p:1341 = {
			add_permanent_province_modifier = {
				name = sinus_tartessicus_modifier
				duration = -1
			}
		}
		hidden_effect = {
			p:1342 = {
				add_permanent_province_modifier = {
					name = sinus_tartessicus_modifier
					duration = -1
				}
			}
			p:1343 = {
				add_permanent_province_modifier = {
					name = sinus_tartessicus_modifier
					duration = -1
				}
			}
			p:1353 = {
				add_permanent_province_modifier = {
					name = sinus_tartessicus_modifier
					duration = -1
				}
			}
			p:1358 = {
				add_permanent_province_modifier = {
					name = sinus_tartessicus_modifier
					duration = -1
				}
			}
		}
    }
}

me_turdetania_2_heirs_tartessia.6 = { 						# Worship of Arganthonios
    type = country_event

    title = me_turdetania_2_heirs_tartessia.6.t
    desc = me_turdetania_2_heirs_tartessia.6.desc
    picture = celtic_religious_festival
    left_portrait = current_ruler
    
    option = {
        name = me_turdetania_2_heirs_tartessia.6.a
		custom_tooltip = turdetania_02_heirs_tartessia_inv_task_3_tooltip_b
        set_variable = deity_unlocked_arganthonios
       	custom_tooltip = turdetania_02_heirs_tartessia_inv_task_3_tooltip_c
		set_global_variable = {
			name = arganthonios_bloodline_mechanic
		}
    }
}

me_turdetania_2_heirs_tartessia.7 = { 						# The Silver Man - Start
    type = country_event

    title = me_turdetania_2_heirs_tartessia.7.t
    desc = me_turdetania_2_heirs_tartessia.7.desc
    picture = throneroom
    left_portrait = current_ruler
    right_portrait = scope:apotheosis_turdetanian_priest
	
	immediate = {
		random_character = {
    		limit = { has_high_priest_office_trigger = yes }
    		save_scope_as = apotheosis_turdetanian_priest
    	}
	}
	
    option = {
        name = me_turdetania_2_heirs_tartessia.7.a
		scope:apotheosis_turdetanian_priest = {
			add_loyalty = turdetanian_apotheosis_loyalty
		}
    }
}

me_turdetania_2_heirs_tartessia.8 = {						# The Silver Man - End
    type = country_event

    title = me_turdetania_2_heirs_tartessia.8.t
    desc = me_turdetania_2_heirs_tartessia.8.desc
    picture = throneroom
    left_portrait = current_ruler
    right_portrait = scope:apotheosis_turdetanian_priest
	
	immediate = {
		random_character = {
    		limit = { has_high_priest_office_trigger = yes }
    		save_scope_as = apotheosis_turdetanian_priest
    	}
	}
	
	option = {
        name = me_turdetania_2_heirs_tartessia.8.a
		current_ruler = {
	        deify_character = {
	            deity = deity:omen_arganthonios
	            country = ROOT
	        }
			add_nickname = NICKNAME_ARGANTHONIOS
		}
	    current_ruler = {
			add_popularity = popularity_large
			family = { add_prestige = prestige_huge }
		}
		add_country_modifier = {
			name = turdetanian_ruler_deified_modifier
			duration = 1825 # 5 years
		}
    }
}

me_turdetania_2_heirs_tartessia.9 = { 						# Legacy of Arganthonios
    type = country_event

    title = me_turdetania_2_heirs_tartessia.9.t
    desc = me_turdetania_2_heirs_tartessia.9.desc
    picture = city_construction

    trigger = { has_land = yes }

    immediate = {
        custom_tooltip = me_turdetania_2_heirs_tartessia.9.tooltip.2
    }

    option = {
        name = me_turdetania_2_heirs_tartessia.9.a
        current_ruler = { add_popularity = popularity_medium }
        p:285 = {
            define_pop = {
				culture = turdetanian
				religion = animism
				type = citizen
			}
			define_pop = {
				culture = turdetanian
				religion = animism
				type = citizen
			}
			define_pop = {
				culture = massalian
				religion = roman_pantheon
				type = citizen
			}
			define_pop = {
				culture = massalian
				religion = roman_pantheon
				type = citizen
			}
            add_province_modifier = { name = turdetanian_phocaea_liberated_modifier }
			change_province_name = "Phokaia"
        }
    }
	
	option = {
        name = me_turdetania_2_heirs_tartessia.9.b
        current_ruler = { add_popularity = popularity_medium }
        ROOT = {
			save_scope_as = turdetanian_root_liberator_scope
		}
		p:285 = {
            define_pop = {
				culture = turdetanian
				religion = animism
				type = citizen
			}
			define_pop = {
				culture = turdetanian
				religion = animism
				type = citizen
			}
			define_pop = {
				culture = massalian
				religion = roman_pantheon
				type = citizen
			}
			define_pop = {
				culture = massalian
				religion = roman_pantheon
				type = citizen
			}
        }
		show_as_tooltip = {
			p:285 = {
				change_province_name = "Phokaia"
				add_province_modifier = { name = turdetanian_phocaea_liberated_modifier duration = 3650 }
				add_province_modifier = { name = turdetanian_walls_of_arganthonios_modifier }
			}
		}
		custom_tooltip = me_turdetania_2_heirs_tartessia.9.tooltip
		hidden_effect = {
			p:285 = {
				create_country = {
					name = {
						name = "PHOKAIA_NAME"
						adjective = "PHOKAIA_ADJECTIVE"
					}
					change_country_tag = PKI
					change_country_flag = PHOKAIA_FLAG
					change_country_color = ocean_blue
					if = {
						limit = {
							NOT = {
								primary_culture = massalian
							}
						}
						set_primary_culture_cleanup_effect = {
							NEW_PRIMARY_CULTURE = massalian
							MAKE_OLD_CULTURE_INTEGRATED = yes
						}
					}
					set_country_religion = roman_pantheon
					change_government = plutocratic_republic
					add_treasury = 50.0
                    save_scope_as = turdetania_phokaia_scope
				}
				change_province_name = "Phokaia"
				add_province_modifier = { name = turdetanian_phocaea_liberated_modifier duration = 3650 }
				add_permanent_province_modifier = { name = turdetanian_walls_of_arganthonios_modifier }
			}
			scope:turdetania_phokaia_scope = {
				add_opinion = {
					modifier = turdetanian_phocaea_loyalty_opmod
					target = scope:turdetanian_root_liberator_scope
				}
				add_country_modifier = {
					name = turdetanian_phocaea_loyalty_modifier
					duration = 9125
				}
				random_country_culture = {
					limit = {
						is_culture = turdetanian
					}
					set_country_culture_right = citizen
				}
			}
			area:aeolia_area = {
				every_area_province = {
					limit = {
						NOT = { owner = scope:turdetania_phokaia_scope }
						owner = root
					}
					set_owned_by = scope:turdetania_phokaia_scope
				}
			}
			area:ionia_area = {
				every_area_province = {
					limit = {
						NOT = { owner = scope:turdetania_phokaia_scope }
						owner = root
					}
					set_owned_by = scope:turdetania_phokaia_scope
				}
			}
			make_subject = { # Make Feudatory of Tartessia
				target = scope:turdetania_phokaia_scope
				type = subject_colony
			}
		}
	}
}

me_turdetania_2_heirs_tartessia.10 = { 						# The city of Arganthonios
    type = country_event

    title = me_turdetania_2_heirs_tartessia.10.t
    desc = me_turdetania_2_heirs_tartessia.10.desc
    picture = diadochi_new_city_founded
    left_portrait = current_ruler
    
    option = {
        name = me_turdetania_2_heirs_tartessia.10.a
		current_ruler = {
			add_popularity = popularity_medium
			if = {
				limit = { number_of_traits <= 5 }
				add_trait = founder
			}
		}
		p:1341 = {
			change_province_name = "Arganthonia"
			add_permanent_province_modifier = { name = turdetanian_arganthonia_modifier }
		}
    }
}

me_turdetania_2_heirs_tartessia.11 = { 						# The Blood of Arganthonios
    type = country_event
    title = me_turdetania_2_heirs_tartessia.11.t
    desc = me_turdetania_2_heirs_tartessia.11.desc
    picture = throneroom
    left_portrait = current_ruler
    right_portrait = scope:turdetanian_priest
    
	trigger = { 
        has_land = yes
    }
	
	immediate = {
		random_character = {
    		limit = { has_high_priest_office_trigger = yes }
    		save_scope_as = turdetanian_priest
    	}
		custom_tooltip = me_turdetania_2_heirs_tartessia.11.tooltip
	}

    option = {      
        name = me_turdetania_2_heirs_tartessia.11.a
        current_ruler = { add_popularity = popularity_large }
        add_country_modifier = {
            name = turdetanian_descendant_arganthonios
            duration = 7300 # 20 years
        }
    }
}

me_turdetania_2_heirs_tartessia.12 = { 						# Vineyards of Turdetania
    type = country_event
    title = me_turdetania_2_heirs_tartessia.12.t
    desc = me_turdetania_2_heirs_tartessia.12.desc
    picture = greek_religious_rite
    left_portrait = current_ruler
    right_portrait = scope:turdetanian_priest
	
	immediate = {
		random_character = {
    		limit = { has_high_priest_office_trigger = yes }
    		save_scope_as = turdetanian_priest
    	}
	}
	
	option = {      
        name = me_turdetania_2_heirs_tartessia.12.a
        ordered_owned_province = {
			limit = {
				has_building = latifundia_building
			}
			order_by = total_population
			max = 8
			add_permanent_province_modifier = {
				name = turdetanian_vineyards
			}
		}
		add_country_modifier = {
		    name = turdetanian_cheap_libations
		    duration = 7300 # 20 years
		}
    }
}