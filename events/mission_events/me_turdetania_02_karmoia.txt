namespace = me_turdetania_2_karmoia

me_turdetania_2_karmoia.1 = { 						# Excitement for the Campaign
    type = country_event

    title = me_turdetania_2_karmoia.1.t
    desc = me_turdetania_2_karmoia.1.desc
    picture = hellenic_marketplace
    left_portrait = current_ruler
    
    option = {
        name = me_turdetania_2_karmoia.1.a
        add_military_experience = 20
        add_country_modifier = {
            name = kar_excitement_campaign_mod
            duration = 3650
        }
    }
}

me_turdetania_2_karmoia.2 = { 						# The Western Push - Marching West
    type = country_event

    title = me_turdetania_2_karmoia.2.t
    desc = me_turdetania_2_karmoia.2.desc
    picture = celtic_gallic_path_7_event
    left_portrait = current_ruler
    
    option = {
        name = me_turdetania_2_karmoia.2.a
		custom_tooltip = me_turdetania_2_karmoia.2.tooltip
		trigger_event = { id = me_turdetania_2_karmoia.3 days = 30 }
    }
}

me_turdetania_2_karmoia.3 = { 						# The Western Push - Arriving Astigi
    type = country_event

    title = me_turdetania_2_karmoia.3.t
    desc = me_turdetania_2_karmoia.3.desc
    picture = celtic_gallic_path_7_event
    left_portrait = current_ruler
    
    option = {
        name = me_turdetania_2_karmoia.3.a
		trigger_event = { id = me_turdetania_2_karmoia.4 days = 30 }
    }
}

me_turdetania_2_karmoia.4 = { 						# The Western Push - The Fall of Astigia
    type = country_event

    title = me_turdetania_2_karmoia.4.t
    desc = me_turdetania_2_karmoia.4.desc
    picture = celtic_gallic_path_7_event
    left_portrait = current_ruler
    
    option = {
        name = me_turdetania_2_karmoia.4.a 
		add_manpower = -1
		add_aggressive_expansion = 1
		c:ASG = {
            every_owned_province = {
                add_permanent_province_modifier = {
					name = karmo_rebellious_sentiments
					duration = -1
				}
				set_owned_by = root
            }
        }
		custom_tooltip = me_turdetania_2_karmoia.4.tooltip
		trigger_event = { id = me_turdetania_2_karmoia.5 days = 10 }
    }
}

me_turdetania_2_karmoia.5 = { 						# The Western Push - Arriving Urso
    type = country_event

    title = me_turdetania_2_karmoia.5.t
    desc = me_turdetania_2_karmoia.5.desc
    picture = celtic_gallic_path_7_event
    left_portrait = current_ruler
    
    option = {
        name = me_turdetania_2_karmoia.5.a
		trigger_event = { id = me_turdetania_2_karmoia.6 days = 40 }
    }
}

me_turdetania_2_karmoia.6 = { 						# The Western Push - The Fall of Ursoia
    type = country_event

    title = me_turdetania_2_karmoia.6.t
    desc = me_turdetania_2_karmoia.6.desc
    picture = celtic_gallic_path_7_event
    left_portrait = current_ruler
    
    option = {
        name = me_turdetania_2_karmoia.6.a
        set_variable = {
			name = karmo_prevents_bypass_flag
			days = 150
		}
		add_manpower = -1
		add_aggressive_expansion = 1
		c:USO = {
            every_owned_province = {
                add_permanent_province_modifier = {
                    name = karmo_rebellious_sentiments
                    duration = -1
                }
                set_owned_by = root
            }
        }
    }
}

me_turdetania_2_karmoia.7 = { 						# The Western Push - Triumph in Karmo
    type = country_event

    title = me_turdetania_2_karmoia.7.t
    desc = me_turdetania_2_karmoia.7.desc
    picture = celtic_gallic_path_7_event
    left_portrait = current_ruler
    
    option = {
        custom_tooltip = me_turdetania_2_karmoia.7.tooltip.a
        name = me_turdetania_2_karmoia.7.a 
        add_military_experience = 20
		current_ruler = { add_popularity = 10 }
		custom_tooltip = me_turdetania_2_karmoia.7.tooltip.b
		trigger_event = { id = me_turdetania_2_karmoia.11 days = 3650 }
    }
}

me_turdetania_2_karmoia.8 = { 						# Good Contacts
    type = country_event

    title = me_turdetania_2_karmoia.8.t
    desc = me_turdetania_2_karmoia.8.desc
    picture = celtic_gallic_path_7_event
    left_portrait = current_ruler
    
    option = {
        name = me_turdetania_2_karmoia.8.a
		add_manpower = -1
		add_1_free_province_investments = yes
    }
}

me_turdetania_2_karmoia.9 = { 						# Cities Pacified
    type = country_event

    title = me_turdetania_2_karmoia.9.t
    desc = me_turdetania_2_karmoia.9.desc
    picture = interesting_histories_veneti_horses
    left_portrait = current_ruler
    
    option = {
        custom_tooltip = me_turdetania_2_karmoia.9.tooltip
        name = me_turdetania_2_karmoia.9.a
        add_treasury = -100 
        add_political_influence = 50
        add_stability = 5
        every_owned_province = {
            limit = {
                has_province_modifier = karmo_rebellious_sentiments
            }
            remove_province_modifier = karmo_rebellious_sentiments
        }
        capital_scope = {
            create_state_pop = citizen
			create_state_pop = citizen
			create_state_pop = freemen
			create_state_pop = freemen
			create_state_pop = freemen
        }
    }
}

me_turdetania_2_karmoia.10 = { 						# Remove Rebellious Sentiment if not controlled by Karmoia 
    type = country_event
	hidden = yes
	
	trigger = {
		NOT = { tag = CRM }
		any_owned_province = {
            limit = {
                has_province_modifier = karmo_rebellious_sentiments
            }
        }
	}
	
    immediate = {
		any_owned_province = {
            limit = {
                has_province_modifier = karmo_rebellious_sentiments
            }
            remove_province_modifier = karmo_rebellious_sentiments
        }
	}
}

me_turdetania_2_karmoia.11 = { 						# Deadline for Karmoia to fix problems
    type = country_event
	hidden = yes
	
    immediate = {
		if = {
			limit = { NOT = { has_variable = karmo_prevents_collapse_flag } }
			owns = 1371 #Astigi
			trigger_event = { id = me_turdetania_2_karmoia.12 days = 1 }
		}
		else_if = {
			limit = { has_variable = karmo_prevents_collapse_flag }
		}
	}
}

me_turdetania_2_karmoia.12 = { 						# Failed to fix Revellious Sentiment
    type = country_event
    title = me_turdetania_2_karmoia.12.t
    desc = me_turdetania_2_karmoia.12.desc
    picture = interesting_histories_celt_hills

    immediate = {
		hidden_effect = {
		    create_character = {
		       	age = 30
		        culture = turdetanian
		        religion = animism
		        female = no
		        good_charisma_effect = yes
		        good_popularity_trait_effect = yes
		        # dna = ""
		        save_scope_as = astigian_revolter
		    }
			p:1371 = {
				create_country = {
	                name = {
						name = ASG
						adjective = ASG_ADJ
					}
					save_scope_as = astigia_scope
	                if = {
						limit = {
							NOT = {
								primary_culture = turdetanian
							}
						}
						set_primary_culture_cleanup_effect = {
							NEW_PRIMARY_CULTURE = turdetanian
							MAKE_OLD_CULTURE_INTEGRATED = yes
						}
					}
					set_country_religion = animism
					change_government = tribal_federation
	                set_variable = {
	                    name = is_not_allowed_to_go_broke
	                    days = 9125
	                }
	                set_variable = {
	                    name = is_ignoring_ae
	                    days = 3650
	                }
				}
			}
			scope:astigian_revolter = {
				remove_all_positions = yes
				move_country = scope:astigia_scope
				set_home_country = scope:astigia_scope
				remove_character_modifier = foreign_citizen
			}
			area:baetica_cordubensis_area = {
				every_area_province = {
					limit = {
						NOT = { owner = scope:astigia_scope }
						owner = root
					}
					set_owned_by = scope:astigia_scope
				}
			}
			scope:astigia_scope = {
				add_treasury = 400
				add_manpower = 5
				set_as_ruler = scope:astigian_revolter
				add_centralization = 50
				set_country_heritage = turdetanian_heritage
				change_country_color = astigia_color
				change_country_flag = ASG
				if = {
					limit = {
						NOR = {
							has_law = coin_minting_law
						}
					}
					change_law = coin_minting_law
				}
				if = {
					limit = {
						NOR = {
							has_law = absolute_authority
						}
					}
					change_law = absolute_authority
				}
				if = {
					limit = {
						NOR = {
							has_law = oppidi_law_tribal
						}
					}
					change_law = oppidi_law_tribal
				}
				every_owned_province = {
					limit = {
						has_province_modifier = karmo_rebellious_sentiments
					}
					remove_province_modifier = karmo_rebellious_sentiments
				}
			}
		}
		
		hidden_effect = {
			if = {
				limit = { owns = 1369 }	
		    create_character = {
		       	age = 35
		        culture = turdetanian
		        religion = animism
		        female = no
		        good_martial_effect = yes
		        good_popularity_trait_effect = yes
		        # dna = ""
		        save_scope_as = ursoan_revolter
		    }
			p:1369 = {
				establish_city_effect = yes
				create_country = {
					name = {
						name = USO
						adjective = USO_ADJ
					}
					save_scope_as = ursoia_scope
	                if = {
						limit = {
							NOT = {
								primary_culture = turdetanian
							}
						}
						set_primary_culture_cleanup_effect = {
							NEW_PRIMARY_CULTURE = turdetanian
							MAKE_OLD_CULTURE_INTEGRATED = yes
						}
					}
					set_country_religion = animism
					change_government = tribal_federation
	                save_scope_as = ursoia_scope
	                set_variable = {
	                    name = is_not_allowed_to_go_broke
	                    days = 9125
	                }
	                set_variable = {
	                    name = is_ignoring_ae
	                    days = 3650
	                }
				}
			}
			scope:ursoan_revolter = {
				remove_all_positions = yes
				move_country = scope:ursoia_scope
				set_home_country = scope:ursoia_scope
				remove_character_modifier = foreign_citizen
			}
			p:1368 = {
				if = {
					limit = {
						owner = c:CRM
					}
					set_owned_by = scope:ursoia_scope
				}
			}
			area:malacita_area = {
				every_area_province = {
					limit = {
						NOT = { owner = scope:ursoia_scope }
						owner = root
					}
					set_owned_by = scope:ursoia_scope
				}
			}
			scope:ursoia_scope = {
				add_treasury = 400
				add_manpower = 10
				set_as_ruler = scope:ursoan_revolter
				set_country_heritage = turdetanian_heritage
				change_country_color = ursoia_color
				change_country_flag = USO
				add_centralization = 50
				add_alliance = astigia_scope
				if = {
					limit = {
						NOR = {
							has_law = coin_minting_law
						}
					}
					change_law = coin_minting_law
				}
				if = {
					limit = {
						NOR = {
							has_law = absolute_authority
						}
					}
					change_law = absolute_authority
				}
				if = {
					limit = {
						NOR = {
							has_law = oppidi_law_tribal
						}
					}
					change_law = oppidi_law_tribal
				}
				every_owned_province = {
					limit = {
						has_province_modifier = karmo_rebellious_sentiments
					}
					remove_province_modifier = karmo_rebellious_sentiments
				}
			}
			}
		}
    }

    option = {	# We will crush them!
        name = me_turdetania_2_karmoia.12.a
		scope:astigia_scope = {
			declare_war_with_wargoal = {
				war_goal = independence_wargoal
				province = 1371.capital_scope
				target = CRM
			}
		}
		every_current_war = {
			limit = {
				any_war_attacker = { this = scope:astigia_scope }
				any_war_defender = { this = c:CRM }
			}
			scope:ursoia_scope = {
				add_to_war = {
					target = prev
					attacker = yes
					leader = no
				}
			}
		}
		ai_chance = {
			factor = 2
			modifier = {
				current_ruler = {
					OR = {
						has_trait = submissive
						has_trait = coward
					}
				}
				factor = 0
			}
		}
    }
	
	option = {	# Let them be, we are occupied with other issues.
		name = me_turdetania_2_karmoia.12.b
		add_stability = -25
		current_ruler = { add_popularity = -20 }
		ai_chance = {
			factor = 0
			modifier = {
				current_ruler = {
					OR = {
						has_trait = submissive
						has_trait = coward
					}
				}
				factor = 2
			}
		}
	}
}

me_turdetania_2_karmoia.13 = { 						# greater karmoia
    type = country_event

    title = me_turdetania_2_karmoia.13.t
    desc = me_turdetania_2_karmoia.13.desc
    picture = interesting_histories_celt_hills
    left_portrait = current_ruler
    
    option = {
        custom_tooltip = me_turdetania_2_karmoia.13.tooltip
        name = me_turdetania_2_karmoia.13.a
        add_country_modifier = {
            name = greater_karmo
            duration = -1
        }
    }
}

me_turdetania_2_karmoia.14 = { 						# Claims on Hastaia
    type = country_event

    title = me_turdetania_2_karmoia.14.t
    desc = me_turdetania_2_karmoia.14.desc
    picture = interesting_histories_celt_hills
    left_portrait = current_ruler
    
    option = {
        custom_tooltip = me_turdetania_2_karmoia.14.tooltip
        name = me_turdetania_2_karmoia.14.a
		hidden_effect = {
			c:ASA = {
				every_owned_province = {
					limit = { is_in_region = baetica_region }
					add_claim = root
				}
			}
		}
        reverse_add_opinion = { target = c:ASA modifier = karmoia_agresive_expansion_opmod }
    }
}

me_turdetania_2_karmoia.15 = { 						# Make Hastaia Kneel - Send Proposal
    type = country_event

    title = me_turdetania_2_karmoia.15.t
    desc = me_turdetania_2_karmoia.15.desc
    picture = interesting_histories_celt_hills
    left_portrait = current_ruler
    right_portrait = c:ASA.current_ruler
	
	option = {
        name = me_turdetania_2_karmoia.15.a
		custom_tooltip = me_turdetania_2_karmoia.15.tooltip.b
		c:ASA = { trigger_event = { id = me_turdetania_2_karmoia.16 days = 4 } }
    }
}

me_turdetania_2_karmoia.16 = { 						# Make Hastaia Kneel - Hastaia event
    type = country_event

    title = me_turdetania_2_karmoia.16.t
    desc = me_turdetania_2_karmoia.16.desc
    picture = interesting_histories_celt_hills
    left_portrait = current_ruler
	right_portrait = c:CRM.current_ruler
	
	option = {
        name = me_turdetania_2_karmoia.16.a
		custom_tooltip = me_turdetania_2_karmoia.16.tooltip.a
		c:CRM = { trigger_event = me_turdetania_2_karmoia.17 }
		ai_chance = {
			factor = 20
			modifier = {
				p:1342 = {
					owner = c:ASA
					controller = C:CRM
				}
				factor = 95
			}
		}
    }
	
	option = {
		name = me_turdetania_2_karmoia.16.b
		current_ruler = { add_popularity = 10 }
		c:CRM = { trigger_event = me_turdetania_2_karmoia.18 }
		ai_chance = {
			factor = 80
			modifier = {
				p:1342 = {
					owner = c:ASA
					controller = C:CRM
				}
				factor = 5
			}
		}
	}
}

me_turdetania_2_karmoia.17 = { 						# Make Hastaia Kneel - Positive Answer 
    type = country_event

    title = me_turdetania_2_karmoia.17.t
    desc = me_turdetania_2_karmoia.17.desc
    picture = interesting_histories_celt_hills
    left_portrait = current_ruler
    right_portrait = c:ASA.current_ruler
	
	immediate = {
		c:ASA = { save_scope_as = hastaia_war_scope }
		c:CRM = { save_scope_as = karmoia_war_scope }
		c:LSC = { save_scope_as = lascutaia_war_scope }
	}
	
	option = {
        name = me_turdetania_2_karmoia.17.a
		custom_tooltip = me_turdetania_2_karmoia.16.tooltip.a
		hidden_effect = {
			if = {
				limit = {
					war_with = scope:karmoia_war_scope
					any_current_war = {
						is_war_leader = ROOT
						is_war_leader = scope:karmoia_war_scope
					}
				}
				every_current_war = {
					limit = {
						is_war_leader = ROOT
						is_war_leader = scope:karmoia_war_scope
					}
					force_white_peace = THIS
				}
			}
			c:ASA = {
				every_owned_province = {
					limit = {
						NOT = { province_id = 1342 }
					}
					set_owned_by = c:CRM
				}
				add_truce = {
					target = c:CRM
					duration = 1825
				}
				scope:hastaia_war_scope = { 
					limit = {
						scope:lascutaia_war_scope = { is_subject_of = c:ASA }
					}
					release_subject = LSC
				}
				add_opinion = { target = c:CRM modifier = karmoia_force_vassalage_opmod }
			}
			c:CRM = {
				add_truce = {
					target = c:ASA
					duration = 1825
				}
				make_subject = {
					target = c:ASA
					type = tributary
				}
				make_subject = {
					target = c:LSC
					type = tributary
				}
			}
		}
    }
}

me_turdetania_2_karmoia.18 = { 						# Make Hastaia Kneel - Negative Answer 
    type = country_event

    title = me_turdetania_2_karmoia.18.t
    desc = me_turdetania_2_karmoia.18.desc
    picture = interesting_histories_celt_hills
    left_portrait = current_ruler
    right_portrait = c:ASA.current_ruler
	
	option = {
        name = me_turdetania_2_karmoia.18.a
    }
}

me_turdetania_2_karmoia.19 = { 						# Royal Marriage - Send Proposal
    type = country_event

    title = me_turdetania_2_karmoia.19.t
    desc = me_turdetania_2_karmoia.19.desc
    picture = interesting_histories_celt_hills
    left_portrait = current_ruler
	right_portrait = c:ORT.current_ruler
	goto_location = C:ORT.capital_scope
	
	immediate = {
		if = {
			limit = {
				any_character = {
					trigger_if = {
						limit = {
							employer.current_ruler = { is_minor_character = no }
						}
						from_ruler_family = yes
					}
					is_female = no
					age > 15
				}
			}
			random_character = {
				limit = {
					trigger_if = {
						limit = {
							employer.current_ruler = { is_minor_character = no }
						}
						from_ruler_family = yes
					}
					is_female = no
					age > 15
				}
				save_scope_as = karmoan_prince
			}
		}
		c:ORT = {
			if = {
				limit = {
					any_character = {
						trigger_if = {
							limit = {
								employer.current_ruler = { is_minor_character = no }
							}
							from_ruler_family = yes
						}
						is_female = yes
						age > 15
					}
				}
				random_character = {
					limit = {
						trigger_if = {
							limit = {
								employer.current_ruler = { is_minor_character = no }
							}
							from_ruler_family = yes
						}
						is_female = yes
						age > 15
					}
					save_scope_as = oretanian_princess
				}
			}
		}
	}
	
	option = {
		name = me_turdetania_2_karmoia.19.a
		custom_tooltip = me_turdetania_2_karmoia.19.tooltip
		c:ORT = { trigger_event = me_turdetania_2_karmoia.20 }
		show_as_tooltip = {
			if = {
				limit = { exists = scope:karmoan_prince }
				scope:karmoan_prince = { marry_character = scope:oretanian_princess }
			}
		}
	}
}

me_turdetania_2_karmoia.20 = { 						# Royal Marriage - Oretanian Event
	type = country_event
	title = me_turdetania_2_karmoia.20.t
	desc = me_turdetania_2_karmoia.20.desc
	picture = throneroom
	left_portrait = current_ruler
	left_portrait = scope:oretanian_princess
	right_portrait = c:CRM.current_ruler
	right_portrait = scope:karmoan_prince
	goto_location = c:CRM.capital_scope
	
	option = {
		name = me_turdetania_2_karmoia.20.a
		show_as_tooltip = {
			if = {
				limit = { exists = scope:karmoan_prince }
				scope:karmoan_prince = { marry_character = scope:oretanian_princess }
			}
		}
		c:CRM = { trigger_event = me_turdetania_2_karmoia.21 }
		ai_chance = { factor = 95 }
	}
	
	option = {
		name = me_turdetania_2_karmoia.20.b
		c:CRM = { trigger_event = me_turdetania_2_karmoia.22 }
		ai_chance = { factor = 5 }
	}
}

me_turdetania_2_karmoia.21 = { 						# Royal Marriage - Oretania Accepts!
	type = country_event
	title = me_turdetania_2_karmoia.21.t
	desc = me_turdetania_2_karmoia.21.desc
	picture = persia_marching
	left_portrait = root.current_ruler
	left_portrait = scope:karmoan_prince
	right_portrait = C:ORT.current_ruler
	right_portrait = scope:oretanian_princess
	goto_location = C:ORT.capital_scope
	
	immediate = {
		scope:oretanian_princess = {
			show_as_tooltip = {
				move_country = scope:karmoan_prince.employer
				hidden_effect = {
					remove_character_modifier = foreign_citizen 
				}
			}
			hidden_effect = {
				if = {
					limit = {
						scope:karmoan_prince = { is_married = yes }
					}
					scope:karmoan_prince.spouse = { save_scope_as = karmoia_old_wife_scope }
					scope:karmoan_prince = { divorce_character = scope:karmoia_old_wife_scope }
					scope:karmoia_old_wife_scope = { add_loyalty = loyalty_consort_cast_aside }
				}
			}
			hidden_effect = {
				if = {
					limit = {
						scope:oretanian_princess = { is_married = yes }
					}
					scope:oretanian_princess.spouse = { save_scope_as = oretania_old_husband_scope }
					scope:oretanian_princess = { divorce_character = scope:oretania_old_husband_scope }
					scope:oretania_old_husband_scope = { add_loyalty = loyalty_consort_cast_aside }
				}
				set_as_minor_character = scope:oretanian_princess
				scope:oretanian_princess = { set_home_country = scope:karmoan_prince.employer }
			}
		}
	}
	
	option = {
		name = me_turdetania_2_karmoia.21.a
		if = {
			limit = { exists = scope:karmoan_prince }
			scope:karmoan_prince = { marry_character = scope:oretanian_princess }
		}
		add_opinion = { target = c:ORT modifier = karmoia_royal_wedding_opmod }
		reverse_add_opinion = { target = c:ORT modifier = karmoia_royal_wedding_opmod }
	}
}

me_turdetania_2_karmoia.22 = { 						# Royal Marriage - Oretania Rejects...
	type = country_event
	title = me_turdetania_2_karmoia.22.t
	desc = me_turdetania_2_karmoia.22.desc
	picture = persia_marching
	left_portrait = root.current_ruler
	left_portrait = scope:karmoan_prince
	right_portrait = C:ORT.current_ruler
	right_portrait = scope:oretanian_princess
	goto_location = C:ORT.capital_scope
	
	option = {
		name = me_turdetania_2_karmoia.22.a
		add_opinion = { target = c:ORT modifier = karmoia_rejected_royal_wedding_opmod }
		reverse_add_opinion = { target = c:ORT modifier = karmoia_rejected_royal_wedding_opmod }
	}
}

me_turdetania_2_karmoia.23 = { 						# Fortifing Karmoia
    type = country_event

    title = me_turdetania_2_karmoia.23.t
    desc = me_turdetania_2_karmoia.23.desc
    picture = interesting_histories_celt_hills
    left_portrait = current_ruler
	goto_location = p:1374
    
	option = {
		name = me_turdetania_2_karmoia.23.a
	}
}

me_turdetania_2_karmoia.24 = { 						# An Army for Karmoia
    type = country_event

    title = me_turdetania_2_karmoia.24.t
    desc = me_turdetania_2_karmoia.24.desc
    picture = interesting_histories_celt_hills
    left_portrait = current_ruler
	goto_location = p:1374
    
	option = {
		name = me_turdetania_2_karmoia.24.a
	}
}

me_turdetania_2_karmoia.25 = { 						# Ursoan Manpower
    type = country_event

    title = me_turdetania_2_karmoia.25.t
    desc = me_turdetania_2_karmoia.25.desc
    picture = interesting_histories_celt_hills
    left_portrait = current_ruler
	goto_location = p:1369
    
	option = {
		name = me_turdetania_2_karmoia.25.a
	}
}

me_turdetania_2_karmoia.26 = { 						# Establish Controll on Upper Baetis
    type = country_event

    title = me_turdetania_2_karmoia.26.t
    desc = me_turdetania_2_karmoia.26.desc
    picture = interesting_histories_celt_hills
    left_portrait = current_ruler
    right_portrait = c:ORT.current_ruler
	
	option = {
        name = me_turdetania_2_karmoia.26.a
		add_treasury = -50
		p:1377 = {
			add_permanent_province_modifier = {
				name = kar_capital_upper_turdetania
			}
		}
    }
}
